---
title: Deep Learning with Keras
---

```{python}
#| echo: false
#| warning: false
import os
os.environ["KERAS_BACKEND"] = "torch"
os.environ["CUDA_VISIBLE_DEVICES"] = ""

import torch
torch.set_num_threads(1)

import matplotlib

# TDOO: Update following section
import matplotlib.pyplot as plt
import cycler

colors = ["#91CCCC", "#FF8FA9", "#CC91BC", "#3F9999", "#A5FFB8"]
plt.rcParams["axes.prop_cycle"] = cycler.cycler(color=colors)


def set_square_figures():
    plt.rcParams["figure.figsize"] = (2.0, 2.0)


def set_rectangular_figures():
    plt.rcParams["figure.figsize"] = (5.0, 2.0)


set_rectangular_figures()
plt.rcParams["figure.dpi"] = 350
plt.rcParams["savefig.bbox"] = "tight"
plt.rcParams["font.family"] = "serif"

plt.rcParams["axes.spines.right"] = False
plt.rcParams["axes.spines.top"] = False


def square_fig():
    return plt.figure(figsize=(2, 2), dpi=350).gca()


def add_diagonal_line():
    xl = plt.xlim()
    yl = plt.ylim()
    shortestSide = min(xl[1], yl[1])
    plt.plot(
        [0, shortestSide],
        [0, shortestSide],
        color="black",
        linestyle="--",
    )


import pandas as pandas

pandas.options.display.max_rows = 6

import random

random.seed(1234)

import keras
keras.utils.set_random_seed(812)
# tensorflow.get_logger().setLevel("ERROR")
```


## Load packages {data-visibility="uncounted"}

```{python}
import random
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns
```

```{python}
from watermark import watermark
print(watermark(python=True, packages="sklearn,keras,torch,tensorflow"))
```

## Lecture Outline

- California House Price Prediction
- Make a baseline (non-deep) model
- Fit using neural network
    - Force positive predictions
    - Preprocessing
    - Early Stopping

{{< include _keras-calif-housing-regression-demo.qmd >}}

::: {.content-hidden unless-format="revealjs"}
{{< include _regression-quiz.qmd >}}
:::

# {.smaller data-visibility="uncounted"}

<h2>Glossary</h2>

::: columns
::: column
- callbacks
- cost/loss function
- early stopping
- epoch
- Keras, Tensorflow, PyTorch
:::
::: column
- matplotlib, seaborn
- neural network architecture
- targets
- training/test split
- validation set
:::
:::