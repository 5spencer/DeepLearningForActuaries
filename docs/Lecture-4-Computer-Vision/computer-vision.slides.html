<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Patrick Laub">
  <title>AI for Actuaries - Computer Vision</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Computer Vision</h1>
  <p class="subtitle">ACTL3143 &amp; ACTL5111 Deep Learning for Actuaries</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Patrick Laub 
</div>
</div>
</div>

</section>
<section id="load-packages" class="slide level2" data-visibility="uncounted">
<h2>Load packages</h2>
<div id="b195408a" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> random</span>
<span id="cb1-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-8"><a></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-9"><a></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-10"><a></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> plot_model</span>
<span id="cb1-11"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-12"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-13"><a></a></span>
<span id="cb1-14"><a></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-15"><a></a></span>
<span id="cb1-16"><a></a><span class="op">%</span>load_ext watermark</span>
<span id="cb1-17"><a></a><span class="op">%</span>watermark <span class="op">-</span>p numpy,pandas,tensorflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numpy     : 1.23.1
pandas    : 1.5.3
tensorflow: 2.12.0
</code></pre>
</div>
</div>
</section>
<section>
<section id="images" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Images</h1>

</section>
<section id="shapes-of-data" class="slide level2">
<h2>Shapes of data</h2>

<img data-src="medium-tensor-rank.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of tensors of different rank.</p><div class="footer">
<p>Source: Paras Patidar (2019), <a href="https://medium.com/mlait/tensors-representation-of-data-in-neural-networks-bbe8a711b93b">Tensors — Representation of Data In Neural Networks</a>, Medium article.</p>
</div>
</section>
<section id="shapes-of-photos" class="slide level2">
<h2>Shapes of photos</h2>

<img data-src="rgb-channels.png" class="r-stretch quarto-figure-center"><p class="caption">A photo is a rank 3 tensor.</p><div class="footer">
<p>Source: Kim et al (2021), <a href="https://www.mdpi.com/applsci/applsci-11-03418/article_deploy/html/images/applsci-11-03418-g001.png">Data Hiding Method for Color AMBTC Compressed Images Using Color Difference</a>, Applied Sciences.</p>
</div>
</section>
<section id="how-the-computer-sees-them" class="slide level2 smaller">
<h2>How the computer sees them</h2>
<div id="34b1f8e1" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">from</span> matplotlib.image <span class="im">import</span> imread</span>
<span id="cb3-2"><a></a>img1 <span class="op">=</span> imread(<span class="st">'pu.gif'</span>)<span class="op">;</span> img2 <span class="op">=</span> imread(<span class="st">'pl.gif'</span>)</span>
<span id="cb3-3"><a></a>img3 <span class="op">=</span> imread(<span class="st">'pr.gif'</span>)<span class="op">;</span> img4 <span class="op">=</span> imread(<span class="st">'pg.bmp'</span>)</span>
<span id="cb3-4"><a></a><span class="ss">f"Shapes are: </span><span class="sc">{</span>img1<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img2<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img3<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img4<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d2b3ba4f" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>'Shapes are: (16, 16, 3), (16, 16, 3), (16, 16, 3), (16, 16, 3).'</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div id="63ae6c39" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a>img1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="0c402d90" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a>img2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="b43ea78e" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>img3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="dfb07c65" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>img4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="how-we-see-them" class="slide level2">
<h2>How we see them</h2>
<div id="b4318713" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> imshow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div id="df92aa55" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a>imshow(img1)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-11-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="2f878846" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a>imshow(img2)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-12-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="d6f003c6" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>imshow(img3)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-13-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="38fdf413" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a>imshow(img4)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-14-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="why-is-255-special" class="slide level2">
<h2>Why is 255 special?</h2>
<p>Each pixel’s colour intensity is stored in one byte.</p>
<p>One byte is 8 bits, so in binary that is 00000000 to 11111111.</p>
<p>The largest <em>unsigned</em> number this can be is <span class="math inline">\(2^8-1 = 255\)</span>.</p>
<div id="8de9f609" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a>np.uint8(<span class="dv">0</span>), np.uint8(<span class="dv">1</span>), np.uint8(<span class="dv">255</span>), np.uint8(<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(0, 1, 255, 0)</code></pre>
</div>
</div>
<p>If you had <em>signed</em> numbers, this would go from -128 to 127.</p>
<div id="22cbeaba" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a>np.int8(<span class="op">-</span><span class="dv">128</span>), np.int8(<span class="dv">0</span>), np.int8(<span class="dv">127</span>), np.int8(<span class="dv">128</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(-128, 0, 127, -128)</code></pre>
</div>
</div>
<p>Alternatively, <em>hexidecimal</em> numbers are used. E.g. 10100001 is split into 1010 0001, and 1010=A, 0001=1, so combined it is 0xA1.</p>
</section>
<section id="image-editing-with-kernels" class="slide level2">
<h2>Image editing with kernels</h2>
<p>Take a look at <a href="https://setosa.io/ev/image-kernels/">https://setosa.io/ev/image-kernels/</a>.</p>

<img data-src="convolution.gif" class="r-stretch quarto-figure-center"><p class="caption">An example of an image kernel in action.</p><div class="footer">
<p>Source: <a href="http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution">Stanford’s deep learning tutorial</a> via <a href="https://stats.stackexchange.com/a/188216">Stack Exchange</a>.</p>
</div>
</section></section>
<section>
<section id="convolutional-layers" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Convolutional Layers</h1>

</section>
<section id="convolution-not-complicated" class="slide level2">
<h2>‘Convolution’ not ‘complicated’</h2>
<p>Say <span class="math inline">\(X_1, X_2 \sim f_X\)</span> are i.i.d., and we look at <span class="math inline">\(S = X_1 + X_2\)</span>.</p>
<p>The density for <span class="math inline">\(S\)</span> is then</p>
<p><span class="math display">\[
f_S(s) = \int_{x_1=-\infty}^{\infty} f_X(x_1) \, f_X(s-x_1) \,\mathrm{d}s .
\]</span></p>
<p>This is the <em>convolution</em> operation, <span class="math inline">\(f_S = f_X \star f_X\)</span>.</p>
</section>
<section id="images-are-rank-3-tensors" class="slide level2">
<h2>Images are rank 3 tensors</h2>
<p>Height, width, and number of channels.</p>

<img data-src="Glassner/16-1.png" class="r-stretch quarto-figure-center"><p class="caption">Examples of rank 3 tensors.</p><p>Grayscale image has 1 channel. RGB image has 3 channels.</p>
<p>Example: Yellow = Red + Green.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow" class="slide level2">
<h2>Example: Detecting yellow</h2>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-3.png"></p>
<figcaption>Applying a neuron to an image pixel.</figcaption>
</figure>
</div>
</div><div class="column">
<p><br></p>
<p>Apply a neuron to each pixel in the image.</p>
<p><br></p>
<p>If red/green <span class="math inline">\(\nearrow\)</span> or blue <span class="math inline">\(\searrow\)</span> then yellowness <span class="math inline">\(\nearrow\)</span>.</p>
<p><br></p>
<p>Set RGB weights to 1, 1, -1.</p>
</div>
</div>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow-ii" class="slide level2">
<h2>Example: Detecting yellow II</h2>

<img data-src="Glassner/16-4.png" class="r-stretch quarto-figure-center"><p class="caption">Scan the 3-channel input (colour image) with the neuron to produce a 1-channel output (grayscale image).</p><p>The output is produced by <em>sweeping</em> the neuron over the input. This is called <strong>convolution</strong>.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow-iii" class="slide level2" data-visibility="uncounted">
<h2>Example: Detecting yellow III</h2>

<img data-src="Glassner/16-5.png" class="r-stretch quarto-figure-center"><p class="caption">The more yellow the pixel in the colour image (left), the more white it is in the grayscale image.</p><p>The neuron or its weights is called a <strong>filter</strong>. We <em>convolve</em> the image with a filter, i.e.&nbsp;a <strong>convolutional filter</strong>.</p>
</section>
<section id="terminology" class="slide level2">
<h2>Terminology</h2>
<ul>
<li>The same neuron is used to sweep over the image, so we can store the weights in some shared memory and process the pixels in parallel. We say that the neurons are <em>weight sharing</em>.</li>
<li>In the previous example, the neuron only takes one pixel as input. Usually a larger filter containing a <em>block of weights</em> is used to process not only a pixel but also its neighboring pixels all at once.</li>
<li>The weights are called the filter <strong>kernels</strong>.</li>
<li>The cluster of pixels that forms the input of a filter is called its <em>footprint</em>.</li>
</ul>
</section>
<section id="spatial-filter" class="slide level2">
<h2>Spatial filter</h2>

<img data-src="Glassner/16-9.png" class="r-stretch quarto-figure-center"><p class="caption">Example 3x3 filter</p><p>When a filter’s footprint is &gt; 1 pixel, it is a <strong>spatial filter</strong>.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="multidimensional-convolution" class="slide level2">
<h2>Multidimensional convolution</h2>
<p>Need <span class="math inline">\(\# \text{ Channels in Input} = \# \text{ Channels in Filter}\)</span>.</p>

<img data-src="Glassner/16-18.png" class="r-stretch quarto-figure-center"><p class="caption">Example: a 3x3 filter with 3 channels, containing 27 weights.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-3x3-filter-over-rgb-input" class="slide level2">
<h2>Example: 3x3 filter over RGB input</h2>

<img data-src="Glassner/16-19.png" class="r-stretch quarto-figure-center"><p class="caption">Each channel is multipled separately &amp; then added together.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="input-output-relationship" class="slide level2">
<h2>Input-output relationship</h2>

<img data-src="Glassner/16-10.png" class="r-stretch quarto-figure-center"><p class="caption">Matching the original image footprints against the output location.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section></section>
<section>
<section id="convolutional-layer-options" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Convolutional Layer Options</h1>

</section>
<section id="padding" class="slide level2">
<h2>Padding</h2>

<img data-src="Glassner/16-15.png" class="r-stretch quarto-figure-center"><p class="caption">What happens when filters go off the edge of the input?</p><ul>
<li>How to avoid the filter’s receptive field falling off the side of the input.</li>
<li>If we only scan the filter over places of the input where the filter can fit perfectly, it will lead to loss of information, especially after many filters.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="padding-1" class="slide level2">
<h2>Padding</h2>
<p>Add a border of extra elements around the input, called <strong>padding</strong>. Normally we place zeros in all the new elements, called <strong>zero padding</strong>.</p>

<img data-src="Glassner/16-17.png" class="r-stretch quarto-figure-center"><p class="caption">Padded values can be added to the outside of the input.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="convolution-layer" class="slide level2">
<h2>Convolution layer</h2>
<ul>
<li>Multiple filters are bundled together in one layer.</li>
<li>The filters are applied <em>simultaneously</em> and <em>independently</em> to the input.</li>
<li>Filters can have different footprints, but in practice we almost always use the same footprint for every filter in a convolution layer.</li>
<li>Number of channels in the output will be the same as the number of filters.</li>
</ul>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="columns">
<div class="column">
<p>In the image:</p>
<ul>
<li>6-channel input tensor</li>
<li>input pixels</li>
<li>four 3x3 filters</li>
<li>four output tensors</li>
<li>final output tensor.</li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-21.png"></p>
<figcaption>Example network highlighting that the number of output channels equals the number of filters.</figcaption>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="x1-convolution" class="slide level2">
<h2>1x1 convolution</h2>
<ul>
<li>Feature reduction: Reduce the number of channels in the input tensor (removing correlated features) by using fewer filters than the number of channels in the input. This is because the number of channels in the output is always the same as number of filters.</li>
<li>1x1 convolution: Convolution using 1x1 filters.</li>
<li>When the channels are correlated, 1x1 convolution is very effective at reducing channels without loss of information.</li>
</ul>
</section>
<section id="example-of-1x1-convolution" class="slide level2 smaller">
<h2>Example of 1x1 convolution</h2>

<img data-src="Glassner/16-23.png" class="r-stretch quarto-figure-center"><p class="caption">Example network with 1x1 convolution.</p><ul>
<li>Input tensor contains 300 channels.</li>
<li>Use 175 1x1 filters in the convolution layer (300 weights each).</li>
<li>Each filter produces a 1-channel output.</li>
<li>Final output tensor has 175 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="striding" class="slide level2">
<h2>Striding</h2>
<p>We don’t have to go one pixel across/down at a time.</p>

<img data-src="Glassner/16-29.png" class="r-stretch quarto-figure-center"><p class="caption">Example: Use a stride of three horizontally and two vertically.</p><p>Dimension of output will be smaller than input.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="choosing-strides" class="slide level2 smaller">
<h2>Choosing strides</h2>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-31.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-32.png"></p>
</div>
</div>
</div>
<p>When a filter scans the input step by step, it processes the same input elements multiple times. Even with larger strides, this can still happen (left image).</p>
<p><strong>If</strong> we want to save time, we can choose strides that prevents input elements from being used more than once. Example (right image): 3x3 filter, stride 3 in both directions.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="specifying-a-convolutional-layer" class="slide level2">
<h2>Specifying a convolutional layer</h2>
<p>Need to choose:</p>
<ul>
<li>number of filters,</li>
<li>their footprints (e.g.&nbsp;3x3, 5x5, etc.),</li>
<li>activation functions,</li>
<li>padding &amp; striding (optional).</li>
</ul>
<p>All the filter weights are learned during training.</p>
</section></section>
<section>
<section id="convolutional-neural-networks" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Convolutional Neural Networks</h1>

</section>
<section id="definition-of-cnn" class="slide level2">
<h2>Definition of CNN</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><br> <br></p>
<p>A neural network that uses <em>convolution layers</em> is called a <em>convolutional neural network</em>.</p>
</div><div class="column" style="width:40%;">
<p><img data-src="xkcd-trained_a_neural_net_2x.png"></p>
</div>
</div>
<div class="footer">
<p>Source: Randall Munroe (2019), <a href="https://xkcd.com/2173/">xkcd #2173: Trained a Neural Net</a>.</p>
</div>
</section>
<section id="architecture" class="slide level2">
<h2>Architecture</h2>

<img data-src="Geron-mls2_1411.png" class="r-stretch quarto-figure-center"><p class="caption">Typical CNN architecture.</p><div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-11.</p>
</div>
</section>
<section id="architecture-2" class="slide level2">
<h2>Architecture #2</h2>

<img data-src="mathworks-typical-cnn.svg" class="r-stretch"><div class="footer">
<p>Source: MathWorks, <a href="https://au.mathworks.com/campaigns/offers/next/deep-learning-ebook.html"><em>Introducing Deep Learning with MATLAB</em></a>, Ebook.</p>
</div>
</section>
<section id="pooling" class="slide level2">
<h2>Pooling</h2>
<p><strong>Pooling</strong>, or <strong>downsampling</strong>, is a technique to blur a tensor.</p>

<img data-src="Glassner/16-27.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of pool operations.</p><p>(a): Input tensor (b): Subdivide input tensor into 2x2 blocks (c): Average pooling (d): Max pooling (e): Icon for a pooling layer</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="pooling-for-multiple-channels" class="slide level2 smaller">
<h2>Pooling for multiple channels</h2>

<img data-src="Glassner/16-28.png" class="r-stretch quarto-figure-center"><p class="caption">Pooling a multichannel input.</p><ul>
<li>Input tensor: 6x6 with 1 channel, zero padding.</li>
<li>Convolution layer: Three 3x3 filters.</li>
<li>Convolution layer output: 6x6 with 3 channels.</li>
<li>Pooling layer: apply max pooling to each channel.</li>
<li>Pooling layer output: 3x3, 3 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="whywhy-not-use-pooling" class="slide level2">
<h2>Why/why not use pooling?</h2>
<p><strong>Why?</strong> Pooling <em>reduces the size</em> of tensors, therefore reduces memory usage and execution time (recall that 1x1 convolution <em>reduces the number of channels</em> in a tensor).</p>
<p><strong>Why not?</strong></p>

<img data-src="reddit-down.png" class="r-stretch quarto-figure-center"><p class="caption">Geoffrey Hinton</p><div class="footer">
<p>Source: Hinton, <a href="https://www.reddit.com/r/MachineLearning/comments/2lmo0l/comment/clyj4jv/?utm_source=share&amp;utm_medium=web2x&amp;context=3">Reddit AMA</a>.</p>
</div>
</section>
<section id="whywhy-not-use-pooling-ii" class="slide level2" data-visibility="uncounted">
<h2>Why/why not use pooling? II</h2>
<p><strong>Why?</strong> Pooling <em>reduces the size</em> of tensors, therefore reduces memory usage and execution time (recall that 1x1 convolution <em>reduces the number of channels</em> in a tensor).</p>
<p><strong>Why not?</strong></p>

<img data-src="reddit-hinton-pooling.png" class="r-stretch quarto-figure-center"><p class="caption">Geoffrey Hinton</p><div class="footer">
<p>Source: Hinton, <a href="https://www.reddit.com/r/MachineLearning/comments/2lmo0l/comment/clyj4jv/?utm_source=share&amp;utm_medium=web2x&amp;context=3">Reddit AMA</a>.</p>
</div>
</section>
<section id="what-do-the-cnn-layers-learn" class="slide level2">
<h2>What do the CNN layers learn?</h2>

<img data-src="distill-feature-visualisation.png" class="r-stretch"><div class="footer">
<p>Source: Distill article, <a href="https://distill.pub/2017/feature-visualization/">Feature Visualization</a>.</p>
</div>
</section></section>
<section>
<section id="demo-character-recognition" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Demo: Character Recognition</h1>

</section>
<section id="mnist-dataset" class="slide level2">
<h2>MNIST Dataset</h2>

<img data-src="wiki-MnistExamples.png" class="r-stretch quarto-figure-center"><p class="caption">The MNIST dataset.</p><div class="footer">
<p>Source: Wikipedia, <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST database</a>.</p>
</div>
</section>
<section id="mandarin-characters-dataset" class="slide level2">
<h2>Mandarin Characters Dataset</h2>
<p>57 poorly written Mandarin characters (<span class="math inline">\(57 \times 7 = 399\)</span>).</p>

<img data-src="mandarin-practice-notebook3.png" class="r-stretch quarto-figure-center"><p class="caption">Dataset of notes when learning/practising basic characters.</p></section>
<section id="downloading-the-dataset" class="slide level2">
<h2>Downloading the dataset</h2>
<p>The data is zipped (6.9 MB) and stored on my GitHub homepage.</p>
<div id="d1c61598" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a></a><span class="co"># Download the dataset if it hasn't already been downloaded.</span></span>
<span id="cb22-2"><a></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb22-3"><a></a><span class="cf">if</span> <span class="kw">not</span> Path(<span class="st">"mandarin"</span>).exists():</span>
<span id="cb22-4"><a></a>  <span class="bu">print</span>(<span class="st">"Downloading dataset..."</span>)</span>
<span id="cb22-5"><a></a>  <span class="op">!</span>wget https:<span class="op">//</span>laub.au<span class="op">/</span>data<span class="op">/</span>mandarin.<span class="bu">zip</span></span>
<span id="cb22-6"><a></a>  <span class="op">!</span>unzip mandarin.<span class="bu">zip</span></span>
<span id="cb22-7"><a></a><span class="cf">else</span>:</span>
<span id="cb22-8"><a></a>  <span class="bu">print</span>(<span class="st">"Already downloaded."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Already downloaded.</code></pre>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Remember, the Jupyter notebook associated with your final report should either download your dataset when it is run, or you should supply the data separately.</p>
</div>
</div>
</div>
</section>
<section id="directory-structure" class="slide level2">
<h2>Directory structure</h2>
<div class="columns">
<div class="column">
<p>Inspect directory structure</p>
<div id="577f50d0" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a></a><span class="op">!</span>pip install directory_tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="55c0c5fc" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="im">from</span> directory_tree <span class="im">import</span> display_tree</span>
<span id="cb25-2"><a></a>display_tree(<span class="st">"mandarin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin/
├── bai/
│   ├── bai-1.png
│   ├── bai-2.png
│   ├── bai-3.png
│   ├── bai-4.png
│   ├── bai-5.png
│   ├── bai-6.png
│   └── bai-7.png
├── ben/
│   ├── ben-1.png
│   ├── ben-2.png
│   ├── ben-3.png
│   ├── ben-4.png
│   ├── ben-5.png
│   ├── ben-6.png
│   └── ben-7.png
├── chong/
│   ├── chong-1.png
│   ├── chong-2.png
│   ├── chong-3.png
│   ├── chong-4.png
│   ├── chong-5.png
│   ├── chong-6.png
│   └── chong-7.png
├── chu/
│   ├── chu-1.png
│   ├── chu-2.png
│   ├── chu-3.png
│   ├── chu-4.png
│   ├── chu-5.png
│   ├── chu-6.png
│   └── chu-7.png
├── chuan/
│   ├── chuan-1.png
│   ├── chuan-2.png
│   ├── chuan-3.png
│   ├── chuan-4.png
│   ├── chuan-5.png
│   ├── chuan-6.png
│   └── chuan-7.png
├── cong/
│   ├── cong-1.png
│   ├── cong-2.png
│   ├── cong-3.png
│   ├── cong-4.png
│   ├── cong-5.png
│   ├── cong-6.png
│   └── cong-7.png
├── da/
│   ├── da-1.png
│   ├── da-2.png
│   ├── da-3.png
│   ├── da-4.png
│   ├── da-5.png
│   ├── da-6.png
│   └── da-7.png
├── dan/
│   ├── dan-1.png
│   ├── dan-2.png
│   ├── dan-3.png
│   ├── dan-4.png
│   ├── dan-5.png
│   ├── dan-6.png
│   └── dan-7.png
├── dong/
│   ├── dong-1.png
│   ├── dong-2.png
│   ├── dong-3.png
│   ├── dong-4.png
│   ├── dong-5.png
│   ├── dong-6.png
│   └── dong-7.png
├── fei/
│   ├── fei-1.png
│   ├── fei-2.png
│   ├── fei-3.png
│   ├── fei-4.png
│   ├── fei-5.png
│   ├── fei-6.png
│   └── fei-7.png
├── fu/
│   ├── fu-1.png
│   ├── fu-2.png
│   ├── fu-3.png
│   ├── fu-4.png
│   ├── fu-5.png
│   ├── fu-6.png
│   └── fu-7.png
├── fu2/
│   ├── fu2-1.png
│   ├── fu2-2.png
│   ├── fu2-3.png
│   ├── fu2-4.png
│   ├── fu2-5.png
│   ├── fu2-6.png
│   └── fu2-7.png
├── gao/
│   ├── gao-1.png
│   ├── gao-2.png
│   ├── gao-3.png
│   ├── gao-4.png
│   ├── gao-5.png
│   ├── gao-6.png
│   └── gao-7.png
├── gong/
│   ├── gong-1.png
│   ├── gong-2.png
│   ├── gong-3.png
│   ├── gong-4.png
│   ├── gong-5.png
│   ├── gong-6.png
│   └── gong-7.png
├── guo/
│   ├── guo-1.png
│   ├── guo-2.png
│   ├── guo-3.png
│   ├── guo-4.png
│   ├── guo-5.png
│   ├── guo-6.png
│   └── guo-7.png
├── hu/
│   ├── hu-1.png
│   ├── hu-2.png
│   ├── hu-3.png
│   ├── hu-4.png
│   ├── hu-5.png
│   ├── hu-6.png
│   └── hu-7.png
├── huo/
│   ├── huo-1.png
│   ├── huo-2.png
│   ├── huo-3.png
│   ├── huo-4.png
│   ├── huo-5.png
│   ├── huo-6.png
│   └── huo-7.png
├── kou/
│   ├── kou-1.png
│   ├── kou-2.png
│   ├── kou-3.png
│   ├── kou-4.png
│   ├── kou-5.png
│   ├── kou-6.png
│   └── kou-7.png
├── ku/
│   ├── ku-1.png
│   ├── ku-2.png
│   ├── ku-3.png
│   ├── ku-4.png
│   ├── ku-5.png
│   ├── ku-6.png
│   └── ku-7.png
├── lin/
│   ├── lin-1.png
│   ├── lin-2.png
│   ├── lin-3.png
│   ├── lin-4.png
│   ├── lin-5.png
│   ├── lin-6.png
│   └── lin-7.png
├── ma/
│   ├── ma-1.png
│   ├── ma-2.png
│   ├── ma-3.png
│   ├── ma-4.png
│   ├── ma-5.png
│   ├── ma-6.png
│   └── ma-7.png
├── ma2/
│   ├── ma2-1.png
│   ├── ma2-2.png
│   ├── ma2-3.png
│   ├── ma2-4.png
│   ├── ma2-5.png
│   ├── ma2-6.png
│   └── ma2-7.png
├── ma3/
│   ├── ma3-1.png
│   ├── ma3-2.png
│   ├── ma3-3.png
│   ├── ma3-4.png
│   ├── ma3-5.png
│   ├── ma3-6.png
│   └── ma3-7.png
├── mei/
│   ├── mei-1.png
│   ├── mei-2.png
│   ├── mei-3.png
│   ├── mei-4.png
│   ├── mei-5.png
│   ├── mei-6.png
│   └── mei-7.png
├── men/
│   ├── men-1.png
│   ├── men-2.png
│   ├── men-3.png
│   ├── men-4.png
│   ├── men-5.png
│   ├── men-6.png
│   └── men-7.png
├── ming/
│   ├── ming-1.png
│   ├── ming-2.png
│   ├── ming-3.png
│   ├── ming-4.png
│   ├── ming-5.png
│   ├── ming-6.png
│   └── ming-7.png
├── mu/
│   ├── mu-1.png
│   ├── mu-2.png
│   ├── mu-3.png
│   ├── mu-4.png
│   ├── mu-5.png
│   ├── mu-6.png
│   └── mu-7.png
├── nan/
│   ├── nan-1.png
│   ├── nan-2.png
│   ├── nan-3.png
│   ├── nan-4.png
│   ├── nan-5.png
│   ├── nan-6.png
│   └── nan-7.png
├── niao/
│   ├── niao-1.png
│   ├── niao-2.png
│   ├── niao-3.png
│   ├── niao-4.png
│   ├── niao-5.png
│   ├── niao-6.png
│   └── niao-7.png
├── niu/
│   ├── niu-1.png
│   ├── niu-2.png
│   ├── niu-3.png
│   ├── niu-4.png
│   ├── niu-5.png
│   ├── niu-6.png
│   └── niu-7.png
├── nu/
│   ├── nu-1.png
│   ├── nu-2.png
│   ├── nu-3.png
│   ├── nu-4.png
│   ├── nu-5.png
│   ├── nu-6.png
│   └── nu-7.png
├── nuan/
│   ├── nuan-1.png
│   ├── nuan-2.png
│   ├── nuan-3.png
│   ├── nuan-4.png
│   ├── nuan-5.png
│   ├── nuan-6.png
│   └── nuan-7.png
├── peng/
│   ├── peng-1.png
│   ├── peng-2.png
│   ├── peng-3.png
│   ├── peng-4.png
│   ├── peng-5.png
│   ├── peng-6.png
│   └── peng-7.png
├── quan/
│   ├── quan-1.png
│   ├── quan-2.png
│   ├── quan-3.png
│   ├── quan-4.png
│   ├── quan-5.png
│   ├── quan-6.png
│   └── quan-7.png
├── ren/
│   ├── ren-1.png
│   ├── ren-2.png
│   ├── ren-3.png
│   ├── ren-4.png
│   ├── ren-5.png
│   ├── ren-6.png
│   └── ren-7.png
├── ri/
│   ├── ri-1.png
│   ├── ri-2.png
│   ├── ri-3.png
│   ├── ri-4.png
│   ├── ri-5.png
│   ├── ri-6.png
│   └── ri-7.png
├── rou/
│   ├── rou-1.png
│   ├── rou-2.png
│   ├── rou-3.png
│   ├── rou-4.png
│   ├── rou-5.png
│   ├── rou-6.png
│   └── rou-7.png
├── sen/
│   ├── sen-1.png
│   ├── sen-2.png
│   ├── sen-3.png
│   ├── sen-4.png
│   ├── sen-5.png
│   ├── sen-6.png
│   └── sen-7.png
├── shan/
│   ├── shan-1.png
│   ├── shan-2.png
│   ├── shan-3.png
│   ├── shan-4.png
│   ├── shan-5.png
│   ├── shan-6.png
│   └── shan-7.png
├── shan2/
│   ├── shan2-1.png
│   ├── shan2-2.png
│   ├── shan2-3.png
│   ├── shan2-4.png
│   ├── shan2-5.png
│   ├── shan2-6.png
│   └── shan2-7.png
├── shui/
│   ├── shui-1.png
│   ├── shui-2.png
│   ├── shui-3.png
│   ├── shui-4.png
│   ├── shui-5.png
│   ├── shui-6.png
│   └── shui-7.png
├── tai/
│   ├── tai-1.png
│   ├── tai-2.png
│   ├── tai-3.png
│   ├── tai-4.png
│   ├── tai-5.png
│   ├── tai-6.png
│   └── tai-7.png
├── tian/
│   ├── tian-1.png
│   ├── tian-2.png
│   ├── tian-3.png
│   ├── tian-4.png
│   ├── tian-5.png
│   ├── tian-6.png
│   └── tian-7.png
├── wang/
│   ├── wang-1.png
│   ├── wang-2.png
│   ├── wang-3.png
│   ├── wang-4.png
│   ├── wang-5.png
│   ├── wang-6.png
│   └── wang-7.png
├── wen/
│   ├── wen-1.png
│   ├── wen-2.png
│   ├── wen-3.png
│   ├── wen-4.png
│   ├── wen-5.png
│   ├── wen-6.png
│   └── wen-7.png
├── xian/
│   ├── xian-1.png
│   ├── xian-2.png
│   ├── xian-3.png
│   ├── xian-4.png
│   ├── xian-5.png
│   ├── xian-6.png
│   └── xian-7.png
├── xuan/
│   ├── xuan-1.png
│   ├── xuan-2.png
│   ├── xuan-3.png
│   ├── xuan-4.png
│   ├── xuan-5.png
│   ├── xuan-6.png
│   └── xuan-7.png
├── yan/
│   ├── yan-1.png
│   ├── yan-2.png
│   ├── yan-3.png
│   ├── yan-4.png
│   ├── yan-5.png
│   ├── yan-6.png
│   └── yan-7.png
├── yang/
│   ├── yang-1.png
│   ├── yang-2.png
│   ├── yang-3.png
│   ├── yang-4.png
│   ├── yang-5.png
│   ├── yang-6.png
│   └── yang-7.png
├── yin/
│   ├── yin-1.png
│   ├── yin-2.png
│   ├── yin-3.png
│   ├── yin-4.png
│   ├── yin-5.png
│   ├── yin-6.png
│   └── yin-7.png
├── yu/
│   ├── yu-1.png
│   ├── yu-2.png
│   ├── yu-3.png
│   ├── yu-4.png
│   ├── yu-5.png
│   ├── yu-6.png
│   └── yu-7.png
├── yu2/
│   ├── yu2-1.png
│   ├── yu2-2.png
│   ├── yu2-3.png
│   ├── yu2-4.png
│   ├── yu2-5.png
│   ├── yu2-6.png
│   └── yu2-7.png
├── yue/
│   ├── yue-1.png
│   ├── yue-2.png
│   ├── yue-3.png
│   ├── yue-4.png
│   ├── yue-5.png
│   ├── yue-6.png
│   └── yue-7.png
├── zhong/
│   ├── zhong-1.png
│   ├── zhong-2.png
│   ├── zhong-3.png
│   ├── zhong-4.png
│   ├── zhong-5.png
│   ├── zhong-6.png
│   └── zhong-7.png
├── zhu/
│   ├── zhu-1.png
│   ├── zhu-2.png
│   ├── zhu-3.png
│   ├── zhu-4.png
│   ├── zhu-5.png
│   ├── zhu-6.png
│   └── zhu-7.png
├── zhu2/
│   ├── zhu2-1.png
│   ├── zhu2-2.png
│   ├── zhu2-3.png
│   ├── zhu2-4.png
│   ├── zhu2-5.png
│   ├── zhu2-6.png
│   └── zhu2-7.png
└── zhuo/
    ├── zhuo-1.png
    ├── zhuo-2.png
    ├── zhuo-3.png
    ├── zhuo-4.png
    ├── zhuo-5.png
    ├── zhuo-6.png
    └── zhuo-7.png</code></pre>
</div>
</div>
</div><div class="column">
<div id="1490adfe" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a>tree <span class="op">=</span> display_tree(<span class="st">"mandarin"</span>, string_rep<span class="op">=</span><span class="va">True</span>).split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-2"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tree[:<span class="dv">12</span>]))</span>
<span id="cb27-3"><a></a><span class="bu">print</span>(<span class="st">"..."</span>)</span>
<span id="cb27-4"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tree[<span class="op">-</span><span class="dv">4</span>:]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin/
├── bai/
│   ├── bai-1.png
│   ├── bai-2.png
│   ├── bai-3.png
│   ├── bai-4.png
│   ├── bai-5.png
│   ├── bai-6.png
│   └── bai-7.png
├── ben/
│   ├── ben-1.png
│   ├── ben-2.png
...
    ├── zhuo-5.png
    ├── zhuo-6.png
    └── zhuo-7.png
</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="splitting-into-trainvaltest-sets" class="slide level2">
<h2>Splitting into train/val/test sets</h2>
<div id="67391416" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a><span class="op">!</span>pip install split<span class="op">-</span>folders</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5e0ff28a" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="im">import</span> splitfolders</span>
<span id="cb30-2"><a></a>splitfolders.ratio(<span class="st">"mandarin"</span>, output<span class="op">=</span><span class="st">"mandarin-split"</span>,</span>
<span id="cb30-3"><a></a>    seed<span class="op">=</span><span class="dv">1337</span>, ratio<span class="op">=</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>))</span>
<span id="cb30-4"><a></a></span>
<span id="cb30-5"><a></a>display_tree(<span class="st">"mandarin-split"</span>, max_depth<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Copying files: 0 files [00:00, ? files/s]Copying files: 2 files [00:00, 11.06 files/s]Copying files: 4 files [00:00,  8.51 files/s]Copying files: 5 files [00:00,  7.63 files/s]Copying files: 6 files [00:00,  7.04 files/s]Copying files: 7 files [00:00,  7.23 files/s]Copying files: 8 files [00:01,  6.60 files/s]Copying files: 9 files [00:01,  5.94 files/s]Copying files: 10 files [00:01,  6.70 files/s]Copying files: 11 files [00:01,  6.10 files/s]Copying files: 12 files [00:01,  5.91 files/s]Copying files: 13 files [00:01,  6.03 files/s]Copying files: 14 files [00:02,  6.15 files/s]Copying files: 15 files [00:02,  5.88 files/s]Copying files: 17 files [00:02,  6.90 files/s]Copying files: 18 files [00:02,  6.32 files/s]Copying files: 19 files [00:02,  6.23 files/s]Copying files: 20 files [00:03,  5.96 files/s]Copying files: 21 files [00:03,  5.69 files/s]Copying files: 22 files [00:03,  5.56 files/s]Copying files: 23 files [00:03,  5.36 files/s]Copying files: 24 files [00:03,  5.36 files/s]Copying files: 25 files [00:04,  5.41 files/s]Copying files: 26 files [00:04,  6.11 files/s]Copying files: 27 files [00:04,  5.68 files/s]Copying files: 28 files [00:04,  6.36 files/s]Copying files: 29 files [00:04,  5.89 files/s]Copying files: 30 files [00:04,  5.91 files/s]Copying files: 31 files [00:05,  5.74 files/s]Copying files: 32 files [00:05,  6.08 files/s]Copying files: 33 files [00:05,  6.28 files/s]Copying files: 34 files [00:05,  6.36 files/s]Copying files: 35 files [00:05,  6.16 files/s]Copying files: 36 files [00:05,  5.87 files/s]Copying files: 37 files [00:05,  6.38 files/s]Copying files: 38 files [00:06,  6.39 files/s]Copying files: 39 files [00:06,  6.22 files/s]Copying files: 40 files [00:06,  6.93 files/s]Copying files: 41 files [00:06,  6.80 files/s]Copying files: 42 files [00:06,  6.38 files/s]Copying files: 43 files [00:06,  6.28 files/s]Copying files: 44 files [00:07,  5.86 files/s]Copying files: 45 files [00:07,  5.55 files/s]Copying files: 47 files [00:07,  6.22 files/s]Copying files: 48 files [00:07,  6.22 files/s]Copying files: 49 files [00:07,  5.99 files/s]Copying files: 50 files [00:08,  5.72 files/s]Copying files: 51 files [00:08,  5.57 files/s]Copying files: 53 files [00:08,  6.50 files/s]Copying files: 54 files [00:08,  6.43 files/s]Copying files: 56 files [00:08,  7.53 files/s]Copying files: 57 files [00:09,  7.16 files/s]Copying files: 58 files [00:09,  6.35 files/s]Copying files: 59 files [00:09,  6.79 files/s]Copying files: 60 files [00:09,  5.23 files/s]Copying files: 61 files [00:09,  4.78 files/s]Copying files: 62 files [00:10,  4.87 files/s]Copying files: 63 files [00:10,  4.83 files/s]Copying files: 64 files [00:10,  4.69 files/s]Copying files: 65 files [00:10,  4.88 files/s]Copying files: 66 files [00:10,  4.71 files/s]Copying files: 67 files [00:11,  4.92 files/s]Copying files: 68 files [00:11,  4.79 files/s]Copying files: 69 files [00:11,  4.98 files/s]Copying files: 70 files [00:11,  4.82 files/s]Copying files: 71 files [00:11,  4.97 files/s]Copying files: 72 files [00:12,  4.81 files/s]Copying files: 73 files [00:12,  5.05 files/s]Copying files: 74 files [00:12,  5.82 files/s]Copying files: 75 files [00:12,  5.15 files/s]Copying files: 76 files [00:12,  4.96 files/s]Copying files: 78 files [00:13,  5.33 files/s]Copying files: 79 files [00:13,  5.59 files/s]Copying files: 80 files [00:13,  5.17 files/s]Copying files: 81 files [00:13,  5.16 files/s]Copying files: 82 files [00:14,  4.74 files/s]Copying files: 83 files [00:14,  4.72 files/s]Copying files: 84 files [00:14,  4.61 files/s]Copying files: 85 files [00:14,  4.45 files/s]Copying files: 86 files [00:15,  4.71 files/s]Copying files: 87 files [00:15,  4.69 files/s]Copying files: 88 files [00:15,  4.90 files/s]Copying files: 89 files [00:15,  5.74 files/s]Copying files: 90 files [00:15,  5.12 files/s]Copying files: 91 files [00:15,  5.02 files/s]Copying files: 92 files [00:16,  4.38 files/s]Copying files: 93 files [00:16,  4.87 files/s]Copying files: 94 files [00:16,  4.89 files/s]Copying files: 95 files [00:16,  5.02 files/s]Copying files: 96 files [00:17,  5.00 files/s]Copying files: 97 files [00:17,  4.51 files/s]Copying files: 98 files [00:17,  4.85 files/s]Copying files: 99 files [00:17,  5.51 files/s]Copying files: 100 files [00:17,  5.26 files/s]Copying files: 101 files [00:18,  5.04 files/s]Copying files: 102 files [00:18,  4.82 files/s]Copying files: 103 files [00:18,  4.81 files/s]Copying files: 104 files [00:18,  4.98 files/s]Copying files: 105 files [00:18,  4.51 files/s]Copying files: 106 files [00:19,  4.11 files/s]Copying files: 107 files [00:19,  4.13 files/s]Copying files: 108 files [00:19,  4.92 files/s]Copying files: 109 files [00:19,  4.85 files/s]Copying files: 110 files [00:20,  4.53 files/s]Copying files: 111 files [00:20,  4.93 files/s]Copying files: 112 files [00:20,  4.86 files/s]Copying files: 113 files [00:20,  5.55 files/s]Copying files: 114 files [00:20,  5.17 files/s]Copying files: 115 files [00:20,  5.07 files/s]Copying files: 116 files [00:21,  4.95 files/s]Copying files: 117 files [00:21,  4.72 files/s]Copying files: 118 files [00:21,  5.47 files/s]Copying files: 119 files [00:21,  5.60 files/s]Copying files: 120 files [00:21,  5.78 files/s]Copying files: 121 files [00:22,  5.20 files/s]Copying files: 122 files [00:22,  5.29 files/s]Copying files: 123 files [00:22,  4.94 files/s]Copying files: 124 files [00:22,  5.23 files/s]Copying files: 125 files [00:22,  5.60 files/s]Copying files: 126 files [00:23,  5.36 files/s]Copying files: 127 files [00:23,  4.97 files/s]Copying files: 128 files [00:23,  4.85 files/s]Copying files: 130 files [00:23,  6.04 files/s]Copying files: 131 files [00:23,  5.03 files/s]Copying files: 132 files [00:24,  4.50 files/s]Copying files: 133 files [00:24,  4.77 files/s]Copying files: 134 files [00:24,  4.89 files/s]Copying files: 135 files [00:24,  4.89 files/s]Copying files: 136 files [00:25,  4.62 files/s]Copying files: 137 files [00:25,  4.27 files/s]Copying files: 138 files [00:25,  4.69 files/s]Copying files: 139 files [00:25,  4.67 files/s]Copying files: 140 files [00:25,  5.04 files/s]Copying files: 141 files [00:26,  5.19 files/s]Copying files: 142 files [00:26,  5.24 files/s]Copying files: 143 files [00:26,  5.27 files/s]Copying files: 145 files [00:26,  5.45 files/s]Copying files: 146 files [00:27,  5.18 files/s]Copying files: 147 files [00:27,  5.52 files/s]Copying files: 148 files [00:27,  5.14 files/s]Copying files: 149 files [00:27,  5.48 files/s]Copying files: 150 files [00:27,  5.26 files/s]Copying files: 151 files [00:28,  4.87 files/s]Copying files: 152 files [00:28,  5.31 files/s]Copying files: 153 files [00:28,  4.79 files/s]Copying files: 155 files [00:28,  5.35 files/s]Copying files: 156 files [00:28,  5.46 files/s]Copying files: 157 files [00:29,  5.53 files/s]Copying files: 158 files [00:29,  5.19 files/s]Copying files: 159 files [00:29,  5.76 files/s]Copying files: 160 files [00:29,  6.41 files/s]Copying files: 161 files [00:29,  5.88 files/s]Copying files: 162 files [00:29,  6.01 files/s]Copying files: 163 files [00:30,  4.85 files/s]Copying files: 164 files [00:30,  4.48 files/s]Copying files: 165 files [00:30,  5.28 files/s]Copying files: 166 files [00:30,  5.31 files/s]Copying files: 167 files [00:30,  5.46 files/s]Copying files: 168 files [00:31,  5.55 files/s]Copying files: 169 files [00:31,  5.43 files/s]Copying files: 170 files [00:31,  5.39 files/s]Copying files: 172 files [00:31,  5.64 files/s]Copying files: 173 files [00:32,  5.20 files/s]Copying files: 174 files [00:32,  4.97 files/s]Copying files: 175 files [00:32,  4.96 files/s]Copying files: 177 files [00:32,  5.38 files/s]Copying files: 178 files [00:33,  5.52 files/s]Copying files: 179 files [00:33,  5.42 files/s]Copying files: 180 files [00:33,  5.44 files/s]Copying files: 181 files [00:33,  5.14 files/s]Copying files: 182 files [00:33,  5.66 files/s]Copying files: 183 files [00:33,  5.63 files/s]Copying files: 184 files [00:34,  5.47 files/s]Copying files: 185 files [00:34,  4.93 files/s]Copying files: 186 files [00:34,  5.15 files/s]Copying files: 187 files [00:34,  5.53 files/s]Copying files: 188 files [00:34,  5.13 files/s]Copying files: 189 files [00:35,  5.06 files/s]Copying files: 190 files [00:35,  4.74 files/s]Copying files: 191 files [00:35,  4.97 files/s]Copying files: 193 files [00:35,  5.35 files/s]Copying files: 194 files [00:36,  5.15 files/s]Copying files: 195 files [00:36,  4.89 files/s]Copying files: 196 files [00:36,  4.74 files/s]Copying files: 197 files [00:36,  5.33 files/s]Copying files: 198 files [00:36,  5.16 files/s]Copying files: 199 files [00:37,  4.81 files/s]Copying files: 201 files [00:37,  6.34 files/s]Copying files: 202 files [00:37,  5.69 files/s]Copying files: 203 files [00:37,  5.62 files/s]Copying files: 204 files [00:37,  5.16 files/s]Copying files: 205 files [00:38,  5.11 files/s]Copying files: 206 files [00:38,  5.26 files/s]Copying files: 207 files [00:38,  5.01 files/s]Copying files: 208 files [00:38,  5.55 files/s]Copying files: 209 files [00:38,  5.55 files/s]Copying files: 210 files [00:39,  5.25 files/s]Copying files: 211 files [00:39,  4.97 files/s]Copying files: 212 files [00:39,  4.68 files/s]Copying files: 213 files [00:39,  4.77 files/s]Copying files: 214 files [00:39,  4.73 files/s]Copying files: 215 files [00:40,  4.94 files/s]Copying files: 216 files [00:40,  4.82 files/s]Copying files: 217 files [00:40,  4.99 files/s]Copying files: 219 files [00:40,  5.35 files/s]Copying files: 220 files [00:41,  5.22 files/s]Copying files: 221 files [00:41,  5.01 files/s]Copying files: 222 files [00:41,  4.86 files/s]Copying files: 223 files [00:41,  5.66 files/s]Copying files: 224 files [00:41,  5.34 files/s]Copying files: 225 files [00:42,  5.29 files/s]Copying files: 226 files [00:42,  4.83 files/s]Copying files: 227 files [00:42,  4.63 files/s]Copying files: 228 files [00:42,  4.43 files/s]Copying files: 229 files [00:43,  4.67 files/s]Copying files: 230 files [00:43,  4.41 files/s]Copying files: 231 files [00:43,  4.78 files/s]Copying files: 232 files [00:43,  4.62 files/s]Copying files: 233 files [00:43,  4.82 files/s]Copying files: 234 files [00:44,  4.34 files/s]Copying files: 235 files [00:44,  4.06 files/s]Copying files: 236 files [00:44,  4.12 files/s]Copying files: 237 files [00:44,  4.63 files/s]Copying files: 238 files [00:45,  4.68 files/s]Copying files: 239 files [00:45,  4.17 files/s]Copying files: 240 files [00:45,  4.21 files/s]Copying files: 241 files [00:45,  4.38 files/s]Copying files: 242 files [00:45,  4.51 files/s]Copying files: 243 files [00:46,  4.27 files/s]Copying files: 244 files [00:46,  4.49 files/s]Copying files: 245 files [00:46,  4.57 files/s]Copying files: 246 files [00:46,  4.37 files/s]Copying files: 247 files [00:47,  4.61 files/s]Copying files: 248 files [00:47,  4.78 files/s]Copying files: 249 files [00:47,  4.93 files/s]Copying files: 250 files [00:47,  4.95 files/s]Copying files: 251 files [00:47,  4.97 files/s]Copying files: 252 files [00:48,  4.99 files/s]Copying files: 253 files [00:48,  4.90 files/s]Copying files: 254 files [00:48,  4.91 files/s]Copying files: 255 files [00:48,  4.95 files/s]Copying files: 256 files [00:48,  4.79 files/s]Copying files: 257 files [00:49,  4.93 files/s]Copying files: 258 files [00:49,  5.40 files/s]Copying files: 259 files [00:49,  4.93 files/s]Copying files: 260 files [00:49,  5.11 files/s]Copying files: 261 files [00:49,  5.95 files/s]Copying files: 262 files [00:49,  5.26 files/s]Copying files: 263 files [00:50,  5.70 files/s]Copying files: 264 files [00:50,  6.23 files/s]Copying files: 265 files [00:50,  5.18 files/s]Copying files: 266 files [00:50,  5.38 files/s]Copying files: 267 files [00:50,  5.88 files/s]Copying files: 268 files [00:51,  5.15 files/s]Copying files: 269 files [00:51,  5.76 files/s]Copying files: 271 files [00:51,  5.70 files/s]Copying files: 272 files [00:51,  4.94 files/s]Copying files: 273 files [00:52,  4.91 files/s]Copying files: 274 files [00:52,  4.70 files/s]Copying files: 275 files [00:52,  4.96 files/s]Copying files: 276 files [00:52,  4.88 files/s]Copying files: 277 files [00:52,  5.42 files/s]Copying files: 278 files [00:53,  5.31 files/s]Copying files: 279 files [00:53,  5.20 files/s]Copying files: 280 files [00:53,  4.87 files/s]Copying files: 281 files [00:53,  3.83 files/s]Copying files: 282 files [00:54,  3.74 files/s]Copying files: 283 files [00:54,  3.99 files/s]Copying files: 284 files [00:54,  4.45 files/s]Copying files: 285 files [00:54,  4.36 files/s]Copying files: 286 files [00:54,  4.49 files/s]Copying files: 287 files [00:55,  4.56 files/s]Copying files: 288 files [00:55,  4.49 files/s]Copying files: 289 files [00:55,  4.53 files/s]Copying files: 290 files [00:55,  4.69 files/s]Copying files: 291 files [00:55,  4.85 files/s]Copying files: 292 files [00:56,  4.41 files/s]Copying files: 293 files [00:56,  3.89 files/s]Copying files: 294 files [00:56,  4.26 files/s]Copying files: 295 files [00:56,  4.55 files/s]Copying files: 296 files [00:57,  5.12 files/s]Copying files: 298 files [00:57,  6.50 files/s]Copying files: 299 files [00:57,  6.89 files/s]Copying files: 300 files [00:57,  7.10 files/s]Copying files: 301 files [00:57,  7.05 files/s]Copying files: 303 files [00:57,  8.44 files/s]Copying files: 305 files [00:58,  8.37 files/s]Copying files: 307 files [00:58,  9.58 files/s]Copying files: 308 files [00:58,  8.76 files/s]Copying files: 310 files [00:58, 10.21 files/s]Copying files: 312 files [00:58,  9.77 files/s]Copying files: 314 files [00:59,  7.47 files/s]Copying files: 315 files [00:59,  6.95 files/s]Copying files: 316 files [00:59,  6.58 files/s]Copying files: 317 files [00:59,  6.42 files/s]Copying files: 318 files [00:59,  6.78 files/s]Copying files: 319 files [01:00,  6.14 files/s]Copying files: 320 files [01:00,  5.80 files/s]Copying files: 321 files [01:00,  5.49 files/s]Copying files: 322 files [01:00,  5.33 files/s]Copying files: 323 files [01:00,  6.17 files/s]Copying files: 324 files [01:00,  6.74 files/s]Copying files: 325 files [01:01,  5.81 files/s]Copying files: 326 files [01:01,  5.60 files/s]Copying files: 327 files [01:01,  6.33 files/s]Copying files: 328 files [01:01,  5.73 files/s]Copying files: 329 files [01:01,  4.78 files/s]Copying files: 330 files [01:02,  4.86 files/s]Copying files: 331 files [01:02,  4.73 files/s]Copying files: 332 files [01:02,  4.84 files/s]Copying files: 333 files [01:02,  4.77 files/s]Copying files: 334 files [01:02,  5.07 files/s]Copying files: 335 files [01:03,  4.80 files/s]Copying files: 336 files [01:03,  4.89 files/s]Copying files: 337 files [01:03,  5.07 files/s]Copying files: 338 files [01:03,  5.05 files/s]Copying files: 340 files [01:03,  6.45 files/s]Copying files: 342 files [01:04,  7.65 files/s]Copying files: 344 files [01:04,  8.06 files/s]Copying files: 346 files [01:04,  7.51 files/s]Copying files: 347 files [01:04,  7.49 files/s]Copying files: 348 files [01:04,  7.48 files/s]Copying files: 349 files [01:05,  7.23 files/s]Copying files: 350 files [01:05,  6.52 files/s]Copying files: 352 files [01:05,  5.72 files/s]Copying files: 354 files [01:05,  6.63 files/s]Copying files: 355 files [01:06,  6.29 files/s]Copying files: 356 files [01:06,  5.83 files/s]Copying files: 357 files [01:06,  5.60 files/s]Copying files: 358 files [01:06,  5.39 files/s]Copying files: 359 files [01:06,  5.24 files/s]Copying files: 360 files [01:07,  5.00 files/s]Copying files: 361 files [01:07,  4.93 files/s]Copying files: 362 files [01:07,  5.45 files/s]Copying files: 364 files [01:07,  6.72 files/s]Copying files: 365 files [01:07,  7.09 files/s]Copying files: 367 files [01:07,  8.57 files/s]Copying files: 368 files [01:08,  8.45 files/s]Copying files: 369 files [01:08,  6.72 files/s]Copying files: 370 files [01:08,  7.16 files/s]Copying files: 371 files [01:08,  6.97 files/s]Copying files: 372 files [01:08,  6.74 files/s]Copying files: 374 files [01:08,  8.02 files/s]Copying files: 376 files [01:09,  9.60 files/s]Copying files: 377 files [01:09,  8.34 files/s]Copying files: 378 files [01:09,  6.98 files/s]Copying files: 379 files [01:09,  6.78 files/s]Copying files: 380 files [01:09,  6.30 files/s]Copying files: 381 files [01:09,  6.96 files/s]Copying files: 382 files [01:10,  5.69 files/s]Copying files: 383 files [01:10,  5.60 files/s]Copying files: 384 files [01:10,  6.42 files/s]Copying files: 385 files [01:10,  6.50 files/s]Copying files: 386 files [01:10,  5.64 files/s]Copying files: 387 files [01:11,  5.60 files/s]Copying files: 388 files [01:11,  5.97 files/s]Copying files: 389 files [01:11,  6.27 files/s]Copying files: 391 files [01:11,  6.15 files/s]Copying files: 392 files [01:11,  6.68 files/s]Copying files: 394 files [01:11,  8.07 files/s]Copying files: 395 files [01:12,  8.14 files/s]Copying files: 397 files [01:12,  9.49 files/s]Copying files: 398 files [01:12,  8.04 files/s]Copying files: 399 files [01:12,  7.91 files/s]Copying files: 399 files [01:12,  5.49 files/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/
├── test/
├── train/
└── val/</code></pre>
</div>
</div>
</section>
<section id="directory-structure-ii" class="slide level2">
<h2>Directory structure II</h2>
<div class="columns">
<div class="column">
<div id="91562a91" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a>display_tree(<span class="st">"mandarin-split"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/
├── test/
│   ├── bai/
│   │   └── bai-5.png
│   ├── ben/
│   │   └── ben-5.png
│   ├── chong/
│   │   └── chong-5.png
│   ├── chu/
│   │   └── chu-5.png
│   ├── chuan/
│   │   └── chuan-5.png
│   ├── cong/
│   │   └── cong-5.png
│   ├── da/
│   │   └── da-5.png
│   ├── dan/
│   │   └── dan-5.png
│   ├── dong/
│   │   └── dong-5.png
│   ├── fei/
│   │   └── fei-5.png
│   ├── fu/
│   │   └── fu-5.png
│   ├── fu2/
│   │   └── fu2-5.png
│   ├── gao/
│   │   └── gao-5.png
│   ├── gong/
│   │   └── gong-5.png
│   ├── guo/
│   │   └── guo-5.png
│   ├── hu/
│   │   └── hu-5.png
│   ├── huo/
│   │   └── huo-5.png
│   ├── kou/
│   │   └── kou-5.png
│   ├── ku/
│   │   └── ku-5.png
│   ├── lin/
│   │   └── lin-5.png
│   ├── ma/
│   │   └── ma-5.png
│   ├── ma2/
│   │   └── ma2-5.png
│   ├── ma3/
│   │   └── ma3-5.png
│   ├── mei/
│   │   └── mei-5.png
│   ├── men/
│   │   └── men-5.png
│   ├── ming/
│   │   └── ming-5.png
│   ├── mu/
│   │   └── mu-5.png
│   ├── nan/
│   │   └── nan-5.png
│   ├── niao/
│   │   └── niao-5.png
│   ├── niu/
│   │   └── niu-5.png
│   ├── nu/
│   │   └── nu-5.png
│   ├── nuan/
│   │   └── nuan-5.png
│   ├── peng/
│   │   └── peng-5.png
│   ├── quan/
│   │   └── quan-5.png
│   ├── ren/
│   │   └── ren-5.png
│   ├── ri/
│   │   └── ri-5.png
│   ├── rou/
│   │   └── rou-5.png
│   ├── sen/
│   │   └── sen-5.png
│   ├── shan/
│   │   └── shan-5.png
│   ├── shan2/
│   │   └── shan2-5.png
│   ├── shui/
│   │   └── shui-5.png
│   ├── tai/
│   │   └── tai-5.png
│   ├── tian/
│   │   └── tian-5.png
│   ├── wang/
│   │   └── wang-5.png
│   ├── wen/
│   │   └── wen-5.png
│   ├── xian/
│   │   └── xian-5.png
│   ├── xuan/
│   │   └── xuan-5.png
│   ├── yan/
│   │   └── yan-5.png
│   ├── yang/
│   │   └── yang-5.png
│   ├── yin/
│   │   └── yin-5.png
│   ├── yu/
│   │   └── yu-5.png
│   ├── yu2/
│   │   └── yu2-5.png
│   ├── yue/
│   │   └── yue-5.png
│   ├── zhong/
│   │   └── zhong-5.png
│   ├── zhu/
│   │   └── zhu-5.png
│   ├── zhu2/
│   │   └── zhu2-5.png
│   └── zhuo/
│       └── zhuo-5.png
├── train/
│   ├── bai/
│   │   ├── bai-1.png
│   │   ├── bai-2.png
│   │   ├── bai-3.png
│   │   ├── bai-4.png
│   │   └── bai-6.png
│   ├── ben/
│   │   ├── ben-1.png
│   │   ├── ben-2.png
│   │   ├── ben-3.png
│   │   ├── ben-4.png
│   │   └── ben-6.png
│   ├── chong/
│   │   ├── chong-1.png
│   │   ├── chong-2.png
│   │   ├── chong-3.png
│   │   ├── chong-4.png
│   │   └── chong-6.png
│   ├── chu/
│   │   ├── chu-1.png
│   │   ├── chu-2.png
│   │   ├── chu-3.png
│   │   ├── chu-4.png
│   │   └── chu-6.png
│   ├── chuan/
│   │   ├── chuan-1.png
│   │   ├── chuan-2.png
│   │   ├── chuan-3.png
│   │   ├── chuan-4.png
│   │   └── chuan-6.png
│   ├── cong/
│   │   ├── cong-1.png
│   │   ├── cong-2.png
│   │   ├── cong-3.png
│   │   ├── cong-4.png
│   │   └── cong-6.png
│   ├── da/
│   │   ├── da-1.png
│   │   ├── da-2.png
│   │   ├── da-3.png
│   │   ├── da-4.png
│   │   └── da-6.png
│   ├── dan/
│   │   ├── dan-1.png
│   │   ├── dan-2.png
│   │   ├── dan-3.png
│   │   ├── dan-4.png
│   │   └── dan-6.png
│   ├── dong/
│   │   ├── dong-1.png
│   │   ├── dong-2.png
│   │   ├── dong-3.png
│   │   ├── dong-4.png
│   │   └── dong-6.png
│   ├── fei/
│   │   ├── fei-1.png
│   │   ├── fei-2.png
│   │   ├── fei-3.png
│   │   ├── fei-4.png
│   │   └── fei-6.png
│   ├── fu/
│   │   ├── fu-1.png
│   │   ├── fu-2.png
│   │   ├── fu-3.png
│   │   ├── fu-4.png
│   │   └── fu-6.png
│   ├── fu2/
│   │   ├── fu2-1.png
│   │   ├── fu2-2.png
│   │   ├── fu2-3.png
│   │   ├── fu2-4.png
│   │   └── fu2-6.png
│   ├── gao/
│   │   ├── gao-1.png
│   │   ├── gao-2.png
│   │   ├── gao-3.png
│   │   ├── gao-4.png
│   │   └── gao-6.png
│   ├── gong/
│   │   ├── gong-1.png
│   │   ├── gong-2.png
│   │   ├── gong-3.png
│   │   ├── gong-4.png
│   │   └── gong-6.png
│   ├── guo/
│   │   ├── guo-1.png
│   │   ├── guo-2.png
│   │   ├── guo-3.png
│   │   ├── guo-4.png
│   │   └── guo-6.png
│   ├── hu/
│   │   ├── hu-1.png
│   │   ├── hu-2.png
│   │   ├── hu-3.png
│   │   ├── hu-4.png
│   │   └── hu-6.png
│   ├── huo/
│   │   ├── huo-1.png
│   │   ├── huo-2.png
│   │   ├── huo-3.png
│   │   ├── huo-4.png
│   │   └── huo-6.png
│   ├── kou/
│   │   ├── kou-1.png
│   │   ├── kou-2.png
│   │   ├── kou-3.png
│   │   ├── kou-4.png
│   │   └── kou-6.png
│   ├── ku/
│   │   ├── ku-1.png
│   │   ├── ku-2.png
│   │   ├── ku-3.png
│   │   ├── ku-4.png
│   │   └── ku-6.png
│   ├── lin/
│   │   ├── lin-1.png
│   │   ├── lin-2.png
│   │   ├── lin-3.png
│   │   ├── lin-4.png
│   │   └── lin-6.png
│   ├── ma/
│   │   ├── ma-1.png
│   │   ├── ma-2.png
│   │   ├── ma-3.png
│   │   ├── ma-4.png
│   │   └── ma-6.png
│   ├── ma2/
│   │   ├── ma2-1.png
│   │   ├── ma2-2.png
│   │   ├── ma2-3.png
│   │   ├── ma2-4.png
│   │   └── ma2-6.png
│   ├── ma3/
│   │   ├── ma3-1.png
│   │   ├── ma3-2.png
│   │   ├── ma3-3.png
│   │   ├── ma3-4.png
│   │   └── ma3-6.png
│   ├── mei/
│   │   ├── mei-1.png
│   │   ├── mei-2.png
│   │   ├── mei-3.png
│   │   ├── mei-4.png
│   │   └── mei-6.png
│   ├── men/
│   │   ├── men-1.png
│   │   ├── men-2.png
│   │   ├── men-3.png
│   │   ├── men-4.png
│   │   └── men-6.png
│   ├── ming/
│   │   ├── ming-1.png
│   │   ├── ming-2.png
│   │   ├── ming-3.png
│   │   ├── ming-4.png
│   │   └── ming-6.png
│   ├── mu/
│   │   ├── mu-1.png
│   │   ├── mu-2.png
│   │   ├── mu-3.png
│   │   ├── mu-4.png
│   │   └── mu-6.png
│   ├── nan/
│   │   ├── nan-1.png
│   │   ├── nan-2.png
│   │   ├── nan-3.png
│   │   ├── nan-4.png
│   │   └── nan-6.png
│   ├── niao/
│   │   ├── niao-1.png
│   │   ├── niao-2.png
│   │   ├── niao-3.png
│   │   ├── niao-4.png
│   │   └── niao-6.png
│   ├── niu/
│   │   ├── niu-1.png
│   │   ├── niu-2.png
│   │   ├── niu-3.png
│   │   ├── niu-4.png
│   │   └── niu-6.png
│   ├── nu/
│   │   ├── nu-1.png
│   │   ├── nu-2.png
│   │   ├── nu-3.png
│   │   ├── nu-4.png
│   │   └── nu-6.png
│   ├── nuan/
│   │   ├── nuan-1.png
│   │   ├── nuan-2.png
│   │   ├── nuan-3.png
│   │   ├── nuan-4.png
│   │   └── nuan-6.png
│   ├── peng/
│   │   ├── peng-1.png
│   │   ├── peng-2.png
│   │   ├── peng-3.png
│   │   ├── peng-4.png
│   │   └── peng-6.png
│   ├── quan/
│   │   ├── quan-1.png
│   │   ├── quan-2.png
│   │   ├── quan-3.png
│   │   ├── quan-4.png
│   │   └── quan-6.png
│   ├── ren/
│   │   ├── ren-1.png
│   │   ├── ren-2.png
│   │   ├── ren-3.png
│   │   ├── ren-4.png
│   │   └── ren-6.png
│   ├── ri/
│   │   ├── ri-1.png
│   │   ├── ri-2.png
│   │   ├── ri-3.png
│   │   ├── ri-4.png
│   │   └── ri-6.png
│   ├── rou/
│   │   ├── rou-1.png
│   │   ├── rou-2.png
│   │   ├── rou-3.png
│   │   ├── rou-4.png
│   │   └── rou-6.png
│   ├── sen/
│   │   ├── sen-1.png
│   │   ├── sen-2.png
│   │   ├── sen-3.png
│   │   ├── sen-4.png
│   │   └── sen-6.png
│   ├── shan/
│   │   ├── shan-1.png
│   │   ├── shan-2.png
│   │   ├── shan-3.png
│   │   ├── shan-4.png
│   │   └── shan-6.png
│   ├── shan2/
│   │   ├── shan2-1.png
│   │   ├── shan2-2.png
│   │   ├── shan2-3.png
│   │   ├── shan2-4.png
│   │   └── shan2-6.png
│   ├── shui/
│   │   ├── shui-1.png
│   │   ├── shui-2.png
│   │   ├── shui-3.png
│   │   ├── shui-4.png
│   │   └── shui-6.png
│   ├── tai/
│   │   ├── tai-1.png
│   │   ├── tai-2.png
│   │   ├── tai-3.png
│   │   ├── tai-4.png
│   │   └── tai-6.png
│   ├── tian/
│   │   ├── tian-1.png
│   │   ├── tian-2.png
│   │   ├── tian-3.png
│   │   ├── tian-4.png
│   │   └── tian-6.png
│   ├── wang/
│   │   ├── wang-1.png
│   │   ├── wang-2.png
│   │   ├── wang-3.png
│   │   ├── wang-4.png
│   │   └── wang-6.png
│   ├── wen/
│   │   ├── wen-1.png
│   │   ├── wen-2.png
│   │   ├── wen-3.png
│   │   ├── wen-4.png
│   │   └── wen-6.png
│   ├── xian/
│   │   ├── xian-1.png
│   │   ├── xian-2.png
│   │   ├── xian-3.png
│   │   ├── xian-4.png
│   │   └── xian-6.png
│   ├── xuan/
│   │   ├── xuan-1.png
│   │   ├── xuan-2.png
│   │   ├── xuan-3.png
│   │   ├── xuan-4.png
│   │   └── xuan-6.png
│   ├── yan/
│   │   ├── yan-1.png
│   │   ├── yan-2.png
│   │   ├── yan-3.png
│   │   ├── yan-4.png
│   │   └── yan-6.png
│   ├── yang/
│   │   ├── yang-1.png
│   │   ├── yang-2.png
│   │   ├── yang-3.png
│   │   ├── yang-4.png
│   │   └── yang-6.png
│   ├── yin/
│   │   ├── yin-1.png
│   │   ├── yin-2.png
│   │   ├── yin-3.png
│   │   ├── yin-4.png
│   │   └── yin-6.png
│   ├── yu/
│   │   ├── yu-1.png
│   │   ├── yu-2.png
│   │   ├── yu-3.png
│   │   ├── yu-4.png
│   │   └── yu-6.png
│   ├── yu2/
│   │   ├── yu2-1.png
│   │   ├── yu2-2.png
│   │   ├── yu2-3.png
│   │   ├── yu2-4.png
│   │   └── yu2-6.png
│   ├── yue/
│   │   ├── yue-1.png
│   │   ├── yue-2.png
│   │   ├── yue-3.png
│   │   ├── yue-4.png
│   │   └── yue-6.png
│   ├── zhong/
│   │   ├── zhong-1.png
│   │   ├── zhong-2.png
│   │   ├── zhong-3.png
│   │   ├── zhong-4.png
│   │   └── zhong-6.png
│   ├── zhu/
│   │   ├── zhu-1.png
│   │   ├── zhu-2.png
│   │   ├── zhu-3.png
│   │   ├── zhu-4.png
│   │   └── zhu-6.png
│   ├── zhu2/
│   │   ├── zhu2-1.png
│   │   ├── zhu2-2.png
│   │   ├── zhu2-3.png
│   │   ├── zhu2-4.png
│   │   └── zhu2-6.png
│   └── zhuo/
│       ├── zhuo-1.png
│       ├── zhuo-2.png
│       ├── zhuo-3.png
│       ├── zhuo-4.png
│       └── zhuo-6.png
└── val/
    ├── bai/
    │   └── bai-7.png
    ├── ben/
    │   └── ben-7.png
    ├── chong/
    │   └── chong-7.png
    ├── chu/
    │   └── chu-7.png
    ├── chuan/
    │   └── chuan-7.png
    ├── cong/
    │   └── cong-7.png
    ├── da/
    │   └── da-7.png
    ├── dan/
    │   └── dan-7.png
    ├── dong/
    │   └── dong-7.png
    ├── fei/
    │   └── fei-7.png
    ├── fu/
    │   └── fu-7.png
    ├── fu2/
    │   └── fu2-7.png
    ├── gao/
    │   └── gao-7.png
    ├── gong/
    │   └── gong-7.png
    ├── guo/
    │   └── guo-7.png
    ├── hu/
    │   └── hu-7.png
    ├── huo/
    │   └── huo-7.png
    ├── kou/
    │   └── kou-7.png
    ├── ku/
    │   └── ku-7.png
    ├── lin/
    │   └── lin-7.png
    ├── ma/
    │   └── ma-7.png
    ├── ma2/
    │   └── ma2-7.png
    ├── ma3/
    │   └── ma3-7.png
    ├── mei/
    │   └── mei-7.png
    ├── men/
    │   └── men-7.png
    ├── ming/
    │   └── ming-7.png
    ├── mu/
    │   └── mu-7.png
    ├── nan/
    │   └── nan-7.png
    ├── niao/
    │   └── niao-7.png
    ├── niu/
    │   └── niu-7.png
    ├── nu/
    │   └── nu-7.png
    ├── nuan/
    │   └── nuan-7.png
    ├── peng/
    │   └── peng-7.png
    ├── quan/
    │   └── quan-7.png
    ├── ren/
    │   └── ren-7.png
    ├── ri/
    │   └── ri-7.png
    ├── rou/
    │   └── rou-7.png
    ├── sen/
    │   └── sen-7.png
    ├── shan/
    │   └── shan-7.png
    ├── shan2/
    │   └── shan2-7.png
    ├── shui/
    │   └── shui-7.png
    ├── tai/
    │   └── tai-7.png
    ├── tian/
    │   └── tian-7.png
    ├── wang/
    │   └── wang-7.png
    ├── wen/
    │   └── wen-7.png
    ├── xian/
    │   └── xian-7.png
    ├── xuan/
    │   └── xuan-7.png
    ├── yan/
    │   └── yan-7.png
    ├── yang/
    │   └── yang-7.png
    ├── yin/
    │   └── yin-7.png
    ├── yu/
    │   └── yu-7.png
    ├── yu2/
    │   └── yu2-7.png
    ├── yue/
    │   └── yue-7.png
    ├── zhong/
    │   └── zhong-7.png
    ├── zhu/
    │   └── zhu-7.png
    ├── zhu2/
    │   └── zhu2-7.png
    └── zhuo/
        └── zhuo-7.png</code></pre>
</div>
</div>
</div><div class="column">
<div id="ad6db4fe" class="cell" data-execution_count="23">
<div class="cell-output cell-output-stdout">
<pre><code>train/
├── bai/
│   ├── bai-1.png
│   ├── bai-2.png
│   ├── bai-3.png
│   ├── bai-4.png
│   └── bai-6.png
...
val/
├── bai/
│   └── bai-7.png
├── ben/
│   └── ben-7.png
...
test/
├── bai/
│   └── bai-5.png
├── ben/
│   └── ben-5.png
...</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="keras-image-dataset-loading" class="slide level2">
<h2>Keras image dataset loading</h2>
<div class="columns">
<div class="column">
<div id="124faccc" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="annotated-cell-63"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy"><code class="sourceCode python"><span id="annotated-cell-63-1"><a href="#annotated-cell-63-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span><span class="op">\</span></span>
<span id="annotated-cell-63-2"><a href="#annotated-cell-63-2"></a>  image_dataset_from_directory</span>
<span id="annotated-cell-63-3"><a href="#annotated-cell-63-3"></a></span>
<span id="annotated-cell-63-4"><a href="#annotated-cell-63-4"></a>data_dir <span class="op">=</span> <span class="st">"mandarin-split"</span></span>
<span id="annotated-cell-63-5"><a href="#annotated-cell-63-5"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="annotated-cell-63-6"><a href="#annotated-cell-63-6"></a>img_height <span class="op">=</span> <span class="dv">80</span></span>
<span id="annotated-cell-63-7"><a href="#annotated-cell-63-7"></a>img_width <span class="op">=</span> <span class="dv">80</span></span>
<span id="annotated-cell-63-8"><a href="#annotated-cell-63-8"></a>img_size <span class="op">=</span> (img_height, img_width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div id="a1eb7ad2" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="annotated-cell-64"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy"><code class="sourceCode python"><span id="annotated-cell-64-1"><a href="#annotated-cell-64-1"></a>train_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="annotated-cell-64-2"><a href="#annotated-cell-64-2"></a>    data_dir <span class="op">+</span> <span class="st">"/train"</span>,</span>
<span id="annotated-cell-64-3"><a href="#annotated-cell-64-3"></a>    image_size<span class="op">=</span>img_size,</span>
<span id="annotated-cell-64-4"><a href="#annotated-cell-64-4"></a>    batch_size<span class="op">=</span>batch_size,</span>
<span id="annotated-cell-64-5"><a href="#annotated-cell-64-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="annotated-cell-64-6"><a href="#annotated-cell-64-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 285 files belonging to 57 classes.</code></pre>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column">
<div id="15b1f7c1" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="annotated-cell-66"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy"><code class="sourceCode python"><span id="annotated-cell-66-1"><a href="#annotated-cell-66-1"></a>val_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="annotated-cell-66-2"><a href="#annotated-cell-66-2"></a>    data_dir <span class="op">+</span> <span class="st">"/val"</span>,</span>
<span id="annotated-cell-66-3"><a href="#annotated-cell-66-3"></a>    image_size<span class="op">=</span>img_size,</span>
<span id="annotated-cell-66-4"><a href="#annotated-cell-66-4"></a>    batch_size<span class="op">=</span>batch_size,</span>
<span id="annotated-cell-66-5"><a href="#annotated-cell-66-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="annotated-cell-66-6"><a href="#annotated-cell-66-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 57 files belonging to 57 classes.</code></pre>
</div>
</div>
</div><div class="column">
<div id="e1c119e5" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="annotated-cell-68"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy"><code class="sourceCode python"><span id="annotated-cell-68-1"><a href="#annotated-cell-68-1"></a>test_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="annotated-cell-68-2"><a href="#annotated-cell-68-2"></a>    data_dir <span class="op">+</span> <span class="st">"/test"</span>,</span>
<span id="annotated-cell-68-3"><a href="#annotated-cell-68-3"></a>    image_size<span class="op">=</span>img_size,</span>
<span id="annotated-cell-68-4"><a href="#annotated-cell-68-4"></a>    batch_size<span class="op">=</span>batch_size,</span>
<span id="annotated-cell-68-5"><a href="#annotated-cell-68-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="annotated-cell-68-6"><a href="#annotated-cell-68-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 57 files belonging to 57 classes.</code></pre>
</div>
</div>
</div>
</div>
<ol type="1">
<li>Imports <code>image_dataset_from_directory</code> class from <code>tensorflow.keras.utils</code> library</li>
<li>Specifies the name of the folder</li>
<li>Specifies the number of images to be trained at the same time</li>
<li>Specifies the height of the image</li>
<li>Specifies the width of the image</li>
<li>Specifies the image size</li>
<li>Creates a data object to store the train set. Note that <code>color_mode='grayscale'</code> command tells the computer to bring in the images in greyscale instead of the RGB scale.</li>
<li>Creates a data object to store the validation set</li>
<li>Creates a data object to store the test set</li>
</ol>
</section>
<section id="inspecting-the-datasets" class="slide level2">
<h2>Inspecting the datasets</h2>
<div id="f6150c5d" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a></a><span class="bu">print</span>(train_ds.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['bai', 'ben', 'chong', 'chu', 'chuan', 'cong', 'da', 'dan', 'dong', 'fei', 'fu', 'fu2', 'gao', 'gong', 'guo', 'hu', 'huo', 'kou', 'ku', 'lin', 'ma', 'ma2', 'ma3', 'mei', 'men', 'ming', 'mu', 'nan', 'niao', 'niu', 'nu', 'nuan', 'peng', 'quan', 'ren', 'ri', 'rou', 'sen', 'shan', 'shan2', 'shui', 'tai', 'tian', 'wang', 'wen', 'xian', 'xuan', 'yan', 'yang', 'yin', 'yu', 'yu2', 'yue', 'zhong', 'zhu', 'zhu2', 'zhuo']</code></pre>
</div>
</div>
<div id="26bc8e8b" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a></a><span class="co"># NB: Need shuffle=False earlier for these X &amp; y to line up.</span></span>
<span id="cb41-2"><a></a>X_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(train_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb41-3"><a></a>y_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(train_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb41-4"><a></a></span>
<span id="cb41-5"><a></a>X_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(val_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb41-6"><a></a>y_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(val_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb41-7"><a></a></span>
<span id="cb41-8"><a></a>X_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(test_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb41-9"><a></a>y_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(test_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb41-10"><a></a></span>
<span id="cb41-11"><a></a>X_train.shape, y_train.shape, X_val.shape, y_val.shape, X_test.shape, y_test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-01-29 10:13:14.395251: W tensorflow/tsl/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>((285, 80, 80, 1), (285,), (57, 80, 80, 1), (57,), (57, 80, 80, 1), (57,))</code></pre>
</div>
</div>
</section>
<section id="plotting-some-characters-setup" class="slide level2">
<h2>Plotting some characters (setup)</h2>
<div id="7e0cce75" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a></a><span class="kw">def</span> plot_mandarin_characters(ds, plot_char_label <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb44-2"><a></a>    num_plotted <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb44-3"><a></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> ds:</span>
<span id="cb44-4"><a></a>       <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(images.shape[<span class="dv">0</span>]):</span>
<span id="cb44-5"><a></a>           label <span class="op">=</span> labels[i]</span>
<span id="cb44-6"><a></a>           <span class="cf">if</span> label <span class="op">==</span> plot_char_label:</span>
<span id="cb44-7"><a></a>               plt.subplot(<span class="dv">1</span>, <span class="dv">5</span>, num_plotted <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb44-8"><a></a>               plt.imshow(images[i].numpy().astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb44-9"><a></a>               plt.title(ds.class_names[label])</span>
<span id="cb44-10"><a></a>               plt.axis(<span class="st">"off"</span>)</span>
<span id="cb44-11"><a></a>               num_plotted <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb44-12"><a></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-some-training-characters" class="slide level2 smaller">
<h2>Plotting some training characters</h2>
<div id="c65a7957" class="cell" data-execution_count="31">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-32-output-1.png"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-32-output-2.png"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-some-valtest-characters" class="slide level2">
<h2>Plotting some val/test characters</h2>
<div class="columns">
<div class="column">
<div id="c577df27" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a></a>bai_val <span class="op">=</span> X_val[y_val <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb45-2"><a></a>plt.imshow(bai_val, cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-33-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div id="f23503f8" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a></a>bai_test <span class="op">=</span> X_test[y_test <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb46-2"><a></a>plt.imshow(bai_test)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-34-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>
<h2>
Make the CNN
</h2>
<div id="7a8653c5" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="op">\</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1">1</button><span id="annotated-cell-12-2" class="code-annotation-target"><a href="#annotated-cell-12-2"></a>  <span class="im">import</span> Rescaling, Conv2D, MaxPooling2D, Flatten</span>
<span id="annotated-cell-12-3"><a href="#annotated-cell-12-3"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="2">2</button><span id="annotated-cell-12-4" class="code-annotation-target"><a href="#annotated-cell-12-4"></a>num_classes <span class="op">=</span> np.unique(y_train).shape[<span class="dv">0</span>]</span>
<span id="annotated-cell-12-5"><a href="#annotated-cell-12-5"></a>random.seed(<span class="dv">123</span>)</span>
<span id="annotated-cell-12-6"><a href="#annotated-cell-12-6"></a></span>
<span id="annotated-cell-12-7"><a href="#annotated-cell-12-7"></a>model <span class="op">=</span> Sequential([</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="3">3</button><span id="annotated-cell-12-8" class="code-annotation-target"><a href="#annotated-cell-12-8"></a>  Rescaling(<span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>, input_shape<span class="op">=</span>(img_height, img_width, <span class="dv">1</span>)),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="4">4</button><span id="annotated-cell-12-9" class="code-annotation-target"><a href="#annotated-cell-12-9"></a>  Conv2D(<span class="dv">16</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv1"</span>),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="5">5</button><span id="annotated-cell-12-10" class="code-annotation-target"><a href="#annotated-cell-12-10"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool1"</span>),</span>
<span id="annotated-cell-12-11"><a href="#annotated-cell-12-11"></a>  Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv2"</span>),</span>
<span id="annotated-cell-12-12"><a href="#annotated-cell-12-12"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool2"</span>),</span>
<span id="annotated-cell-12-13"><a href="#annotated-cell-12-13"></a>  Conv2D(<span class="dv">64</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv3"</span>),</span>
<span id="annotated-cell-12-14"><a href="#annotated-cell-12-14"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool3"</span>),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="6">6</button><span id="annotated-cell-12-15" class="code-annotation-target"><a href="#annotated-cell-12-15"></a>  Flatten(), Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">"relu"</span>), Dense(num_classes)</span>
<span id="annotated-cell-12-16"><a href="#annotated-cell-12-16"></a>])</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="2" data-code-annotation="1">Imports CNN specific preprocessing layers from <code>tensorflow.keras.layers</code></span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="4" data-code-annotation="2">Specifies the number of unique categories in the train set</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="8" data-code-annotation="3">Rescales the numeric representations of data which ranges from [0,255] in to [0, 1] range</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="9" data-code-annotation="4">Applies the convolution layer. Here <code>padding="same"</code> ensures that the dimensions of the input and output matrices remain same</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="10" data-code-annotation="5">Applies <code>MaxPooling</code>, which reduces the spatial dimensions by carrying forward the maximum value over an input window</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="15" data-code-annotation="6">Applies the <code>Flatten</code> layer to convert the 2D array (from pooling) in to a single column vector, and passes through couple of <code>Dense</code> layers to train the neural network for the specific classification problem. Note that the output layer has number of neurons equal to <code>numClasses</code>, which corresponds to the number of unique classes in the output.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The <code>Rescaling</code> layer will rescale the intensities to [0, 1].</p>
</div>
</div>
</div>
<div class="footer">
<p>Architecture inspired by <a href="https://www.tensorflow.org/tutorials/images/classification">https://www.tensorflow.org/tutorials/images/classification</a>.</p>
</div>
</section>
<section id="inspect-the-model" class="slide level2">
<h2>Inspect the model</h2>
<div id="5a54a0db" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a></a>model.summary(print_fn<span class="op">=</span>skip_empty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
Layer (type)                Output Shape              Param #
=================================================================
rescaling (Rescaling)       (None, 80, 80, 1)         0
conv1 (Conv2D)              (None, 80, 80, 16)        160
pool1 (MaxPooling2D)        (None, 40, 40, 16)        0
conv2 (Conv2D)              (None, 40, 40, 32)        4640
pool2 (MaxPooling2D)        (None, 20, 20, 32)        0
conv3 (Conv2D)              (None, 20, 20, 64)        18496
pool3 (MaxPooling2D)        (None, 10, 10, 64)        0
flatten (Flatten)           (None, 6400)              0
dense (Dense)               (None, 128)               819328
dense_1 (Dense)             (None, 57)                7353
=================================================================
Total params: 849,977
Trainable params: 849,977
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-the-cnn" class="slide level2">
<h2>Plot the CNN</h2>
<div class="columns">
<div class="column">
<div id="ca120564" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a></a>plot_model(model, layer_range<span class="op">=</span>(<span class="st">""</span>, <span class="st">"pool2"</span>), show_shapes<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-37-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div id="2aa8408a" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a></a>plot_model(model, layer_range<span class="op">=</span>(<span class="st">"pool2"</span>, <span class="st">""</span>), show_shapes<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-38-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="fit-the-cnn" class="slide level2">
<h2>Fit the CNN</h2>
<div id="32ee0b40" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-1" class="code-annotation-target"><a href="#annotated-cell-14-1"></a>loss <span class="op">=</span> tf.keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="2">2</button><span id="annotated-cell-14-2" class="code-annotation-target"><a href="#annotated-cell-14-2"></a>topk <span class="op">=</span> tf.keras.metrics.SparseTopKCategoricalAccuracy(k<span class="op">=</span><span class="dv">5</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="3">3</button><span id="annotated-cell-14-3" class="code-annotation-target"><a href="#annotated-cell-14-3"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span>loss, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>, topk])</span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4"></a></span>
<span id="annotated-cell-14-5"><a href="#annotated-cell-14-5"></a>epochs <span class="op">=</span> <span class="dv">100</span></span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">15</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>,</span>
<span id="annotated-cell-14-7"><a href="#annotated-cell-14-7"></a>    monitor<span class="op">=</span><span class="st">"val_accuracy"</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="annotated-cell-14-8"><a href="#annotated-cell-14-8"></a></span>
<span id="annotated-cell-14-9"><a href="#annotated-cell-14-9"></a>hist <span class="op">=</span> model.fit(train_ds.shuffle(<span class="dv">1000</span>), validation_data<span class="op">=</span>val_ds,</span>
<span id="annotated-cell-14-10"><a href="#annotated-cell-14-10"></a>  epochs<span class="op">=</span>epochs, callbacks<span class="op">=</span>[es], verbose<span class="op">=</span><span class="dv">0</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="1" data-code-annotation="1">Defines the loss function with an added command <code>from_logits=True</code>. Doing this instead of defining a <code>softmax</code> function at the output <code>Dense</code> layer of the neural network is expected to be more numerically stable</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="2" data-code-annotation="2">Specifies a new metric to keep track of accuracy of the top 5 predicted classes. This means that, for each input image, the metric will consider whether the true class is among the top 5 predicted classes by the model</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="3" data-code-annotation="3">Compiles the model as usual with an optimizer, a loss function and metrics to monitor</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Restoring model weights from the end of the best epoch: 22.
Epoch 37: early stopping</code></pre>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Instead of using softmax activation, just added <code>from_logits=True</code> to the loss function; this is more numerically stable.</p>
</div>
</div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves-setup" class="slide level2">
<h2>Plot the loss/accuracy curves (setup)</h2>
<div id="b02d4b45" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a></a><span class="kw">def</span> plot_history(hist):</span>
<span id="cb52-2"><a></a>    epochs <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(hist.history[<span class="st">"loss"</span>]))</span>
<span id="cb52-3"><a></a></span>
<span id="cb52-4"><a></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb52-5"><a></a>    plt.plot(epochs, hist.history[<span class="st">"accuracy"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb52-6"><a></a>    plt.plot(epochs, hist.history[<span class="st">"val_accuracy"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb52-7"><a></a>    plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>)</span>
<span id="cb52-8"><a></a>    plt.title(<span class="st">"Accuracy"</span>)</span>
<span id="cb52-9"><a></a></span>
<span id="cb52-10"><a></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb52-11"><a></a>    plt.plot(epochs, hist.history[<span class="st">"loss"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb52-12"><a></a>    plt.plot(epochs, hist.history[<span class="st">"val_loss"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb52-13"><a></a>    plt.legend(loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb52-14"><a></a>    plt.title(<span class="st">"Loss"</span>)</span>
<span id="cb52-15"><a></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves" class="slide level2">
<h2>Plot the loss/accuracy curves</h2>
<div id="4ff3ea1f" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a></a>plot_history(hist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-html/cell-42-output-1.png" class="r-stretch"></section>
<section id="look-at-the-metrics" class="slide level2">
<h2>Look at the metrics</h2>
<div id="f9138250" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a></a><span class="bu">print</span>(model.evaluate(train_ds, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb54-2"><a></a><span class="bu">print</span>(model.evaluate(val_ds, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb54-3"><a></a><span class="bu">print</span>(model.evaluate(test_ds, verbose<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.009564659558236599, 1.0, 1.0]
[0.6313576698303223, 0.8245614171028137, 0.9824561476707458]
[0.4097440540790558, 0.9122806787490845, 0.9824561476707458]</code></pre>
</div>
</div>
</section>
<section id="predict-on-the-test-set" class="slide level2">
<h2>Predict on the test set</h2>
<div id="80118bee" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a></a>model.predict(X_test[<span class="dv">17</span>], verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b4a2fb77" class="cell" data-execution_count="44">
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:Model was constructed with shape (None, 80, 80, 1) for input KerasTensor(type_spec=TensorSpec(shape=(None, 80, 80, 1), dtype=tf.float32, name='rescaling_input'), name='rescaling_input', description="created by layer 'rescaling_input'"), but it was called on an input with incompatible shape (None, 80, 1, 1).</code></pre>
</div>
</div>
<div id="bb9a1e2c" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a></a>X_test[<span class="dv">17</span>].shape, X_test[<span class="dv">17</span>][np.newaxis, :].shape, X_test[[<span class="dv">17</span>]].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>((80, 80, 1), (1, 80, 80, 1), (1, 80, 80, 1))</code></pre>
</div>
</div>
<div id="4ec762f8" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a></a>model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>array([[ -1.12, -19.32,  -5.97,  -6.93,   3.49,  -4.36, -29.57,   1.64,
         -9.7 ,   1.11,  -9.43,  -0.83,  -8.08,  -5.06,   2.95,  -9.71,
         -7.79,   9.11,  -3.85,  -6.81,  -5.35,  -3.  ,   0.9 , -12.59,
          0.56,   4.4 , -14.07,  -2.07,  -3.77,  -0.29, -14.97,  -5.24,
         -6.34, -18.72, -17.86,   0.93,  -2.31,  -2.88,   1.95,   1.7 ,
        -10.32, -13.69, -11.29,  -7.79,  -3.7 ,  -6.9 ,   3.02,   2.55,
         -3.09,   5.07,  -9.64,  -2.55,   3.15,  -7.51,  -2.29,  -7.77,
         -5.33]], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="predict-on-the-test-set-ii" class="slide level2">
<h2>Predict on the test set II</h2>
<div id="938f256c" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a></a>model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>).argmax()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>17</code></pre>
</div>
</div>
<div id="21c0339b" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a></a>test_ds.class_names[model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>).argmax()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>'kou'</code></pre>
</div>
</div>
<div id="7ca6f46f" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a></a>plt.imshow(X_test[<span class="dv">17</span>], cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-html/cell-50-output-1.png" class="r-stretch"></section></section>
<section>
<section id="section-1" class="title-slide slide level1 center">
<h1></h1>
<h2>
Error analysis (setup)
</h2>
<div id="cb5b6a82" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a></a><span class="kw">def</span> plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, class_names):</span>
<span id="cb67-2"><a></a>  plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb67-3"><a></a></span>
<span id="cb67-4"><a></a>  num_errors <span class="op">=</span> np.<span class="bu">sum</span>(y_pred <span class="op">!=</span> y_test)</span>
<span id="cb67-5"><a></a>  err_num <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb67-6"><a></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X_test.shape[<span class="dv">0</span>]):</span>
<span id="cb67-7"><a></a>      <span class="cf">if</span> y_pred[i] <span class="op">!=</span> y_test[i]:</span>
<span id="cb67-8"><a></a>          ax <span class="op">=</span> plt.subplot(num_errors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>err_num <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb67-9"><a></a>          plt.imshow(X_test[i].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb67-10"><a></a>          plt.title(<span class="ss">f"Guessed '</span><span class="sc">{</span>class_names[y_pred[i]]<span class="sc">}</span><span class="ss">' True '</span><span class="sc">{</span>class_names[y_test[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb67-11"><a></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb67-12"><a></a>          </span>
<span id="cb67-13"><a></a>          actual_pred_char_ind <span class="op">=</span> np.argmax(y_test <span class="op">==</span> y_pred[i])</span>
<span id="cb67-14"><a></a>          ax <span class="op">=</span> plt.subplot(num_errors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>err_num <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb67-15"><a></a>          plt.imshow(X_val[actual_pred_char_ind].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb67-16"><a></a>          plt.title(<span class="ss">f"A real '</span><span class="sc">{</span>class_names[y_pred[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb67-17"><a></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb67-18"><a></a>          err_num <span class="op">+=</span> <span class="dv">1</span>     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="error-analysis-i" class="slide level2">
<h2>Error analysis I</h2>

<img data-src="error-analysis-found-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from first assessment of test errors.</p></section>
<section id="error-analysis-ii" class="slide level2">
<h2>Error analysis II</h2>

<img data-src="error-analysis-found-another-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from second assessment of test errors.</p></section>
<section id="error-analysis-iii" class="slide level2">
<h2>Error analysis III</h2>
<div id="f56fb304" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a></a>y_pred <span class="op">=</span> model.predict(X_val, verbose<span class="op">=</span><span class="dv">0</span>).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb68-2"><a></a>plot_error_analysis(X_train, y_train, X_val, y_val, y_pred, val_ds.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-html/cell-52-output-1.png" class="r-stretch"></section>
<section id="error-analysis-iv" class="slide level2">
<h2>Error analysis IV</h2>
<div id="f3fcb6ea" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a></a>y_pred <span class="op">=</span> model.predict(X_test, verbose<span class="op">=</span><span class="dv">0</span>).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb69-2"><a></a>plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, test_ds.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-html/cell-53-output-1.png" class="r-stretch"></section>
<section id="confidence-of-predictions" class="slide level2">
<h2>Confidence of predictions</h2>
<div id="fac4296d" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a></a>y_pred <span class="op">=</span> tf.keras.activations.softmax(model(X_test)).numpy()</span>
<span id="cb70-2"><a></a>y_pred_class <span class="op">=</span> y_pred.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb70-3"><a></a>y_pred_prob <span class="op">=</span> y_pred[np.arange(y_pred.shape[<span class="dv">0</span>]), y_pred_class]</span>
<span id="cb70-4"><a></a></span>
<span id="cb70-5"><a></a>confidence_when_correct <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">==</span> y_test]</span>
<span id="cb70-6"><a></a>confidence_when_wrong <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">!=</span> y_test]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="b4e36eb6" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a></a>plt.hist(confidence_when_correct)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-55-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div id="e51bf7fd" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a></a>plt.hist(confidence_when_wrong)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-html/cell-56-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="hyperparameter-tuning" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Hyperparameter tuning</h1>

</section>
<section id="trial-error" class="slide level2">
<h2>Trial &amp; error</h2>
<div class="columns">
<div class="column">
<p><br> <br></p>
<p>Frankly, a lot of this is just ‘enlightened’ trial and error.</p>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="twitter-advice.png"></p>
<figcaption>Or ‘received wisdom’ from experts…</figcaption>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: <a href="https://twitter.com/tetraduzione/status/1525501171221274627?s=20&amp;t=ulVFesw-f7hCuG9KyaoYbQ">Twitter</a>.</p>
</div>
</section>
<section id="keras-tuner" class="slide level2">
<h2>Keras Tuner</h2>
<div id="dc19c87a" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a></a><span class="op">!</span>pip install keras<span class="op">-</span>tuner</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b61ac6b6" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a></a><span class="im">import</span> keras_tuner <span class="im">as</span> kt</span>
<span id="cb74-2"><a></a></span>
<span id="cb74-3"><a></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb74-4"><a></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb74-5"><a></a>    model.add(</span>
<span id="cb74-6"><a></a>        Dense(</span>
<span id="cb74-7"><a></a>            hp.Choice(<span class="st">"neurons"</span>, [<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>]),</span>
<span id="cb74-8"><a></a>            activation<span class="op">=</span>hp.Choice(<span class="st">"activation"</span>,</span>
<span id="cb74-9"><a></a>                [<span class="st">"relu"</span>, <span class="st">"leaky_relu"</span>, <span class="st">"tanh"</span>]),</span>
<span id="cb74-10"><a></a>        )</span>
<span id="cb74-11"><a></a>    )</span>
<span id="cb74-12"><a></a>  </span>
<span id="cb74-13"><a></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb74-14"><a></a>    </span>
<span id="cb74-15"><a></a>    learning_rate <span class="op">=</span> hp.Float(<span class="st">"lr"</span>,</span>
<span id="cb74-16"><a></a>        min_value<span class="op">=</span><span class="fl">1e-4</span>, max_value<span class="op">=</span><span class="fl">1e-2</span>, sampling<span class="op">=</span><span class="st">"log"</span>)</span>
<span id="cb74-17"><a></a>    opt <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span>learning_rate)</span>
<span id="cb74-18"><a></a></span>
<span id="cb74-19"><a></a>    model.<span class="bu">compile</span>(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb74-20"><a></a>    </span>
<span id="cb74-21"><a></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-random-search" class="slide level2">
<h2>Do a random search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div id="ae34c232" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a></a>tuner <span class="op">=</span> kt.RandomSearch(</span>
<span id="cb75-2"><a></a>  build_model,</span>
<span id="cb75-3"><a></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb75-4"><a></a>  max_trials<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb75-5"><a></a>  directory<span class="op">=</span><span class="st">"random-search"</span>)</span>
<span id="cb75-6"><a></a></span>
<span id="cb75-7"><a></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb75-8"><a></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-9"><a></a></span>
<span id="cb75-10"><a></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb75-11"><a></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb75-12"><a></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb75-13"><a></a></span>
<span id="cb75-14"><a></a>best_model <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trial 10 Complete [00h 00m 05s]
val_loss: 0.33390817046165466

Best val_loss So Far: 0.32481735944747925
Total elapsed time: 00h 00m 41s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
WARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.Adam`.</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div id="8d922e57" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in random-search/untitled_project
Showing 1 best trials
Objective(name="val_loss", direction="min")

Trial 02 summary
Hyperparameters:
neurons: 8
activation: tanh
lr: 0.0021043482724264983
Score: 0.32481735944747925</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tune-layers-separately" class="slide level2">
<h2>Tune layers separately</h2>
<div id="310ac260" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb80-2"><a></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb80-3"><a></a></span>
<span id="cb80-4"><a></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(hp.Int(<span class="st">"numHiddenLayers"</span>, <span class="dv">1</span>, <span class="dv">3</span>)):</span>
<span id="cb80-5"><a></a>      <span class="co"># Tune number of units in each layer separately.</span></span>
<span id="cb80-6"><a></a>      model.add(</span>
<span id="cb80-7"><a></a>          Dense(</span>
<span id="cb80-8"><a></a>              hp.Choice(<span class="ss">f"neurons_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, [<span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>]),</span>
<span id="cb80-9"><a></a>              activation<span class="op">=</span><span class="st">"relu"</span></span>
<span id="cb80-10"><a></a>          )</span>
<span id="cb80-11"><a></a>      )</span>
<span id="cb80-12"><a></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb80-13"><a></a></span>
<span id="cb80-14"><a></a>    opt <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">0.0005</span>)</span>
<span id="cb80-15"><a></a>    model.<span class="bu">compile</span>(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb80-16"><a></a>    </span>
<span id="cb80-17"><a></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-bayesian-search" class="slide level2">
<h2>Do a Bayesian search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div id="4153cce4" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a></a>tuner <span class="op">=</span> kt.BayesianOptimization(</span>
<span id="cb81-2"><a></a>  build_model,</span>
<span id="cb81-3"><a></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb81-4"><a></a>  directory<span class="op">=</span><span class="st">"bayesian-search"</span>,</span>
<span id="cb81-5"><a></a>  max_trials<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb81-6"><a></a></span>
<span id="cb81-7"><a></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb81-8"><a></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb81-9"><a></a></span>
<span id="cb81-10"><a></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb81-11"><a></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb81-12"><a></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb81-13"><a></a></span>
<span id="cb81-14"><a></a>best_model <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trial 10 Complete [00h 00m 07s]
val_loss: 0.32673153281211853

Best val_loss So Far: 0.31825506687164307
Total elapsed time: 00h 01m 36s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
WARNING:absl:There is a known slowdown when using v2.11+ Keras optimizers on M1/M2 Macs. Falling back to the legacy Keras optimizer, i.e., `tf.keras.optimizers.legacy.Adam`.</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div id="90f7ae4f" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in bayesian-search/untitled_project
Showing 1 best trials
Objective(name="val_loss", direction="min")

Trial 01 summary
Hyperparameters:
numHiddenLayers: 2
neurons_0: 8
neurons_1: 8
Score: 0.31825506687164307</code></pre>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="leveraging-solutions-from-benchmark-problems" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Leveraging Solutions From Benchmark Problems</h1>

</section>
<section id="demo-object-classification" class="slide level2">
<h2>Demo: Object classification</h2>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="teach-images.png"></p>
<figcaption>Example object classification run.</figcaption>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://info.deeplearning.ai/hs-fs/hubfs/NOCODE.gif?width=1199&amp;upscale=true&amp;name=NOCODE.gif"></p>
<figcaption>Example of object classification.</figcaption>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Teachable Machine, <a href="https://teachablemachine.withgoogle.com/">https://teachablemachine.withgoogle.com/</a>.</p>
</div>
</section>
<section id="how-does-that-work" class="slide level2">
<h2>How does that work?</h2>
<blockquote>
<p>… these models use a technique called transfer learning. There’s a pretrained neural network, and when you create your own classes, you can sort of picture that your classes are becoming the last layer or step of the neural net. Specifically, both the image and pose models are learning off of pretrained mobilenet models …</p>
</blockquote>
<p><a href="https://teachablemachine.withgoogle.com/faq#Diving-Deeper">Teachable Machine FAQ</a></p>
</section>
<section id="benchmarks" class="slide level2">
<h2>Benchmarks</h2>
<p><a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-11 / CIFAR-100 dataset</a> from Canadian Institute for Advanced Research</p>
<ul>
<li>9 classes: 60000 32x32 colour images</li>
<li>99 classes: 60000 32x32 colour images</li>
</ul>
<p><a href="https://www.image-net.org/index.php">ImageNet</a> and the <em>ImageNet Large Scale Visual Recognition Challenge (ILSVRC)</em>; originally <a href="https://image-net.org/challenges/LSVRC/2014/browse-synsets">1,000 synsets</a>.</p>
<ul>
<li>In 2021: 14,197,122 labelled images from 21,841 synsets.</li>
<li>See <a href="https://keras.io/api/applications/">Keras applications</a> for downloadable models.</li>
</ul>
</section>
<section id="lenet-6-1998" class="slide level2 smaller">
<h2>LeNet-6 (1998)</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 9%">
<col style="width: 23%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel size</th>
<th>Stride</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>0</td>
<td>32×32</td>
<td>–</td>
<td>–</td>
<td>–</td>
</tr>
<tr class="even">
<td>C0</td>
<td>Convolution</td>
<td>6</td>
<td>28×28</td>
<td>5×5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S1</td>
<td>Avg pooling</td>
<td>6</td>
<td>14×14</td>
<td>2×2</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C2</td>
<td>Convolution</td>
<td>16</td>
<td>10×10</td>
<td>5×5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>Avg pooling</td>
<td>16</td>
<td>5×5</td>
<td>2×2</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C4</td>
<td>Convolution</td>
<td>120</td>
<td>1×1</td>
<td>5×5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>F5</td>
<td>Fully connected</td>
<td>–</td>
<td>84</td>
<td>–</td>
<td>–</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully connected</td>
<td>–</td>
<td>9</td>
<td>–</td>
<td>–</td>
<td>RBF</td>
</tr>
</tbody>
</table>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>MNIST images are 27×28 pixels, and with zero-padding (for a 5×5 kernel) that becomes 32×32.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: Aurélien Géron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Chapter 14.</p>
</div>
</section>
<section id="alexnet-2011" class="slide level2 smaller">
<h2>AlexNet (2011)</h2>
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel</th>
<th>Stride</th>
<th>Padding</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>2</td>
<td>227×227</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>–</td>
</tr>
<tr class="even">
<td>C0</td>
<td>Convolution</td>
<td>96</td>
<td>55×55</td>
<td>11×11</td>
<td>4</td>
<td>valid</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S1</td>
<td>Max pool</td>
<td>96</td>
<td>27×27</td>
<td>3×3</td>
<td>2</td>
<td>valid</td>
<td>–</td>
</tr>
<tr class="even">
<td>C2</td>
<td>Convolution</td>
<td>256</td>
<td>27×27</td>
<td>5×5</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>Max pool</td>
<td>256</td>
<td>13×13</td>
<td>3×3</td>
<td>2</td>
<td>valid</td>
<td>–</td>
</tr>
<tr class="even">
<td>C4</td>
<td>Convolution</td>
<td>384</td>
<td>13×13</td>
<td>3×3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>C5</td>
<td>Convolution</td>
<td>384</td>
<td>13×13</td>
<td>3×3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>C6</td>
<td>Convolution</td>
<td>256</td>
<td>13×13</td>
<td>3×3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S7</td>
<td>Max pool</td>
<td>256</td>
<td>6×6</td>
<td>3×3</td>
<td>2</td>
<td>valid</td>
<td>–</td>
</tr>
<tr class="even">
<td>F8</td>
<td>Fully conn.</td>
<td>–</td>
<td>4,096</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>F9</td>
<td>Fully conn.</td>
<td>–</td>
<td>4,096</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully conn.</td>
<td>–</td>
<td>0,000</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>Softmax</td>
</tr>
</tbody>
</table>
<div class="footer">
<p>Winner of the ILSVRC 2011 challenge (top-five error 17%), developed by Alex Krizhevsky, Ilya Sutskever, and Geoffrey Hinton.</p>
</div>
</section>
<section id="data-augmentation" class="slide level2">
<h2>Data Augmentation</h2>

<img data-src="data-augmentation.png" class="r-stretch quarto-figure-center"><p class="caption">Examples of data augmentation.</p><div class="footer">
<p>Source: Buah et al.&nbsp;(2019), <em>Can Artificial Intelligence Assist Project Developers in Long-Term Management of Energy Projects? The Case of CO2 Capture and Storage</em>.</p>
</div>
</section>
<section id="inception-module-2013" class="slide level2">
<h2>Inception module (2013)</h2>
<p>Used in ILSVRC 2013 winning solution (top-5 error &lt; 7%).</p>
<div class="columns">
<div class="column" style="width:59%;">
<p><img data-src="inception-module-fig-2b.png"></p>
</div><div class="column" style="width:39%;">
<p><br></p>
<p><img data-src="inception-meme.jpeg"></p>
</div>
</div>
<p>VGGNet was the runner-up.</p>
<div class="footer">
<p>Source: Szegedy, C. et al.&nbsp;(2014), <a href="https://arxiv.org/pdf/1409.4842.pdf"><em>Going deeper with convolutions</em></a>. and <a href="https://knowyourmeme.com/memes/we-need-to-go-deeper">KnowYourMeme.com</a></p>
</div>
</section>
<section id="googlenet-inception_v0-2014" class="slide level2">
<h2>GoogLeNet / Inception_v0 (2014)</h2>

<img data-src="Geron-mls2_1414.png" class="r-stretch quarto-figure-center"><p class="caption">Schematic of the GoogLeNet architecture.</p><div class="footer">
<p>Source: Aurélien Géron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-14.</p>
</div>
</section>
<section id="depth-is-important-for-image-tasks" class="slide level2">
<h2>Depth is important for image tasks</h2>

<img data-src="goodfellow-depth-matters.png" class="r-stretch quarto-figure-center"><p class="caption">Deeper models aren’t just better because they have more parameters. Model depth given in the legend. Accuracy is on the Street View House Numbers dataset.</p><div class="footer">
<p>Source: Goodfellow et al.&nbsp;(2015), <a href="http://www.deeplearningbook.org">Deep Learning</a>, Figure 6.7.</p>
</div>
</section>
<section id="residual-connection" class="slide level2">
<h2>Residual connection</h2>

<img data-src="Geron-mls2_1415.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of a residual connection.</p><div class="footer">
<p>Source: Aurélien Géron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-15.</p>
</div>
</section>
<section id="resnet-2014" class="slide level2">
<h2>ResNet (2014)</h2>
<p>ResNet won the ILSVRC 2014 challenge (top-5 error 3.6%), developed by <a href="https://arxiv.org/abs/1512.03385">Kaiming He et al.</a></p>

<img data-src="Geron-mls2_1417.png" class="r-stretch quarto-figure-center"><p class="caption">Diagram of the ResNet architecture.</p><div class="footer">
<p>Source: Aurélien Géron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-17.</p>
</div>
</section></section>
<section>
<section id="transfer-learning" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Transfer learning</h1>

</section>
<section id="pretrained-model" class="slide level2">
<h2>Pretrained model</h2>
<div id="9895776a" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a></a><span class="im">from</span> tensorflow.keras.applications <span class="im">import</span> mobilenet</span>
<span id="cb86-2"><a></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb86-3"><a></a></span>
<span id="cb86-4"><a></a>model <span class="op">=</span> mobilenet.MobileNet(weights<span class="op">=</span><span class="st">"imagenet"</span>)</span>
<span id="cb86-5"><a></a></span>
<span id="cb86-6"><a></a>imageFilenames <span class="op">=</span> [<span class="st">"patrick-0.jpg"</span>, <span class="st">"umbrella-0.jpg"</span>, <span class="st">"hand-15.jpg"</span>]</span>
<span id="cb86-7"><a></a>images <span class="op">=</span> [np.asarray(Image.<span class="bu">open</span>(name)) <span class="cf">for</span> name <span class="kw">in</span> imageFilenames]</span>
<span id="cb86-8"><a></a></span>
<span id="cb86-9"><a></a>images_resized <span class="op">=</span> tf.image.resize(images, [<span class="dv">224</span>, <span class="dv">224</span>])</span>
<span id="cb86-10"><a></a>inputs <span class="op">=</span> mobilenet.preprocess_input(images_resized)</span>
<span id="cb86-11"><a></a></span>
<span id="cb86-12"><a></a>Y_proba <span class="op">=</span> model.predict(inputs, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb86-13"><a></a>top_K <span class="op">=</span> mobilenet.decode_predictions(Y_proba, top<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb86-14"><a></a></span>
<span id="cb86-15"><a></a><span class="cf">for</span> image_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(images)):</span>
<span id="cb86-16"><a></a>    <span class="bu">print</span>(<span class="ss">f"Image #</span><span class="sc">{</span>image_index<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb86-17"><a></a>    <span class="cf">for</span> class_id, name, y_proba <span class="kw">in</span> top_K[image_index]:</span>
<span id="cb86-18"><a></a>        <span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>class_id<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span><span class="bu">int</span>(y_proba<span class="op">*</span><span class="dv">100</span>)<span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb86-19"><a></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicted-classes-mobilenet" class="slide level2">
<h2>Predicted classes (MobileNet)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="4708731e" class="cell" data-execution_count="67">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 39%
 n04591157 - Windsor_tie 34%
 n02749479 - assault_rifle 13%

Image #1:
 n03529860 - home_theater 25%
 n02749479 - assault_rifle 9%
 n04009552 - projector 5%

Image #2:
 n03529860 - home_theater 9%
 n03924679 - photocopier 7%
 n02786058 - Band_Aid 6%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenetv2" class="slide level2">
<h2>Predicted classes (MobileNetV2)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="52d3a154" class="cell" data-execution_count="68">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 34%
 n04591157 - Windsor_tie 8%
 n03630383 - lab_coat 7%

Image #1:
 n04023962 - punching_bag 9%
 n04336792 - stretcher 4%
 n03529860 - home_theater 4%

Image #2:
 n04404412 - television 42%
 n02977058 - cash_machine 6%
 n04152593 - screen 3%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-inceptionv3" class="slide level2">
<h2>Predicted classes (InceptionV3)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="a3e55ca8" class="cell" data-execution_count="69">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 25%
 n04591157 - Windsor_tie 10%
 n03630383 - lab_coat 4%

Image #1:
 n04507155 - umbrella 46%
 n03529860 - home_theater 2%
 n04344873 - studio_couch 2%

Image #2:
 n04404412 - television 20%
 n03630383 - lab_coat 7%
 n02777292 - balance_beam 7%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenet-1" class="slide level2">
<h2>Predicted classes (MobileNet)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="d7a0ab12" class="cell" data-execution_count="70">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n03483316 - hand_blower 21%
 n03271574 - electric_fan 8%
 n07579787 - plate 4%

Image #1:
 n03942813 - ping-pong_ball 88%
 n02782093 - balloon 3%
 n04023962 - punching_bag 1%

Image #2:
 n04557648 - water_bottle 31%
 n04336792 - stretcher 14%
 n03868863 - oxygen_mask 7%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenetv2-1" class="slide level2">
<h2>Predicted classes (MobileNetV2)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="386445d4" class="cell" data-execution_count="71">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n03868863 - oxygen_mask 37%
 n03483316 - hand_blower 7%
 n03271574 - electric_fan 7%

Image #1:
 n03942813 - ping-pong_ball 29%
 n04270147 - spatula 12%
 n03970156 - plunger 8%

Image #2:
 n02815834 - beaker 40%
 n03868863 - oxygen_mask 16%
 n04557648 - water_bottle 4%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-inceptionv3-1" class="slide level2">
<h2>Predicted classes (InceptionV3)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="4de7513f" class="cell" data-execution_count="72">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n02815834 - beaker 41%
 n03630383 - lab_coat 6%
 n03179701 - desk 6%

Image #1:
 n03942813 - ping-pong_ball 82%
 n02782093 - balloon 10%
 n03447721 - gong 0%

Image #2:
 n04557648 - water_bottle 72%
 n03983396 - pop_bottle 10%
 n03868863 - oxygen_mask 1%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="transfer-learned-model" class="slide level2">
<h2>Transfer learned model</h2>
<div class="columns">
<div class="column" style="width:65%;">
<div id="f3ae8a47" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a></a>modelFile <span class="op">=</span> <span class="st">"teachable-machine-model-3143.h5"</span></span>
<span id="cb93-2"><a></a>model <span class="op">=</span> keras.models.load_model(modelFile)</span>
<span id="cb93-3"><a></a>model.layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>[&lt;keras.engine.sequential.Sequential at 0x29e4834f0&gt;,
 &lt;keras.engine.sequential.Sequential at 0x2bfa56f50&gt;]</code></pre>
</div>
</div>
<div id="731e5bd3" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a></a>model.layers[<span class="dv">0</span>].layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>[&lt;keras.engine.functional.Functional at 0x2bfa57f10&gt;,
 &lt;keras.layers.pooling.global_average_pooling2d.GlobalAveragePooling2D at 0x2bfb5d3f0&gt;]</code></pre>
</div>
</div>
<div id="a0acadab" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a></a>model.layers[<span class="dv">1</span>].layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>[&lt;keras.layers.core.dense.Dense at 0x2e095e980&gt;,
 &lt;keras.layers.core.dense.Dense at 0x2e001f880&gt;]</code></pre>
</div>
</div>
</div><div class="column" style="width:35%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="turtles-all-the-way-down.jpeg"></p>
<figcaption>Models inside of models…</figcaption>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: <a href="https://www.behance.net/gallery/66946885/Turtles-All-the-Way-Down">Behance</a></p>
</div>
</section>
<section id="transfer-learned-model-ii" class="slide level2">
<h2>Transfer learned model II</h2>
<div id="df6be967" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a></a>model.layers[<span class="dv">0</span>].layers[<span class="dv">0</span>].layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>[&lt;keras.engine.input_layer.InputLayer at 0x2e1fb6f80&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x2be515d80&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be516050&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be516200&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be5167d0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x2be516e60&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be5174c0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be517670&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be517d00&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be517e20&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be4604c0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be460a30&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be461000&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x2be461690&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x2be461960&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be461fc0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be462170&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be462800&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be4629b0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be462f80&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be4634f0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be463ac0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x2be4d1240&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be4587f0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be4589a0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be459030&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be4591e0&gt;,
 &lt;keras.layers.merging.add.Add at 0x2be459c00&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be459bd0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be459f00&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be45a590&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x2be45ac20&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x2be45aef0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be45b550&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be45b700&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be45bd90&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be45beb0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be464550&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be464ac0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be465090&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x2be465720&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be465d80&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be465f30&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be4665c0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be466770&gt;,
 &lt;keras.layers.merging.add.Add at 0x2be467190&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x2be467160&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x2be467490&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x2be467b20&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x2be4d3fa0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e714850&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e714a00&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e715090&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e715240&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e715c60&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e715c30&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e715f60&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e7165f0&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x29e716c80&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e716f50&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e7175b0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e717760&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e717df0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e717f10&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e6b85b0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e6b8b20&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e6b90f0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e6b9780&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e6b9de0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e6b9f90&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e6ba620&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e6ba7d0&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e6bb1f0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e6bb1c0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e6bb4f0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e6bbb80&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e650250&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e6508b0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e650a60&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e6510f0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e6512a0&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e651cc0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e651c90&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e651fc0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e652650&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e652ce0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e653340&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e6534f0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e653b80&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e653ca0&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e64c790&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e64c760&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e64ca90&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e64d120&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e64d7b0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e64de10&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e64dfc0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e64e650&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e64e800&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e64edd0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e64f340&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e64f910&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e64ffa0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e700640&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e7007f0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e700e80&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e701030&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e701a50&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e701a20&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e701d50&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e7023e0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e702a70&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e7030d0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e703280&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e703910&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e703ac0&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e638520&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e703fa0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e638820&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e638eb0&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x29e639540&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e639810&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e639e70&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e63a020&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e63a6b0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e63a860&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e63ae30&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e63b3a0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e63b970&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x2be467f40&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e6446a0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e644850&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e644ee0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e645090&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e645ab0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e645a80&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e645db0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e646440&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e646ad0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e647130&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e6472e0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e647970&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e647b20&gt;,
 &lt;keras.layers.merging.add.Add at 0x29e62c580&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e62c550&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e62c880&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e62cf10&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x29e62d5a0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e62dc00&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e62ddb0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e62e440&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e62e5f0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x29e62ebc0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x29e62f130&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x29e62f700&gt;]</code></pre>
</div>
</div>
<div id="805ac66d" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a></a><span class="bu">len</span>(model.layers[<span class="dv">0</span>].layers[<span class="dv">0</span>].layers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>155</code></pre>
</div>
</div>
</section>
<section id="transfer-learned-model-iii" class="slide level2">
<h2>Transfer learned model III</h2>
<div style="overflow:auto; height: 90%">
<p><img src="mobilenet-model.png"></p>
</div>
</section>
<section id="transfer-learning-1" class="slide level2">
<h2>Transfer learning</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a></a><span class="co"># Pull in the base model we are transferring from.</span></span>
<span id="cb103-2"><a></a>base_model <span class="op">=</span> keras.applications.Xception(</span>
<span id="cb103-3"><a></a>    weights<span class="op">=</span><span class="st">'imagenet'</span>,  <span class="co"># Load weights pre-trained on ImageNet.</span></span>
<span id="cb103-4"><a></a>    input_shape<span class="op">=</span>(<span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">3</span>),</span>
<span id="cb103-5"><a></a>    include_top<span class="op">=</span><span class="va">False</span>)  <span class="co"># Discard the ImageNet classifier at the top.</span></span>
<span id="cb103-6"><a></a></span>
<span id="cb103-7"><a></a><span class="co"># Tell it not to update its weights.</span></span>
<span id="cb103-8"><a></a>base_model.trainable <span class="op">=</span> <span class="va">False</span></span>
<span id="cb103-9"><a></a></span>
<span id="cb103-10"><a></a><span class="co"># Make our new model on top of the base model.</span></span>
<span id="cb103-11"><a></a>inputs <span class="op">=</span> keras.Input(shape<span class="op">=</span>(<span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">3</span>))</span>
<span id="cb103-12"><a></a>x <span class="op">=</span> base_model(inputs, training<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb103-13"><a></a>x <span class="op">=</span> keras.layers.GlobalAveragePooling1D()(x)</span>
<span id="cb103-14"><a></a>outputs <span class="op">=</span> keras.layers.Dense(<span class="dv">0</span>)(x)</span>
<span id="cb103-15"><a></a>model <span class="op">=</span> keras.Model(inputs, outputs)</span>
<span id="cb103-16"><a></a></span>
<span id="cb103-17"><a></a><span class="co"># Compile and fit on our data.</span></span>
<span id="cb103-18"><a></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span>keras.optimizers.Adam(),</span>
<span id="cb103-19"><a></a>              loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb103-20"><a></a>              metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb103-21"><a></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">19</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="footer">
<p>Source: François Chollet (2019), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section>
<section id="fine-tuning" class="slide level2">
<h2>Fine-tuning</h2>
<div class="sourceCode" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a></a><span class="co"># Unfreeze the base model</span></span>
<span id="cb104-2"><a></a>base_model.trainable <span class="op">=</span> <span class="va">True</span></span>
<span id="cb104-3"><a></a></span>
<span id="cb104-4"><a></a><span class="co"># It's important to recompile your model after you make any changes</span></span>
<span id="cb104-5"><a></a><span class="co"># to the `trainable` attribute of any inner layer, so that your changes</span></span>
<span id="cb104-6"><a></a><span class="co"># are take into account</span></span>
<span id="cb104-7"><a></a>model.<span class="bu">compile</span>(</span>
<span id="cb104-8"><a></a>    optimizer<span class="op">=</span>keras.optimizers.Adam(<span class="fl">0e-5</span>),  <span class="co"># Very low learning rate</span></span>
<span id="cb104-9"><a></a>    loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb104-10"><a></a>    metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb104-11"><a></a></span>
<span id="cb104-12"><a></a><span class="co"># Train end-to-end. Be careful to stop before you overfit!</span></span>
<span id="cb104-13"><a></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">9</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p>Keep the learning rate low, otherwise you may accidentally throw away the useful information in the base model.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: François Chollet (2019), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section></section>
<section id="section-2" class="title-slide slide level1 center" data-visibility="uncounted">
<h1></h1>
<h2>
Glossary
</h2>
<div class="columns">
<div class="column">
<ul>
<li>AlexNet</li>
<li>benchmark problems</li>
<li>channels</li>
<li>CIFAR-10 / CIFAR-100</li>
<li>computer vision</li>
<li>convolutional layer</li>
<li>convolutional network</li>
<li>error analysis</li>
<li>filter</li>
</ul>
</div><div class="column">
<ul>
<li>GoogLeNet &amp; Inception</li>
<li>ImageNet challenge</li>
<li>fine-tuning</li>
<li>flatten layer</li>
<li>kernel</li>
<li>max pooling</li>
<li>MNIST</li>
<li>stride</li>
<li>transfer learning</li>
</ul>
</div>
</div>
<script defer="">
    // Remove the highlight.js class for the 'compile', 'min', 'max'
    // as there's a bug where they are treated like the Python built-in
    // global functions but we only ever see it as methods like
    // 'model.compile()' or 'predictions.max()'
    buggyBuiltIns = ["compile", "min", "max", "round", "sum"];

    document.querySelectorAll('.bu').forEach((elem) => {
        if (buggyBuiltIns.includes(elem.innerHTML)) {
            elem.classList.remove('bu');
        }
    })
</script>

<div class="quarto-auto-generated-content">
<p><img src="../unsw-logo.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":4,"grid":false,"background":["rgba(255,255,255,0.0)","https://github.com/rajgoel/reveal.js-plugins/raw/master/chalkboard/img/blackboard.png"]},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1000,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.12,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>