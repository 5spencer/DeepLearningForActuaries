<!DOCTYPE html>
<html lang="en"><head>
<script src="advanced-topics_files/libs/clipboard/clipboard.min.js"></script>
<script src="advanced-topics_files/libs/quarto-html/tabby.min.js"></script>
<script src="advanced-topics_files/libs/quarto-html/popper.min.js"></script>
<script src="advanced-topics_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="advanced-topics_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="advanced-topics_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="advanced-topics_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Dr Patrick Laub">
  <title>Advanced Topics &amp; Revision</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="advanced-topics_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="advanced-topics_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="advanced-topics_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="advanced-topics_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="advanced-topics_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="advanced-topics_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="advanced-topics_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="advanced-topics_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="advanced-topics_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
<div class="line right"></div>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="unsw-yellow-shape.png" data-background-size="contain !important" class="quarto-title-block center">
  <h1 class="title">Advanced Topics &amp; Revision</h1>
  <p class="subtitle">ACTL3143 &amp; ACTL5111 Deep Learning for Actuaries</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr Patrick Laub 
</div>
</div>
</div>

</section>
<section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>
<h2>
Lecture Outline
</h2>
<p><br></p>
<ul>
<li>Dissecting <code>model.fit</code></li>
<li>Object oriented programming &amp; PyTorch</li>
<li>Generative adversarial networks</li>
<li>Exam preparation</li>
</ul>
<p><br><br><br></p>
</section>
<section id="announcements" class="slide level2">
<h2>Announcements</h2>
<ul>
<li>Previous StoryWall was quite successful.</li>
<li>Young Data Analytics Working Group podcast opportunity.</li>
<li>Project marks will go on Moodle next week.</li>
<li>Final Story Wall is due <strong>this Friday at noon</strong>.</li>
</ul>
</section>
<section id="exam-details" class="slide level2">
<h2>Exam details</h2>
<ul>
<li>Thursday 18th Aug 2 pm - 4 pm (14:00-16:00)</li>
<li>Exam is a Moodle quiz</li>
<li>Open book (if you see “No Exam Materials permitted” just ignore it)</li>
<li>Link at the top of the Moodle page for the course</li>
<li>Exam open for 2 hours, but <strong>you have 1.5 hours</strong> to complete</li>
<li>Complete the IT preparation checklist (MFA, speed test, read policies)</li>
</ul>
</section>
<section id="dall-e-2" class="slide level2">
<h2>DALL-E 2</h2>

<img data-src="dall-e-2-teddy-bears-on-moon.jpeg" class="r-stretch quarto-figure-center"><p class="caption">DALL-E 2 example: “Teddy bears working on new AI research on the moon in the 1980s”</p><div class="footer">
<p>Source: OpenAI, <a href="https://openai.com/dall-e-2/">DALL-E 2</a>.</p>
</div>
</section>
<section id="dall-e-2-beta" class="slide level2 smaller">
<h2>DALL-E 2 Beta</h2>
<p><em>A painting of a penguin in a library studying a textbook while eating sushi and drinking a strawberry milkshake</em></p>
<div class="columns">
<div class="column">
<p><img data-src="DALL-E/DALL·E%202022-07-28%2008.55.22%20-%20A%20painting%20of%20a%20penguin%20in%20a%20library%20studying%20a%20textbook%20while%20eating%20sushi%20and%20drinking%20a%20strawberry%20milkshake%20.png"></p>
</div><div class="column">
<p><img data-src="DALL-E/DALL·E%202022-07-28%2008.55.28%20-%20A%20painting%20of%20a%20penguin%20in%20a%20library%20studying%20a%20textbook%20while%20eating%20sushi%20and%20drinking%20a%20strawberry%20milkshake%20.png"></p>
</div>
</div>
</section>
<section id="dall-e-2-beta-ii" class="slide level2 smaller">
<h2>DALL-E 2 Beta II</h2>
<p><em>A painting of a penguin in a library studying a textbook while eating sushi and drinking a strawberry milkshake</em></p>
<div class="columns">
<div class="column">
<p><img data-src="DALL-E/DALL·E%202022-07-28%2008.55.34%20-%20A%20painting%20of%20a%20penguin%20in%20a%20library%20studying%20a%20textbook%20while%20eating%20sushi%20and%20drinking%20a%20strawberry%20milkshake%20.png"></p>
</div><div class="column">
<p><img data-src="DALL-E/DALL·E%202022-07-28%2008.55.40%20-%20A%20painting%20of%20a%20penguin%20in%20a%20library%20studying%20a%20textbook%20while%20eating%20sushi%20and%20drinking%20a%20strawberry%20milkshake%20.png"></p>
</div>
</div>
</section>
<section id="load-packages" class="slide level2" data-visibility="uncounted">
<h2>Load packages</h2>
<p><br></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> random</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="op">%</span>load_ext watermark</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="op">%</span>watermark <span class="op">-</span>p matplotlib,numpy,pandas,tensorflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>matplotlib: 3.6.2
numpy     : 1.23.4
pandas    : 1.5.1
tensorflow: 2.10.0
</code></pre>
</div>
</div>
</section></section>
<section>
<section id="pytorch" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>PyTorch</h1>

</section>
<section id="why" class="slide level2">
<h2>Why?</h2>

<img data-src="pytorch-papers-of-total.svg" class="r-stretch quarto-figure-center"><p class="caption">Fraction of ML papers using PyTorch.</p><div class="footer">
<p>Source: Horace He (2022), <a href="http://horace.io/pytorch-vs-tensorflow/">pytorch-vs-tensorflow</a>.</p>
</div>
</section>
<section id="load-up-fashionmnist" class="slide level2">
<h2>Load up FashionMNIST</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> torch</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> torchvision</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="im">from</span> torch <span class="im">import</span> nn</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="op">%</span>watermark <span class="op">-</span>p torch,torchvision</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch      : 1.13.0
torchvision: 0.14.0
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>training_data <span class="op">=</span> torchvision.datasets.FashionMNIST(</span>
<span id="cb5-2"><a href="#cb5-2"></a>    root<span class="op">=</span><span class="st">"data"</span>, train<span class="op">=</span><span class="va">True</span>, download<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-3"><a href="#cb5-3"></a>    transform<span class="op">=</span>torchvision.transforms.ToTensor())</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>test_data <span class="op">=</span> torchvision.datasets.FashionMNIST(</span>
<span id="cb5-6"><a href="#cb5-6"></a>    root<span class="op">=</span><span class="st">"data"</span>, train<span class="op">=</span><span class="va">False</span>, download<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>    transform<span class="op">=</span>torchvision.transforms.ToTensor())</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>classes <span class="op">=</span> [</span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="st">"T-shirt/top"</span>, <span class="st">"Trouser"</span>, <span class="st">"Pullover"</span>, <span class="st">"Dress"</span>, <span class="st">"Coat"</span>, </span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="st">"Sandal"</span>, <span class="st">"Shirt"</span>, <span class="st">"Sneaker"</span>, <span class="st">"Bag"</span>, <span class="st">"Ankle boot"</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="footer">
<p>Adapted from: PyTorch (2022), <a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">Quickstart</a>, PyTorch docs.</p>
</div>
</section>
<section id="take-a-look-at-the-data" class="slide level2">
<h2>Take a look at the data</h2>
<div class="columns">
<div class="column" style="width:33%;">
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>x, y <span class="op">=</span> training_data[<span class="dv">5</span>]</span>
<span id="cb6-2"><a href="#cb6-2"></a>plt.imshow(x[<span class="dv">0</span>])</span>
<span id="cb6-3"><a href="#cb6-3"></a>plt.title(classes[y])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="advanced-topics_files/figure-revealjs/cell-6-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>x, y <span class="op">=</span> training_data[<span class="dv">25</span>]</span>
<span id="cb7-2"><a href="#cb7-2"></a>plt.imshow(x[<span class="dv">0</span>])</span>
<span id="cb7-3"><a href="#cb7-3"></a>plt.title(classes[y])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="advanced-topics_files/figure-revealjs/cell-7-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>x, y <span class="op">=</span> training_data[<span class="dv">30</span>]</span>
<span id="cb8-2"><a href="#cb8-2"></a>plt.imshow(x[<span class="dv">0</span>])</span>
<span id="cb8-3"><a href="#cb8-3"></a>plt.title(classes[y])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="advanced-topics_files/figure-revealjs/cell-8-output-1.png"></p>
</div>
</div>
</div>
</div>
<div class="footer">
<p>Adapted from: PyTorch (2022), <a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">Quickstart</a>, PyTorch docs.</p>
</div>
</section>
<section id="batch-up-the-data" class="slide level2">
<h2>Batch up the data</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>batch_size <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># Create data loaders.</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>train_dataloader <span class="op">=</span> DataLoader(training_data, batch_size<span class="op">=</span>batch_size)</span>
<span id="cb9-5"><a href="#cb9-5"></a>test_dataloader <span class="op">=</span> DataLoader(test_data, batch_size<span class="op">=</span>batch_size)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="cf">for</span> X, y <span class="kw">in</span> test_dataloader:</span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="bu">print</span>(<span class="ss">f"Shape of X [N, C, H, W]: </span><span class="sc">{</span>X<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="bu">print</span>(<span class="ss">f"Shape of y: </span><span class="sc">{</span>y<span class="sc">.</span>shape<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>y<span class="sc">.</span>dtype<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="cf">break</span></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co"># Get cpu or gpu device for training.</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co"># Get cpu or gpu device for training.</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="cf">if</span> torch.cuda.is_available():</span>
<span id="cb9-15"><a href="#cb9-15"></a>    device <span class="op">=</span> <span class="st">"cuda"</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="cf">elif</span> torch.backends.mps.is_available():</span>
<span id="cb9-17"><a href="#cb9-17"></a>    device <span class="op">=</span> <span class="st">"mps"</span> <span class="co"># If on a Mac</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="cf">else</span>:</span>
<span id="cb9-19"><a href="#cb9-19"></a>    device <span class="op">=</span> <span class="st">"cpu"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of X [N, C, H, W]: torch.Size([64, 1, 28, 28])
Shape of y: torch.Size([64]) torch.int64</code></pre>
</div>
</div>
<div class="footer">
<p>Adapted from: PyTorch (2022), <a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">Quickstart</a>, PyTorch docs.</p>
</div>
</section>
<section id="make-a-sequential-model" class="slide level2">
<h2>Make a sequential model</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>torch.manual_seed(<span class="dv">0</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>model <span class="op">=</span> nn.Sequential(</span>
<span id="cb11-3"><a href="#cb11-3"></a>            nn.Flatten(),</span>
<span id="cb11-4"><a href="#cb11-4"></a>            nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>),</span>
<span id="cb11-5"><a href="#cb11-5"></a>            nn.ReLU(),</span>
<span id="cb11-6"><a href="#cb11-6"></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>),</span>
<span id="cb11-7"><a href="#cb11-7"></a>            nn.ReLU(),</span>
<span id="cb11-8"><a href="#cb11-8"></a>            nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>        )</span>
<span id="cb11-10"><a href="#cb11-10"></a>model <span class="op">=</span> model.to(device)</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="bu">print</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sequential(
  (0): Flatten(start_dim=1, end_dim=-1)
  (1): Linear(in_features=784, out_features=512, bias=True)
  (2): ReLU()
  (3): Linear(in_features=512, out_features=512, bias=True)
  (4): ReLU()
  (5): Linear(in_features=512, out_features=10, bias=True)
)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>epochs <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>loss_fn <span class="op">=</span> nn.CrossEntropyLoss()</span>
<span id="cb13-3"><a href="#cb13-3"></a>optimizer <span class="op">=</span> torch.optim.SGD(model.parameters(), lr<span class="op">=</span><span class="fl">1e-3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-a-train-loop" class="slide level2">
<h2>Run a train loop</h2>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">%%</span>time</span>
<span id="cb14-2"><a href="#cb14-2"></a>model.train()</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(epochs):    </span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="cf">for</span> X, y <span class="kw">in</span> train_dataloader:</span>
<span id="cb14-5"><a href="#cb14-5"></a>        X, y <span class="op">=</span> X.to(device), y.to(device)</span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a>        <span class="co"># Compute prediction error</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>        pred <span class="op">=</span> model(X)</span>
<span id="cb14-9"><a href="#cb14-9"></a>        loss <span class="op">=</span> loss_fn(pred, y)</span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a>        <span class="co"># Backpropagation</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>        optimizer.zero_grad()</span>
<span id="cb14-13"><a href="#cb14-13"></a>        loss.backward()</span>
<span id="cb14-14"><a href="#cb14-14"></a>        optimizer.step()</span>
<span id="cb14-15"><a href="#cb14-15"></a></span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="bu">print</span>(<span class="ss">f"Epoch </span><span class="sc">{</span>t<span class="sc">}</span><span class="ss"> Loss: </span><span class="sc">{</span>loss<span class="sc">.</span>item()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 0 Loss: 2.158100128173828</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1 Loss: 1.904515027999878</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 2 Loss: 1.5597740411758423
CPU times: user 9.59 s, sys: 1.29 s, total: 10.9 s
Wall time: 11 s</code></pre>
</div>
</div>
<div class="footer">
<p>Adapted from: PyTorch (2022), <a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">Quickstart</a>, PyTorch docs.</p>
</div>
</section>
<section id="far-more-common-to-subclass" class="slide level2">
<h2>Far more common to subclass</h2>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">class</span> NeuralNetwork(nn.Module):</span>
<span id="cb18-2"><a href="#cb18-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb18-3"><a href="#cb18-3"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb18-4"><a href="#cb18-4"></a>        <span class="va">self</span>.linear1 <span class="op">=</span> nn.Linear(<span class="dv">28</span><span class="op">*</span><span class="dv">28</span>, <span class="dv">512</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>        <span class="va">self</span>.linear2 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, <span class="dv">512</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a>        <span class="va">self</span>.linear3 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, <span class="dv">10</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>        </span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb18-9"><a href="#cb18-9"></a>        x <span class="op">=</span> F.relu(<span class="va">self</span>.linear1(x.flatten(<span class="dv">1</span>)))</span>
<span id="cb18-10"><a href="#cb18-10"></a>        x <span class="op">=</span> F.relu(<span class="va">self</span>.linear2(x))</span>
<span id="cb18-11"><a href="#cb18-11"></a>        <span class="cf">return</span> <span class="va">self</span>.linear3(x)</span>
<span id="cb18-12"><a href="#cb18-12"></a>        </span>
<span id="cb18-13"><a href="#cb18-13"></a>torch.manual_seed(<span class="dv">0</span>)</span>
<span id="cb18-14"><a href="#cb18-14"></a>classy_model <span class="op">=</span> NeuralNetwork().to(device)</span>
<span id="cb18-15"><a href="#cb18-15"></a>classy_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>NeuralNetwork(
  (linear1): Linear(in_features=784, out_features=512, bias=True)
  (linear2): Linear(in_features=512, out_features=512, bias=True)
  (linear3): Linear(in_features=512, out_features=10, bias=True)
)</code></pre>
</div>
</div>
<div class="footer">
<p>Adapted from: PyTorch (2022), <a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">Quickstart</a>, PyTorch docs.</p>
</div>
</section>
<section id="evaluate-the-fit" class="slide level2">
<h2>Evaluate the fit</h2>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>model.<span class="bu">eval</span>()</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a>num_correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>test_size <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="cf">for</span> X, y <span class="kw">in</span> test_dataloader:</span>
<span id="cb20-6"><a href="#cb20-6"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb20-7"><a href="#cb20-7"></a>        pred <span class="op">=</span> model(X.to(device))</span>
<span id="cb20-8"><a href="#cb20-8"></a>        num_correct <span class="op">+=</span> torch.<span class="bu">sum</span>(y.to(device) <span class="op">==</span> pred.argmax(<span class="dv">1</span>)).item()</span>
<span id="cb20-9"><a href="#cb20-9"></a>        test_size <span class="op">+=</span> <span class="bu">len</span>(y)</span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="bu">print</span>(<span class="ss">f"Test accuracy: </span><span class="sc">{</span><span class="dv">100</span><span class="op">*</span>num_correct<span class="op">/</span>test_size<span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test accuracy: 61.30%</code></pre>
</div>
</div>
</section>
<section id="predict-new-data" class="slide level2">
<h2>Predict new data</h2>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>X, y <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(test_dataloader))</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb22-3"><a href="#cb22-3"></a>    pred <span class="op">=</span> model(X.to(device))</span>
<span id="cb22-4"><a href="#cb22-4"></a></span>
<span id="cb22-5"><a href="#cb22-5"></a>predicted_classes <span class="op">=</span> [classes[ind] <span class="cf">for</span> ind <span class="kw">in</span> pred.argmax(<span class="dv">1</span>)]</span>
<span id="cb22-6"><a href="#cb22-6"></a>actual_classes <span class="op">=</span> [classes[ind] <span class="cf">for</span> ind <span class="kw">in</span> y]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:33%;">
<div class="cell" data-execution_count="15">
<div class="cell-output cell-output-display">
<p><img data-src="advanced-topics_files/figure-revealjs/cell-16-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<p><img data-src="advanced-topics_files/figure-revealjs/cell-17-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-execution_count="17">
<div class="cell-output cell-output-display">
<p><img data-src="advanced-topics_files/figure-revealjs/cell-18-output-1.png"></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="other-useful-packages" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Other Useful Packages</h1>

</section>
<section id="tensorflow-probability" class="slide level2">
<h2>Tensorflow Probability</h2>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="im">import</span> tensorflow_probability <span class="im">as</span> tfp</span>
<span id="cb23-2"><a href="#cb23-2"></a>tfd <span class="op">=</span> tfp.distributions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>random.seed(<span class="dv">123</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>model <span class="op">=</span> keras.Sequential([</span>
<span id="cb24-3"><a href="#cb24-3"></a>  layers.Dense(<span class="dv">24</span>, <span class="st">"leaky_relu"</span>, input_dim<span class="op">=</span>X_train.shape[<span class="dv">1</span>]),</span>
<span id="cb24-4"><a href="#cb24-4"></a>  layers.Dense(<span class="dv">1</span>, <span class="st">"exponential"</span>),</span>
<span id="cb24-5"><a href="#cb24-5"></a>  tfp.layers.DistributionLambda(tfd.Poisson)</span>
<span id="cb24-6"><a href="#cb24-6"></a>])</span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="kw">def</span> NLL(y_true, y_hat):</span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="cf">return</span> <span class="op">-</span>y_hat.log_prob(y_true)</span>
<span id="cb24-10"><a href="#cb24-10"></a></span>
<span id="cb24-11"><a href="#cb24-11"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span>NLL)</span>
<span id="cb24-12"><a href="#cb24-12"></a>model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">3</span>, verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Suggested viewing</strong></p>
</div>
<div class="callout-content">
<p>Josh Dylan (2019), <a href="https://youtu.be/BrwKURU-wpk">TensorFlow Probability: Learning with confidence</a>, TF Dev Summit ’19, YouTube (14 mins).</p>
</div>
</div>
</div>
</section>
<section id="predictions-are-then-distributions" class="slide level2">
<h2>Predictions are then distributions</h2>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>y_pred <span class="op">=</span> model(X_val)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="bu">type</span>(y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>tensorflow_probability.python.layers.internal.distribution_tensor_coercible._TensorCoercible</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>y_pred.mean()[:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>&lt;tf.Tensor: shape=(3, 1), dtype=float32, numpy=
array([[0.0485],
       [0.0217],
       [0.0309]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>y_pred.stddev()[:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>&lt;tf.Tensor: shape=(3, 1), dtype=float32, numpy=
array([[0.2201],
       [0.1472],
       [0.1757]], dtype=float32)&gt;</code></pre>
</div>
</div>
</section>
<section id="zero-inflated-poisson" class="slide level2">
<h2>Zero-inflated Poisson</h2>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">def</span> zero_inf(out): </span>
<span id="cb31-2"><a href="#cb31-2"></a>  rate <span class="op">=</span> tf.squeeze(tf.math.exp(out[:,<span class="dv">0</span>:<span class="dv">1</span>]))</span>
<span id="cb31-3"><a href="#cb31-3"></a>  s <span class="op">=</span> tf.math.sigmoid(out[:,<span class="dv">1</span>:<span class="dv">2</span>])</span>
<span id="cb31-4"><a href="#cb31-4"></a>  probs <span class="op">=</span> tf.concat([<span class="dv">1</span><span class="op">-</span>s, s], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="cf">return</span> tfd.Mixture(</span>
<span id="cb31-6"><a href="#cb31-6"></a>    cat<span class="op">=</span>tfd.Categorical(probs<span class="op">=</span>probs),</span>
<span id="cb31-7"><a href="#cb31-7"></a>    components<span class="op">=</span>[</span>
<span id="cb31-8"><a href="#cb31-8"></a>      tfd.Deterministic(loc<span class="op">=</span>tf.zeros_like(rate)),</span>
<span id="cb31-9"><a href="#cb31-9"></a>      tfd.Poisson(rate<span class="op">=</span>rate),</span>
<span id="cb31-10"><a href="#cb31-10"></a>    ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>random.seed(<span class="dv">123</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a>zip_model <span class="op">=</span> keras.Sequential([</span>
<span id="cb32-4"><a href="#cb32-4"></a>  layers.Dense(<span class="dv">24</span>, <span class="st">"leaky_relu"</span>, input_dim<span class="op">=</span>X_train.shape[<span class="dv">1</span>]),</span>
<span id="cb32-5"><a href="#cb32-5"></a>  layers.Dense(<span class="dv">2</span>),</span>
<span id="cb32-6"><a href="#cb32-6"></a>  tfp.layers.DistributionLambda(zero_inf)</span>
<span id="cb32-7"><a href="#cb32-7"></a>])</span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="kw">def</span> NLL(y_true, y_hat):</span>
<span id="cb32-10"><a href="#cb32-10"></a>  <span class="cf">return</span> <span class="op">-</span>y_hat.log_prob(y_true)</span>
<span id="cb32-11"><a href="#cb32-11"></a></span>
<span id="cb32-12"><a href="#cb32-12"></a>zip_model.<span class="bu">compile</span>(loss<span class="op">=</span>NLL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluations-are-then-likelihoods" class="slide level2">
<h2>Evaluations are then likelihoods</h2>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>zip_model.fit(X_train, y_train, epochs<span class="op">=</span><span class="dv">3</span>, verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>model.evaluate(X_val, y_val, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0.2118462771177292</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>zip_model.evaluate(X_val, y_val, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0.2124195545911789</code></pre>
</div>
</div>
<div class="smaller">
<blockquote>
<p>In statistics, sometimes we only use a single data set. To still be able to evaluate the performance of the developed prediction model on the same data, sophisticated methods have developed over a long period of time and are still in use in some parts of the statistics community. These methods account for the fact that the model saw the data during fitting and applied corrections to account for that. These methods include, for example, the Akaike Information Criterion (AIC) or the Bayesian Information Criterion (BIC). Don’t get confused. If you have a validation set, you don’t need these methods.</p>
</blockquote>
</div>
<div class="footer">
<p>Source: Sic &amp; Duerr (2020), Probabilistic Deep Learning, Chapter 5.</p>
</div>
</section>
<section id="huggingfaces-transformers" class="slide level2">
<h2>HuggingFace’s Transformers</h2>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="im">import</span> transformers</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="im">from</span> transformers <span class="im">import</span> pipeline</span>
<span id="cb38-3"><a href="#cb38-3"></a>generator <span class="op">=</span> pipeline(task<span class="op">=</span><span class="st">"text-generation"</span>, model<span class="op">=</span><span class="st">"gpt2"</span>, revision<span class="op">=</span><span class="st">"6c0e608"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>transformers.set_seed(<span class="dv">1</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="bu">print</span>(generator(<span class="st">"It's the holidays so I'm going to enjoy"</span>)[<span class="dv">0</span>][<span class="st">"generated_text"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>It's the holidays so I'm going to enjoy the rest of the time and look forward to this week with new friends!"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>transformers.set_seed(<span class="dv">1337</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="bu">print</span>(generator(<span class="st">"It's the holidays so I'm going to enjoy"</span>)[<span class="dv">0</span>][<span class="st">"generated_text"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>It's the holidays so I'm going to enjoy working as much as possible," he told ABC Radio's Today.

On Thursday, Labor leader Bill Shorten made another announcement about his party's plans for the 2015 ballot.

"We</code></pre>
</div>
</div>
</section>
<section id="reading-the-course-profile" class="slide level2">
<h2>Reading the course profile</h2>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>context <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="st">StoryWall Formative Discussions: An initial StoryWall, worth 2%, is due by noon on June 3. The following StoryWalls are worth 4</span><span class="sc">% e</span><span class="st">ach (taking the best 7 of 9) and are due at noon on the following dates:</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="st">The project will be submitted in stages: draft due at noon on July 1 (10%), recorded presentation due at noon on July 22 (15%), final report due at noon on August 1 (15%).</span></span>
<span id="cb43-4"><a href="#cb43-4"></a></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="st">As a student at UNSW you are expected to display academic integrity in your work and interactions. Where a student breaches the UNSW Student Code with respect to academic integrity, the University may take disciplinary action under the Student Misconduct Procedure. To assure academic integrity, you may be required to demonstrate reasoning, research and the process of constructing work submitted for assessment.</span></span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="st">To assist you in understanding what academic integrity means, and how to ensure that you do comply with the UNSW Student Code, it is strongly recommended that you complete the Working with Academic Integrity module before submitting your first assessment task. It is a free, online self-paced Moodle module that should take about one hour to complete.</span></span>
<span id="cb43-7"><a href="#cb43-7"></a></span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="st">StoryWall (30%)</span></span>
<span id="cb43-9"><a href="#cb43-9"></a></span>
<span id="cb43-10"><a href="#cb43-10"></a><span class="st">The StoryWall format will be used for small weekly questions. Each week of questions will be released on a Monday, and most of them will be due the following Monday at midday (see assessment table for exact dates). Students will upload their responses to the question sets, and give comments on another student's submission. Each week will be worth 4%, and the grading is pass/fail, with the best 7 of 9 being counted. The first week's basic 'introduction' StoryWall post is counted separately and is worth 2%.</span></span>
<span id="cb43-11"><a href="#cb43-11"></a></span>
<span id="cb43-12"><a href="#cb43-12"></a><span class="st">Project (40%)</span></span>
<span id="cb43-13"><a href="#cb43-13"></a></span>
<span id="cb43-14"><a href="#cb43-14"></a><span class="st">Over the term, students will complete an individual project. There will be a selection of deep learning topics to choose from (this will be outlined during Week 1).</span></span>
<span id="cb43-15"><a href="#cb43-15"></a></span>
<span id="cb43-16"><a href="#cb43-16"></a><span class="st">The deliverables for the project will include: a draft/progress report mid-way through the term, a presentation (recorded), a final report including a written summary of the project and the relevant Python code (Jupyter notebook).</span></span>
<span id="cb43-17"><a href="#cb43-17"></a></span>
<span id="cb43-18"><a href="#cb43-18"></a><span class="st">Exam (30%)</span></span>
<span id="cb43-19"><a href="#cb43-19"></a></span>
<span id="cb43-20"><a href="#cb43-20"></a><span class="st">The exam will test the concepts presented in the lectures. For example, students will be expected to: provide definitions for various deep learning terminology, suggest neural network designs to solve risk and actuarial problems, give advice to mock deep learning engineers whose projects have hit common roadblocks, find/explain common bugs in deep learning Python code.</span></span>
<span id="cb43-21"><a href="#cb43-21"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-answering" class="slide level2">
<h2>Question answering</h2>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>qa <span class="op">=</span> pipeline(<span class="st">"question-answering"</span>, model<span class="op">=</span><span class="st">"distilbert-base-cased-distilled-squad"</span>, revision<span class="op">=</span><span class="st">"626af31"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>qa(question<span class="op">=</span><span class="st">"What weight is the exam?"</span>, context<span class="op">=</span>context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>{'score': 0.5019680857658386, 'start': 2092, 'end': 2095, 'answer': '30%'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>qa(question<span class="op">=</span><span class="st">"What topics are in the exam?"</span>, context<span class="op">=</span>context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>{'score': 0.21275846660137177,
 'start': 1778,
 'end': 1791,
 'answer': 'deep learning'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>qa(question<span class="op">=</span><span class="st">"When is the presentation due?"</span>, context<span class="op">=</span>context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>{'score': 0.5296498537063599,
 'start': 1319,
 'end': 1335,
 'answer': 'Monday at midday'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>qa(question<span class="op">=</span><span class="st">"How many StoryWall tasks are there?"</span>, context<span class="op">=</span>context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>{'score': 0.2139086276292801, 'start': 1155, 'end': 1158, 'answer': '30%'}</code></pre>
</div>
</div>
</section>
<section id="recommended-reading" class="slide level2 smaller">
<h2>Recommended reading</h2>
<ul>
<li>The Verge (2022), <a href="https://www.theverge.com/c/23194235/ai-fiction-writing-amazon-kindle-sudowrite-jasper">The Great Fiction of AI: The strange world of high-speed semi-automated genre fiction</a></li>
<li>Vaswani et al.&nbsp;(2017), <a href="https://arxiv.org/pdf/1706.03762.pdf">Attention Is All You Need</a>, NeurIPS</li>
<li>Bommasani et al.&nbsp;(2021), <a href="https://arxiv.org/pdf/2108.07258.pdf">On the Opportunities and Risks of Foundation Models</a></li>
<li>Gary Marcus (2022), <a href="https://nautil.us/deep-learning-is-hitting-a-wall-14467/">Deep Learning Is Hitting a Wall</a>, Nautilus article</li>
<li>SDS 564, <a href="https://podcasts.apple.com/au/podcast/super-data-science/id1163599059?i=1000556643700">Clem Delangue on Hugging Face and Transformers</a></li>
<li>SDS 559, <a href="https://podcasts.apple.com/au/podcast/super-data-science/id1163599059?i=1000554847681">GPT-3 for Natural Language Processing</a></li>
<li>Computerphile (2019), <a href="https://youtu.be/rURRYI66E54">AI Language Models &amp; Transformers</a> (20m)</li>
<li>Computerphile (2020), <a href="https://youtu.be/_8yVOC4ciXc">GPT3: An Even Bigger Language Model</a> (25m)</li>
<li>Nicholas Renotte (2021), <a href="https://youtu.be/JctmnczWg0U">AI Blog Post Summarization with Hugging Face Transformers…</a> (33m)</li>
<li>Seattle Applied Deep Learning (2019), <a href="https://youtu.be/S27pHKBEp30">LSTM is dead. Long Live Transformers!</a> (28m)</li>
</ul>
</section></section>
<section>
<section id="revision" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Revision</h1>

</section>
<section id="lecture-1-ai" class="slide level2">
<h2>Lecture 1: AI</h2>
<div class="columns">
<div class="column">
<ul>
<li>artificial intelligence</li>
<li><del>Deep Blue</del></li>
<li>default arguments</li>
<li>dictionaries</li>
<li>f-strings</li>
<li>function definitions</li>
<li><del>Google Colaboratory</del></li>
<li><del><code>help</code></del></li>
<li>list</li>
</ul>
</div><div class="column">
<ul>
<li><del>minimax algorithm</del></li>
<li><del><code>pip install ...</code></del></li>
<li><strong>pseudocode</strong></li>
<li><code>range</code></li>
<li>slicing</li>
<li>tuple</li>
<li><del><code>type</code></del></li>
<li>whitespace indentation</li>
<li>zero-indexing</li>
</ul>
</div>
</div>
</section>
<section id="lecture-2-deep-learning" class="slide level2 smaller">
<h2>Lecture 2: Deep Learning</h2>
<div class="columns">
<div class="column">
<ul>
<li><strong>activations, activation function</strong></li>
<li>artificial intelligence vs machine learning</li>
<li>artificial neural network</li>
<li>biases (in neurons)</li>
<li>classification problem</li>
<li><strong>cost/loss function</strong></li>
<li>deep network, network depth</li>
<li>dense or fully-connected layer</li>
<li>epoch</li>
<li>feed-forward neural network</li>
<li><del>Keras, Tensorflow, PyTorch</del></li>
</ul>
</div><div class="column">
<ul>
<li>labelled/unlabelled data</li>
<li>machine learning</li>
<li><del>matplotlib, seaborn</del></li>
<li><strong>neural network architecture</strong></li>
<li>perceptron</li>
<li>ReLU</li>
<li>representation learning</li>
<li>sigmoid activation function</li>
<li>targets</li>
<li><del>training/test split</del></li>
<li>universal approximation theorem</li>
<li>weights (in a neuron)</li>
</ul>
</div>
</div>
</section>
<section id="lecture-3-math-of-deep-learning" class="slide level2">
<h2>Lecture 3: Math of Deep Learning</h2>
<div class="columns">
<div class="column">
<ul>
<li>accuracy</li>
<li>batches, batch size</li>
<li>callbacks</li>
<li>cross-entropy loss</li>
<li><strong>early stopping</strong></li>
<li>gradient-based learning, hill-climbing</li>
</ul>
</div><div class="column">
<ul>
<li>metrics</li>
<li><strong>overfitting</strong></li>
<li>shallow neural network</li>
<li>stochastic (mini-batch) gradient descent</li>
<li><strong>training/validation/test split</strong></li>
</ul>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>See this set of slides for an example of <a href="https://pat-laub.github.io/DeepLearningMaterials/Lecture-5-Recurrent-Neural-Networks-And-Time-Series/rnns-and-time-series.html#/dense-layers-in-matrices">calculating the output of a dense layer</a>.</p>
</div>
</div>
</div>
</section>
<section id="lecture-4-tabular-data" class="slide level2">
<h2>Lecture 4: Tabular Data</h2>
<div class="columns">
<div class="column">
<ul>
<li>confusion matrix</li>
<li>dead ReLU neurons</li>
<li>dropout</li>
<li>ensemble model</li>
<li><strong>entity embeddings</strong></li>
<li>Input layer</li>
<li>Keras eager execution</li>
<li>Keras functional API</li>
</ul>
</div><div class="column">
<ul>
<li><span class="math inline">\(\ell_1\)</span> &amp; <span class="math inline">\(\ell_2\)</span> regularisation</li>
<li>leaky ReLU</li>
<li>Monte Carlo dropout</li>
<li>regularisation</li>
<li>Reshape layer</li>
<li>skip connection</li>
<li>wide &amp; deep network structure</li>
</ul>
</div>
</div>
</section>
<section id="lecture-5-rnns" class="slide level2">
<h2>Lecture 5: RNNs</h2>
<ul>
<li>dimensions (tensor)</li>
<li>GRU</li>
<li>LSTM</li>
<li>rank (tensor)</li>
<li>recurrent neural networks</li>
<li>SimpleRNN</li>
</ul>
</section>
<section id="lecture-6-cnns" class="slide level2">
<h2>Lecture 6: CNNs</h2>
<div class="columns">
<div class="column">
<ul>
<li>channels</li>
<li>computer vision</li>
<li>convolutional layer &amp; CNN</li>
<li>error analysis</li>
<li>filter</li>
</ul>
</div><div class="column">
<ul>
<li>flatten layer</li>
<li>kernel</li>
<li>max pooling</li>
<li>MNIST</li>
<li>stride</li>
</ul>
</div>
</div>
</section>
<section id="lecture-7-nlp" class="slide level2">
<h2>Lecture 7: NLP</h2>
<div class="columns">
<div class="column">
<ul>
<li><del>AlexNet</del></li>
<li>bag of words</li>
<li><del>CIFAR-10 / CIFAR-100</del></li>
<li><del>GoogLeNet &amp; Inception</del></li>
<li>ImageNet</li>
</ul>
</div><div class="column">
<ul>
<li>fine-tuning</li>
<li>lemmatization</li>
<li>one-hot embedding</li>
<li><strong>transfer learning</strong></li>
<li>vocabulary</li>
</ul>
</div>
</div>
</section>
<section id="lecture-8-generative-networks" class="slide level2">
<h2>Lecture 8: Generative Networks</h2>
<div class="columns">
<div class="column">
<ul>
<li>autoencoder</li>
<li>bias</li>
<li><del>DeepDream</del></li>
<li>greedy sampling</li>
<li><del>GloVe</del></li>
<li><del>Grad-CAM</del></li>
<li>language model</li>
</ul>
</div><div class="column">
<ul>
<li>latent space</li>
<li><del>neural style transfer</del></li>
<li><del>softmax temperature</del></li>
<li>stochastic sampling</li>
<li><strong>word embeddings/vectors</strong></li>
<li>word2vec</li>
</ul>
</div>
</div>
</section>
<section id="lecture-9" class="slide level2">
<h2>Lecture 9</h2>
<ul>
<li><strong>Dissecting <code>model.fit</code></strong></li>
<li><del>Object oriented programming &amp; PyTorch</del></li>
<li>Generative adversarial networks</li>
</ul>
</section>
<section id="storywalls" class="slide level2 smaller">
<h2>StoryWalls</h2>
<ol type="1">
<li>Chess AI: Basic Python</li>
<li>French motor #1: Basic feed-forward networks</li>
<li>Stroke prediction: Classification network, preprocessing (one-hot encoding)</li>
<li><strong>French motor #2</strong>: Entity embeddings</li>
<li><strong>Stock price prediction</strong>: Recurrent neural networks</li>
<li><a href="https://colab.research.google.com/drive/1WX3UQ9pLfHYiUXZ8o5DcAOQj6-AGdo5M?usp=sharing"><strong>Hurricane damage</strong></a>: Convolutional neural networks and hyperparameter tuning</li>
<li><strong>Police reports</strong>: NLP with bag-of-words, TF-IDF.</li>
<li>Generative networks experimenting</li>
<li>Reflection</li>
</ol>
<script defer="">
    // Remove the highlight.js class for the 'compile', 'min', 'max'
    // as there's a bug where they are treated like the Python built-in
    // global functions but we only ever see it as methods like
    // 'model.compile()' or 'predictions.max()'
    buggyBuiltIns = ["abs", "compile", "eval", "min", "max", "round", "sum"];

    document.querySelectorAll('.bu').forEach((elem) => {
        if (buggyBuiltIns.includes(elem.innerHTML)) {
            elem.classList.remove('bu');
        }
    })

    var registerRevealCallbacks = function() {
        Reveal.on('overviewshown', event => {
            document.querySelector(".line.right").hidden = true;
        });
        Reveal.on('overviewhidden', event => {
            document.querySelector(".line.right").hidden = false;
        });
    };
</script>

<img src="unsw-logo.svg" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Slides: <a href="https://pat-laub.github.io">Dr Patrick Laub</a> (<span class="citation" data-cites="PatrickLaub">@PatrickLaub</span>).</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="advanced-topics_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="advanced-topics_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="advanced-topics_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="advanced-topics_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":6,"grid":false,"background":["rgba(255,255,255,0.0)","https://github.com/rajgoel/reveal.js-plugins/raw/master/chalkboard/img/blackboard.png"]},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.2,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script>registerRevealCallbacks();</script>
    

</body></html>