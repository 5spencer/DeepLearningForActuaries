<!DOCTYPE html>
<html lang="en"><head>
<script src="natural-language-processing_files/libs/clipboard/clipboard.min.js"></script>
<script src="natural-language-processing_files/libs/quarto-html/tabby.min.js"></script>
<script src="natural-language-processing_files/libs/quarto-html/popper.min.js"></script>
<script src="natural-language-processing_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="natural-language-processing_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="natural-language-processing_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="natural-language-processing_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.1.251">

  <meta name="author" content="Dr Patrick Laub">
  <title>Natural Language Processing</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="natural-language-processing_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="natural-language-processing_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="natural-language-processing_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="natural-language-processing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="natural-language-processing_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="natural-language-processing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="natural-language-processing_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="natural-language-processing_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="natural-language-processing_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
<div class="line right"></div>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="unsw-yellow-shape.png" data-background-size="contain !important" class="center">
  <h1 class="title">Natural Language Processing</h1>
  <p class="subtitle">ACTL3143/5111: Deep Learning for Actuaries</p>
  <p class="author">Dr Patrick Laub</p>
  <p class="date">Week 8</p>
</section>

<section id="lecture-outline" class="slide level2">
<h2>Lecture Outline</h2>
<div class="columns">
<div class="column">
<ul>
<li>Project draft feedback &amp; report/figure style</li>
<li>Temperature forecasting with RNNs &amp; CNNs</li>
<li>Transfer learning &amp; convolutional neural networks</li>
<li>Natural language processing</li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="poorly-drawn-lines-plan.jpg"></p>
<p></p><figcaption>All the projects are progressing well.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Thanks Hang Nguyen &amp; Michael Jacinto for draft slides.</p>
</section>
<section id="load-packages" class="slide level2" data-visibility="uncounted">
<h2>Load packages</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy.random <span class="im">as</span> rnd</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">from</span> tensorflow.keras.metrics <span class="im">import</span> SparseTopKCategoricalAccuracy</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="op">%</span>load_ext watermark</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="op">%</span>watermark <span class="op">-</span>p matplotlib,numpy,pandas,tensorflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>matplotlib: 3.5.2
numpy     : 1.21.5
pandas    : 1.4.4
tensorflow: 2.8.0
</code></pre>
</div>
</div>
</section>
<section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>
<h2>
CNN Story Wall
</h2>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>Inspect the inputs first</li>
<li>Use the GPU for convolutional models</li>
<li>Binary classification <span class="math inline">\(\Rightarrow\)</span> sigmoid &amp; BinaryCrossentropy.</li>
<li>Change from “adam” to “sgd” (or “rmsprop”)</li>
<li>Keras recommends <code>from_logits=True</code></li>
</ul>
</div><div class="column" style="width:30%;">
<p><img src="cyclone-undamaged-32605.jpeg" data-lazy-loaded="" style="height: 255px; padding: 0px"> <img src="cyclone-damaged-5493.jpeg" data-lazy-loaded="" style="height: 255px; padding: 0px"></p>
</div>
</div>
<div class="footer">
<p>Source: Cao &amp; Choe (2018), <a href="https://arxiv.org/pdf/1807.01688.pdf">Building Damage Annotation on Post-Hurricane Satellite Imagery Based on Convolutional Neural Networks</a>, arXiv:1807.01688 [<a href="https://github.com/qcao10/DamageDetection"><strong>code</strong></a>].</p>
</div>
<p><br><br><br><br></p>
</section>
<section id="project-draft-comments" class="slide level2">
<h2>Project draft comments</h2>
<div class="columns">
<div class="column">
<ul>
<li>A pass is a pass is a pass</li>
<li>Model comparison on the <em>validation set</em></li>
<li>How different are different networks? See Wide &amp; deep with embeddings <span class="math inline">\(\rightarrow\)</span></li>
<li>Disable regularisation in scikit-learn’s logistic regression</li>
</ul>
</div><div class="column">
<p><img data-src="wide-and-deep-with-embeddings.png"></p>
</div>
</div>
</section>
<section id="basic-ml-workflow" class="slide level2">
<h2>Basic ML workflow</h2>

<img data-src="wiki-ML_dataset_training_validation_test_sets.png" class="r-stretch quarto-figure-center"><p class="caption">Splitting the data.</p><ol type="1">
<li>For each model, fit it to the <em>training set</em>.</li>
<li>Compute the error for each model on the <em>validation set</em>.</li>
<li>Select the model with the lowest validation error.</li>
<li>Compute the error of the final model on the <em>test set</em>.</li>
</ol>
<div class="footer">
<p>Source: <a href="https://commons.wikimedia.org/wiki/File:ML_dataset_training_validation_test_sets.png#filelinks">Wikipedia</a>.</p>
</div>
</section>
<section id="slightly-more-advanced-workflow" class="slide level2">
<h2>Slightly more advanced workflow</h2>
<ol type="1">
<li>For each model, fit it to the <em>training set</em>.</li>
<li>Compute the error for each model on the <em>validation set</em>.</li>
<li>Select the model with the lowest validation error.</li>
<li>Fit the selected architecture to the combined <em>training &amp; validation sets</em>.</li>
<li>Compute the error of the final fitted model on the <em>test set</em>.</li>
</ol>
</section></section>
<section>
<section id="figures" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Figures</h1>

</section>
<section id="figures-in-reports" class="slide level2">
<h2>Figures in reports</h2>
<ul>
<li>Figures are numbered and captioned. Subfigures are enumerated by letters.</li>
<li>Figures are not pixelated.</li>
<li>Each figure has readable text.</li>
<li>Each figure has a point.</li>
<li>All figures are referred to in the text (preferably on the same page or nearby).</li>
</ul>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<p><img class="quarto-figure-center" src="cusum-figure1.png" style="max-height: 85%;max-width: 85%;" data-lazy-loaded=""></p>
<div class="footer">
<p>Source: Laub et al.&nbsp;(2020), <a href="https://arxiv.org/pdf/2006.04576.pdf">Quickest detection in practice in presence of seasonality: An illustration with call center data</a>, Insurance Data Analytics.</p>
</div>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<p><img class="quarto-figure-center" src="cusum-figure2.png" style="max-height: 95%;max-width: 90%;" data-lazy-loaded=""></p>
<div class="footer">
<p>Source: Laub et al.&nbsp;(2020), <a href="https://arxiv.org/abs/2006.04576">Quickest detection in practice in presence of seasonality: An illustration with call center data</a>, Insurance Data Analytics [<a href="https://github.com/Pat-Laub/SeasonalCUSUM/blob/master/detection.ipynb"><strong>code</strong></a>].</p>
</div>
</section>
<section id="saving-directly-from-python" class="slide level2">
<h2>Saving directly from Python</h2>
<p>Note that <code>plt.show()</code> empties the current figure.</p>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb3-2"><a href="#cb3-2"></a>plt.savefig(<span class="st">"success.png"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="op">!</span>du <span class="op">-</span>h success.png</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 20K    success.png</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb6-2"><a href="#cb6-2"></a>plt.show()</span>
<span id="cb6-3"><a href="#cb6-3"></a>plt.savefig(<span class="st">"fail.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="op">!</span>du <span class="op">-</span>h fail.png</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4.0K    fail.png</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="point-process-example" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-1.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p></section>
<section id="point-process-example-1" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-2.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p><div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>plt.rcParams[<span class="st">"figure.dpi"</span>] <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>plt.rcParams[<span class="st">"font.size"</span>] <span class="op">=</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="point-process-example-2" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-3.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p></section>
<section id="point-process-example-3" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-4.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p><div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>plt.rcParams[<span class="st">'axes.spines.right'</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>plt.rcParams[<span class="st">'axes.spines.top'</span>] <span class="op">=</span> <span class="va">False</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="point-process-example-4" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-5.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p><div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="point-process-example-5" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-6.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p><div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, tight_layout<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="point-process-example-6" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-7.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p><div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, tight_layout<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="point-process-example-7" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-8.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p><div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Play with the aspect ratio! Try wide figures.</p>
</div>
</div>
</div>
</section>
<section id="an-aside-on-colours" class="slide level2">
<h2>An aside on colours</h2>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="bu">print</span>(plt.rcParams[<span class="st">"axes.prop_cycle"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cycler('color', ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf'])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># This is the default colour scheme.</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>colours <span class="op">=</span> [</span>
<span id="cb16-3"><a href="#cb16-3"></a>    <span class="st">"tab:blue"</span>, <span class="st">"tab:orange"</span>, <span class="st">"tab:green"</span>, <span class="st">"tab:red"</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="st">"tab:purple"</span>, <span class="st">"tab:brown"</span>, <span class="st">"tab:pink"</span>,<span class="st">"tab:gray"</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="st">"tab:olive"</span>, <span class="st">"tab:cyan"</span>,</span>
<span id="cb16-6"><a href="#cb16-6"></a>]</span>
<span id="cb16-7"><a href="#cb16-7"></a>colours.remove(<span class="st">"tab:orange"</span>)</span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co"># Set the default color scheme so that this orange is skipped.</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="im">import</span> cycler</span>
<span id="cb16-11"><a href="#cb16-11"></a>plt.rcParams[<span class="st">"axes.prop_cycle"</span>] <span class="op">=</span> cycler.cycler(color<span class="op">=</span>colours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Don’t accept default colours, fonts, styles.</p>
</div>
</div>
</div>
</section>
<section id="point-process-example-8" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-9.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p><div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>fig.text(<span class="fl">0.095</span>, <span class="fl">0.95</span>, <span class="st">"$</span><span class="ch">\\</span><span class="st">lambda_t$"</span>, <span class="op">**</span>targs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="point-process-example-9" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-10.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p></section>
<section id="point-process-example-10" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-11.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p></section>
<section id="point-process-example-11" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-12.png" class="r-stretch quarto-figure-center"><p class="caption">A point process.</p></section>
<section id="point-process-example-12" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-13.png" class="r-stretch quarto-figure-center"><p class="caption">Figure 1: An example realization of an extrinsic stress-release process, with <span class="math inline">\(\lambda_0 = 1\)</span>, <span class="math inline">\(\beta = 1.5\)</span>, <span class="math inline">\(\rho = 2\)</span>, and <span class="math inline">\(X_i \sim \mathsf{Exp}(1)\)</span> and <span class="math inline">\(Y_j \sim \mathsf{Exp}(2)\)</span>. Note that <span class="math inline">\(N\)</span> is càdlàg while <span class="math inline">\(\lambda\)</span> is càglàd.</p></section>
<section id="point-process-example-13" class="slide level2">
<h2>Point process example</h2>

<img data-src="example-plot-14.png" class="r-stretch quarto-figure-center"><p class="caption">Figure 1: An example realization of an extrinsic stress-release process, with <span class="math inline">\(\lambda_0 = 1\)</span>, <span class="math inline">\(\beta = 1.5\)</span>, <span class="math inline">\(\rho = 2\)</span>, and <span class="math inline">\(X_i \sim \mathsf{Exp}(1)\)</span> and <span class="math inline">\(Y_j \sim \mathsf{Exp}(2)\)</span>. Note that <span class="math inline">\(N\)</span> is càdlàg while <span class="math inline">\(\lambda\)</span> is càglàd.</p><div class="footer">
<p>Source: Lee et al.&nbsp;(2022), <a href="https://arxiv.org/pdf/2106.14415.pdf">Exact simulation of extrinsic stress-release processes</a>, Journal of Applied Probability [<a href="https://github.com/Pat-Laub/exact-simulation-of-extrinsic-stress-release-processes"><strong>code</strong></a>].</p>
</div>
</section>
<section id="image-file-types" class="slide level2">
<h2>Image file types</h2>
<p>Raster formats (need to set DPI):</p>
<ul>
<li>PNG (normally used for diagrams)</li>
<li>JPEG (normally used for photographs)</li>
</ul>
<p>Vector formats:</p>
<ul>
<li>PDF (with Word)</li>
<li>PGF (with <span class="math inline">\(\LaTeX\)</span>)</li>
<li>SVG (for the web)</li>
</ul>
</section>
<section id="pgf-and-tikz" class="slide level2">
<h2>PGF and TikZ</h2>

<img data-src="wiki-Neighbourhood_definition2.svg" class="r-stretch quarto-figure-center"><p class="caption">Example TikZ diagram</p><div class="footer">
<p>Source: Wikipedia, <a href="https://commons.wikimedia.org/wiki/File:Neighbourhood_definition2.svg">PGF/TikZ page</a>.</p>
</div>
</section>
<section id="pgf-file" class="slide level2">
<h2>PGF file</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">\begin</span>{<span class="ex">tikzpicture</span>}[scale=.8,every node/.style={minimum size=1cm},on grid]</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">%</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>   <span class="kw">\begin</span>{<span class="ex">scope</span>}[</span>
<span id="cb18-4"><a href="#cb18-4"></a>           yshift=-83,every node/.append style={</span>
<span id="cb18-5"><a href="#cb18-5"></a>           yslant=0.5,xslant=-1},yslant=0.5,xslant=-1</span>
<span id="cb18-6"><a href="#cb18-6"></a>           ]</span>
<span id="cb18-7"><a href="#cb18-7"></a>       <span class="fu">\draw</span>[step=4mm, black] (0,0) grid (5,5); </span>
<span id="cb18-8"><a href="#cb18-8"></a>       <span class="fu">\draw</span>[black,thick] (0,0) rectangle (5,5);<span class="co">%borders</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>       <span class="fu">\fill</span>[greenMW] (2.05,2.05) rectangle (2.35,2.35); <span class="co">% center pixel</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>       <span class="fu">\fill</span>[greenMW] (1.65,2.05) rectangle (1.95,2.35); <span class="co">%left</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>       <span class="fu">\fill</span>[greenMW] (2.45,2.05) rectangle (2.75,2.35); <span class="co">%right</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>       <span class="fu">\fill</span>[greenMW] (2.05,2.45) rectangle (2.35,2.75); <span class="co">%top</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>       <span class="fu">\fill</span>[greenMW] (2.05,1.95) rectangle (2.35,1.65); <span class="co">%bottom</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">% 8 -pixel setting</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>       <span class="fu">\fill</span>[greenMW] (1.65,2.45) rectangle (1.95,2.75); <span class="co">%top-left</span></span>
<span id="cb18-16"><a href="#cb18-16"></a>       <span class="fu">\fill</span>[greenMW] (2.45,2.45) rectangle (2.75,2.75); <span class="co">%top-right</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>       <span class="fu">\fill</span>[greenMW] (2.75,1.95) rectangle (2.45,1.65); <span class="co">%bottom-right</span></span>
<span id="cb18-18"><a href="#cb18-18"></a>       <span class="fu">\fill</span>[greenMW] (1.65,1.95) rectangle (1.95,1.65); <span class="co">%bottom-left</span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co">% 2. ring</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>       <span class="fu">\fill</span>[greenMW] (1.25,1.55) rectangle (1.55,1.25); <span class="co">%bottom-left</span></span>
<span id="cb18-21"><a href="#cb18-21"></a>       <span class="fu">\fill</span>[greenMW] (0.85,1.55) rectangle (1.15,1.25); <span class="co">%bottom-left</span></span>
<span id="cb18-22"><a href="#cb18-22"></a>       <span class="fu">\fill</span>[greenMW] (0.85,1.15) rectangle (1.15,0.85); <span class="co">%bottom-left</span></span>
<span id="cb18-23"><a href="#cb18-23"></a>       <span class="fu">\fill</span>[greenMW] (1.25,0.75) rectangle (1.55,0.45); <span class="co">%bottom-left</span></span>
<span id="cb18-24"><a href="#cb18-24"></a>   <span class="kw">\end</span>{<span class="ex">scope</span>}</span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="co">%</span></span>
<span id="cb18-26"><a href="#cb18-26"></a>   <span class="kw">\begin</span>{<span class="ex">scope</span>}[</span>
<span id="cb18-27"><a href="#cb18-27"></a>           yshift=0,every node/.append style={</span>
<span id="cb18-28"><a href="#cb18-28"></a>           yslant=0.5,xslant=-1},yslant=0.5,xslant=-1</span>
<span id="cb18-29"><a href="#cb18-29"></a>           ]</span>
<span id="cb18-30"><a href="#cb18-30"></a>       <span class="fu">\fill</span>[white,fill opacity=0.9] (0,0) rectangle (5,5);</span>
<span id="cb18-31"><a href="#cb18-31"></a>       <span class="fu">\draw</span>[step=4mm, black] (0,0) grid (5,5); <span class="co">%grid definition</span></span>
<span id="cb18-32"><a href="#cb18-32"></a>       <span class="fu">\draw</span>[black,thick] (0,0) rectangle (5,5);<span class="co">%borders</span></span>
<span id="cb18-33"><a href="#cb18-33"></a>       <span class="fu">\fill</span>[greenMW] (2.05,2.05) rectangle (2.35,2.35); <span class="co">% center pixel</span></span>
<span id="cb18-34"><a href="#cb18-34"></a>       <span class="fu">\fill</span>[greenMW] (1.65,2.05) rectangle (1.95,2.35); <span class="co">%left</span></span>
<span id="cb18-35"><a href="#cb18-35"></a>       <span class="fu">\fill</span>[greenMW] (2.45,2.05) rectangle (2.75,2.35); <span class="co">% right</span></span>
<span id="cb18-36"><a href="#cb18-36"></a>       <span class="fu">\fill</span>[greenMW] (2.05,2.45) rectangle (2.35,2.75); <span class="co">% top</span></span>
<span id="cb18-37"><a href="#cb18-37"></a>       <span class="fu">\fill</span>[greenMW] (2.05,1.95) rectangle (2.35,1.65); <span class="co">% bottom</span></span>
<span id="cb18-38"><a href="#cb18-38"></a><span class="co">% 4 -pixel setting</span></span>
<span id="cb18-39"><a href="#cb18-39"></a>       <span class="fu">\fill</span>[greenMW] (1.65,2.45) rectangle (1.95,2.75); <span class="co">%top-left</span></span>
<span id="cb18-40"><a href="#cb18-40"></a>       <span class="fu">\fill</span>[greenMW] (2.45,2.45) rectangle (2.75,2.75); <span class="co">%top-right</span></span>
<span id="cb18-41"><a href="#cb18-41"></a>       <span class="fu">\fill</span>[greenMW] (2.75,1.95) rectangle (2.45,1.65); <span class="co">%bottom-right</span></span>
<span id="cb18-42"><a href="#cb18-42"></a>       <span class="fu">\fill</span>[greenMW] (1.65,1.95) rectangle (1.95,1.65); <span class="co">%bottom-left</span></span>
<span id="cb18-43"><a href="#cb18-43"></a><span class="co">% 2. ring</span></span>
<span id="cb18-44"><a href="#cb18-44"></a>       <span class="fu">\fill</span>[orange] (1.25,1.55) rectangle (1.55,1.25); </span>
<span id="cb18-45"><a href="#cb18-45"></a>       <span class="fu">\fill</span>[orange] (0.85,1.55) rectangle (1.15,1.25); </span>
<span id="cb18-46"><a href="#cb18-46"></a>       <span class="fu">\fill</span>[orange] (0.85,1.15) rectangle (1.15,0.85); </span>
<span id="cb18-47"><a href="#cb18-47"></a>       <span class="fu">\fill</span>[blue] (1.25,0.75) rectangle (1.55,0.45); </span>
<span id="cb18-48"><a href="#cb18-48"></a>   <span class="kw">\end</span>{<span class="ex">scope</span>}</span>
<span id="cb18-49"><a href="#cb18-49"></a><span class="co">%</span></span>
<span id="cb18-50"><a href="#cb18-50"></a><span class="co">% draw annotations</span></span>
<span id="cb18-51"><a href="#cb18-51"></a><span class="co">%</span></span>
<span id="cb18-52"><a href="#cb18-52"></a>   <span class="fu">\draw</span>[-latex,thick,orange](-3,5)node[left]{ }</span>
<span id="cb18-53"><a href="#cb18-53"></a>       to[out=0,in=90] (-.4,1.4);</span>
<span id="cb18-54"><a href="#cb18-54"></a>   <span class="fu">\draw</span>[-latex,thick,blue](-3,5)node[left]{ }</span>
<span id="cb18-55"><a href="#cb18-55"></a>       to[out=0,in=90] (0.8,1.15);</span>
<span id="cb18-56"><a href="#cb18-56"></a>   <span class="fu">\draw</span>[-latex,thick,greenMW](-3,5)node[left]{3 patches}</span>
<span id="cb18-57"><a href="#cb18-57"></a>       to[out=0,in=90] (0,2.8);</span>
<span id="cb18-58"><a href="#cb18-58"></a><span class="co">%</span></span>
<span id="cb18-59"><a href="#cb18-59"></a>   <span class="fu">\draw</span>[-latex,thick,greenMW](-3,-2)node[left]{1 patch}</span>
<span id="cb18-60"><a href="#cb18-60"></a>       to[out=0,in=200] (-1,-.9);</span>
<span id="cb18-61"><a href="#cb18-61"></a>   <span class="fu">\draw</span>[thick,gray!70!black](6,4) node {4 neighbourhood rule};</span>
<span id="cb18-62"><a href="#cb18-62"></a>   <span class="fu">\draw</span>[thick,gray!70!black](6,-2) node {8 neighbourhood rule};</span>
<span id="cb18-63"><a href="#cb18-63"></a><span class="co">%</span></span>
<span id="cb18-64"><a href="#cb18-64"></a><span class="kw">\end</span>{<span class="ex">tikzpicture</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section>
<section id="writing-typography" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Writing &amp; typography</h1>

</section>
<section id="math-typography" class="slide level2">
<h2>Math typography</h2>
<p><br></p>
<p><em>Please</em> make sure to use maths &amp; text modes appropriately.</p>

<img data-src="tex-math-text.png" class="r-stretch quarto-figure-center"><p class="caption">Words aren’t italicised inside equations.</p><div class="sourceCode" id="cb19"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb19-1"><a href="#cb19-1"></a><span class="ss">\[ Area of Circle = </span><span class="sc">\pi</span><span class="ss"> * Radius^2 \]</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="ss">\[ </span><span class="sc">\text</span>{Area of Circle}<span class="ss"> = </span><span class="sc">\pi</span><span class="ss"> </span><span class="sc">\cdot</span><span class="ss"> </span><span class="sc">\text</span>{Radius}<span class="ss">^2 \]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="math-typography-ii" class="slide level2">
<h2>Math typography II</h2>
<p><br><br></p>

<img data-src="tex-math-mode-inline.png" class="r-stretch quarto-figure-center"><p class="caption">Take care with maths and text fonts while inline.</p><div class="sourceCode" id="cb20"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb20-1"><a href="#cb20-1"></a>Here x and y are elements of <span class="ss">$X_{train}$</span> and <span class="ss">$y_{train}$</span>.</span>
<span id="cb20-2"><a href="#cb20-2"></a>Here <span class="ss">$x$</span> and <span class="ss">$y$</span> are elements of <span class="ss">$X_{</span><span class="sc">\text</span>{Train}<span class="ss">}$</span> and <span class="ss">$y_{</span><span class="sc">\text</span>{Train}<span class="ss">}$</span>.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="math-typography-iii" class="slide level2">
<h2>Math typography III</h2>
<p>There are other cases when individual letters need to be in upright/roman font.</p>

<img data-src="tex-math-roman.png" class="r-stretch quarto-figure-center"><p class="caption">When two italicised letters are beside each other, that means they are multipled.</p><div class="sourceCode" id="cb21"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb21-1"><a href="#cb21-1"></a><span class="ss">\[ </span><span class="sc">\int</span><span class="ss"> e^x dx , </span><span class="sc">\,</span><span class="ss"> </span><span class="sc">\int</span><span class="ss"> </span><span class="sc">\mathrm</span><span class="ss">{e}^x </span><span class="sc">\,</span><span class="ss"> </span><span class="sc">\mathrm</span><span class="ss">{d}x \]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="text-in-latex" class="slide level2">
<h2>Text in <span class="math inline">\(\LaTeX\)</span></h2>
<p><br><br></p>

<img data-src="tex-apostrophes.png" class="r-stretch quarto-figure-center"><p class="caption">Make sure to match left &amp; right apostrophes/quotes.</p><div class="sourceCode" id="cb22"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb22-1"><a href="#cb22-1"></a>Some text in 'apostrophes' and in "quotation marks." </span>
<span id="cb22-2"><a href="#cb22-2"></a>Some text in `apostrophes' and in ``quotation marks.''</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="text-in-latex-ii" class="slide level2">
<h2>Text in <span class="math inline">\(\LaTeX\)</span> II</h2>
<p><br><br></p>

<img data-src="tex-escape-space.png" class="r-stretch quarto-figure-center"><p class="caption">Escape spaces after period which aren’t the end of sentence.</p><div class="sourceCode" id="cb23"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb23-1"><a href="#cb23-1"></a>There are many encodings, e.g. one-hot encoding, entity embeddings, etc.</span>
<span id="cb23-2"><a href="#cb23-2"></a>There are many encodings, e.g.<span class="fu">\ </span>one-hot encoding, entity embeddings, etc.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="text-in-latex-iii" class="slide level2">
<h2>Text in <span class="math inline">\(\LaTeX\)</span> III</h2>
<p><br><br></p>

<img data-src="tex-dashes.png" class="r-stretch quarto-figure-center"><p class="caption">Use hyphens, en-dashes &amp; em-dashes correctly.</p><div class="sourceCode" id="cb24"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb24-1"><a href="#cb24-1"></a>It is a five-step procedure to fit the Lee-Carter model - depending on how you count - so <span class="fu">\dots</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>It is a five-step procedure to fit the Lee--Carter model --- depending on how you count --- so <span class="fu">\dots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="use-lots-of-fonts" class="slide level2">
<h2>Use lots of fonts</h2>
<p><br><br></p>

<img data-src="tex-teletype-font.png" class="r-stretch quarto-figure-center"><p class="caption">Use a serif/teletype font for the columns in a dataset.</p><div class="sourceCode" id="cb25"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb25-1"><a href="#cb25-1"></a>Looking at the <span class="fu">\emph</span>{NumAccidents} column<span class="fu">\dots</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>Looking at the <span class="fu">\texttt</span>{NumAccidents} column<span class="fu">\dots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="using-kpfonts-package" class="slide level2">
<h2>Using <code>kpfonts</code> package</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tex-computer-modern.png"></p>
<p></p><figcaption>Default computer modern font.</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="tex-kpfonts.png"></p>
<p></p><figcaption>After <code>\usepackage{kpfonts}</code>.</figcaption><p></p>
</figure>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource latex number-lines code-with-copy"><code class="sourceCode latex"><span id="cb26-1"><a href="#cb26-1"></a>For each <span class="ss">$x$</span> in the set <span class="ss">$</span><span class="sc">\mathcal</span><span class="ss">{X}$</span>, where  <span class="ss">$X </span><span class="sc">\sim</span><span class="ss"> </span><span class="sc">\mathsf</span><span class="ss">{Poisson}(</span><span class="sc">\mu</span><span class="ss">)$</span> we calculate </span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="ss">\[ </span><span class="sc">\mathbb</span><span class="ss">{P}(X </span><span class="sc">\le</span><span class="ss"> x) = </span><span class="sc">\mathscr</span><span class="ss">{L}^{-1}</span><span class="sc">\{</span><span class="ss"> f_X </span><span class="sc">\}</span><span class="ss">(x) / x . \]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="footer">
<p>See Laub et al.&nbsp;(2020), <a href="https://arxiv.org/pdf/2006.04576.pdf">Quickest detection in practice in presence of seasonality: An illustration with call center data</a>, Insurance Data Analytics.</p>
</div>
</section></section>
<section>
<section id="rnns-cnns-for-time-series" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>RNNs &amp; CNNs For Time Series</h1>

</section>
<section id="the-temperature-in-jena-germany" class="slide level2">
<h2>The temperature in Jena, Germany</h2>
<p>Temperature recorded every 10 minutes over 2009-2016 (8 years), which gives 420,551 data points.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chollet-temperatureall-blur.png"></p>
<p></p><figcaption>All temperature data, yearly periodicity is observed.</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chollet-temperature10days-blur.png"></p>
<p></p><figcaption>10-day data shows some daily periodicity.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div class="footer">
<p>Source: François Chollet (2021), <em>Deep Learning with Python</em>, Second Edition, Figures 10.1 &amp; 10.2 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="a-temperature-forecasting-example" class="slide level2">
<h2>A temperature-forecasting example</h2>
<p>Given a few months of data, predict the average temperature for the next month. This is an easy problem due to the reliable year-scale periodicity of the data.</p>
<p>Given hourly temperature data of the previous 5 days, predict the temperature in 24 hours. This is a harder problem because on a daily scale, data is more chaotic.</p>
</section>
<section id="the-baseline-model" class="slide level2">
<h2>The baseline model</h2>
<p>Build a model for 24-hour temperature forecast: Use a baseline model to evaluate the performance of the models that we build.</p>
<p>For our forecast model, the baseline model is to set the temperature 24 hours from now to be equal to the temperature right now. The validation error (mean absolute error) of this model is then 2.44 degrees Celsius, and the test error is 2.62 degrees.</p>
</section>
<section id="a-24-hour-forecast" class="slide level2">
<h2>A 24-hour forecast</h2>
<p>Neither the densely connected network or the 1D convnet work well. Their validation errors are higher than the baseline model.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chollet-feedforwardresult-blur.png"></p>
<p></p><figcaption>Using a densely connected network.</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chollet-convoresult-blur.png"></p>
<p></p><figcaption>Using a 1D convolutional network.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div class="footer">
<p>Source: François Chollet (2021), <em>Deep Learning with Python</em>, Second Edition, Figures 10.3 &amp; 10.4 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="why-the-dense-model-doesnt-work" class="slide level2">
<h2>Why the dense model doesn’t work</h2>
<p>For the 2-layer densely connected neural network, even though a good solution technically exists where the neural network finds the baseline solution and improves on it, finding such solution in the hypothesis space of all possible 2-layer neural network with the configuration we defined is sometimes like finding a needle in the haystack. Good feature engineering and relevant network architecture is important in that case: you need to tell the model precisely what it should be looking for.</p>
</section>
<section id="why-the-cnn-doesnt-work" class="slide level2">
<h2>Why the CNN doesn’t work</h2>
<p>Order of data in the sequence (such as a time series) matters a lot. For temperature forecast, recent data is more informative for predicting the next day’s temperature.</p>
<p>Convnet is unable to preserve order. In the pooling layer such as max pooling, the max value from a grid is retrieved while discarding information about the exact location of the max value in the grid. By losing positional information, the network fails to capture information about the spatial or temporal relation between the inputs.</p>
</section>
<section id="going-forward-backwards-in-time" class="slide level2">
<h2>Going forward &amp; backwards in time</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chollet-10-11-blur.png"></p>
<p></p><figcaption>Using a dropout-regularised LSTM.</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chollet-10-13-blur.png"></p>
<p></p><figcaption>Using an LSTM on reversed sequences.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div class="footer">
<p>Source: François Chollet (2021), <em>Deep Learning with Python</em>, Second Edition, Figures 10.11 &amp; 10.13 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="why-the-backwards-direction-fails" class="slide level2">
<h2>Why the backwards direction fails</h2>
<blockquote>
<p>The reversed-order LSTM strongly underperforms even the common-sense baseline, indicating that in this case, chronological processing is important to the success of the approach. This makes perfect sense: the underlying LSTM layer will typically be better at remembering the recent past than the distant past, and naturally the more recent weather data points are more predictive than older data points for the problem (that’s what makes the common-sense baseline fairly strong). Thus the chronological version of the layer is bound to outperform the reversed-order version.</p>
</blockquote>
<div class="footer">
<p>Source: François Chollet (2021), <em>Deep Learning with Python</em>, Second Edition, Chapter 10.</p>
</div>
</section>
<section id="bidirectional-rnn" class="slide level2">
<h2>Bidirectional RNN</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="chollet-10-14-blur.png"></p>
<p></p><figcaption>Illustration of a bidirectional RNN.</figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:60%;">
<p>Wrap a normal RNN layer inside the <code>Bidirectional</code> layer to get Keras to go forward &amp; backwards in time.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="op">\</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>    <span class="im">import</span> Bidirectional</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a>inputs <span class="op">=</span> Input(shape<span class="op">=</span>inpShape)</span>
<span id="cb27-5"><a href="#cb27-5"></a>x <span class="op">=</span> Bidirectional(LSTM(<span class="dv">16</span>))(inputs)</span>
<span id="cb27-6"><a href="#cb27-6"></a>outputs <span class="op">=</span> Dense(<span class="dv">1</span>)(x)</span>
<span id="cb27-7"><a href="#cb27-7"></a>model <span class="op">=</span> Model(inputs, outputs) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="footer">
<p>Source: François Chollet (2021), <em>Deep Learning with Python</em>, Second Edition, Chapter 10 (<strong>redacted</strong>).</p>
</div>
</section></section>
<section>
<section id="transfer-learning" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Transfer Learning</h1>

</section>
<section id="demo-object-classification" class="slide level2">
<h2>Demo: Object classification</h2>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="teach-images.png"></p>
<p></p><figcaption>Example object classification run.</figcaption><p></p>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://info.deeplearning.ai/hs-fs/hubfs/NOCODE.gif?width=1200&amp;upscale=true&amp;name=NOCODE.gif"></p>
<p></p><figcaption>Example of object classification.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Teachable Machine, <a href="https://teachablemachine.withgoogle.com/">https://teachablemachine.withgoogle.com/</a>.</p>
</div>
</section>
<section id="how-does-that-work" class="slide level2">
<h2>How does that work?</h2>
<blockquote>
<p>… these models use a technique called transfer learning. There’s a pretrained neural network, and when you create your own classes, you can sort of picture that your classes are becoming the last layer or step of the neural net. Specifically, both the image and pose models are learning off of pretrained mobilenet models …</p>
</blockquote>
<p><a href="https://teachablemachine.withgoogle.com/faq#Diving-Deeper">Teachable Machine FAQ</a></p>
</section>
<section id="benchmarks" class="slide level2">
<h2>Benchmarks</h2>
<p><a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-10 / CIFAR-100 dataset</a> from Canadian Institute for Advanced Research</p>
<ul>
<li>10 classes: 60000 32x32 colour images</li>
<li>100 classes: 60000 32x32 colour images</li>
</ul>
<p><a href="https://www.image-net.org/index.php">ImageNet</a> and the <em>ImageNet Large Scale Visual Recognition Challenge (ILSVRC)</em>; originally <a href="https://image-net.org/challenges/LSVRC/2014/browse-synsets">1,000 synsets</a>.</p>
<ul>
<li>In 2022: 14,197,122 labelled images from 21,841 synsets.</li>
<li>See <a href="https://keras.io/api/applications/">Keras applications</a> for downloadable models.</li>
</ul>
</section>
<section id="lenet-5-1998" class="slide level2 smaller">
<h2>LeNet-5 (1998)</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 9%">
<col style="width: 23%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel size</th>
<th>Stride</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>1</td>
<td>32×32</td>
<td>–</td>
<td>–</td>
<td>–</td>
</tr>
<tr class="even">
<td>C1</td>
<td>Convolution</td>
<td>6</td>
<td>28×28</td>
<td>5×5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S2</td>
<td>Avg pooling</td>
<td>6</td>
<td>14×14</td>
<td>2×2</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C3</td>
<td>Convolution</td>
<td>16</td>
<td>10×10</td>
<td>5×5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S4</td>
<td>Avg pooling</td>
<td>16</td>
<td>5×5</td>
<td>2×2</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C5</td>
<td>Convolution</td>
<td>120</td>
<td>1×1</td>
<td>5×5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>F6</td>
<td>Fully connected</td>
<td>–</td>
<td>84</td>
<td>–</td>
<td>–</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully connected</td>
<td>–</td>
<td>10</td>
<td>–</td>
<td>–</td>
<td>RBF</td>
</tr>
</tbody>
</table>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>MNIST images are 28×28 pixels, and with zero-padding (for a 5×5 kernel) that becomes 32×32.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Chapter 14.</p>
</div>
</section>
<section id="alexnet-2012" class="slide level2 smaller">
<h2>AlexNet (2012)</h2>
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel</th>
<th>Stride</th>
<th>Padding</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>3</td>
<td>227×227</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>–</td>
</tr>
<tr class="even">
<td>C1</td>
<td>Convolution</td>
<td>96</td>
<td>55×55</td>
<td>11×11</td>
<td>4</td>
<td>valid</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S2</td>
<td>Max pool</td>
<td>96</td>
<td>27×27</td>
<td>3×3</td>
<td>2</td>
<td>valid</td>
<td>–</td>
</tr>
<tr class="even">
<td>C3</td>
<td>Convolution</td>
<td>256</td>
<td>27×27</td>
<td>5×5</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S4</td>
<td>Max pool</td>
<td>256</td>
<td>13×13</td>
<td>3×3</td>
<td>2</td>
<td>valid</td>
<td>–</td>
</tr>
<tr class="even">
<td>C5</td>
<td>Convolution</td>
<td>384</td>
<td>13×13</td>
<td>3×3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>C6</td>
<td>Convolution</td>
<td>384</td>
<td>13×13</td>
<td>3×3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>C7</td>
<td>Convolution</td>
<td>256</td>
<td>13×13</td>
<td>3×3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S8</td>
<td>Max pool</td>
<td>256</td>
<td>6×6</td>
<td>3×3</td>
<td>2</td>
<td>valid</td>
<td>–</td>
</tr>
<tr class="even">
<td>F9</td>
<td>Fully conn.</td>
<td>–</td>
<td>4,096</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>F10</td>
<td>Fully conn.</td>
<td>–</td>
<td>4,096</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully conn.</td>
<td>–</td>
<td>1,000</td>
<td>–</td>
<td>–</td>
<td>–</td>
<td>Softmax</td>
</tr>
</tbody>
</table>
<div class="footer">
<p>Winner of the ILSVRC 2012 challenge (top-five error 17%), developed by Alex Krizhevsky, Ilya Sutskever, and Geoffrey Hinton.</p>
</div>
</section>
<section id="data-augmentation" class="slide level2">
<h2>Data Augmentation</h2>

<img data-src="data-augmentation.png" class="r-stretch quarto-figure-center"><p class="caption">Examples of data augmentation.</p><div class="footer">
<p>Source: Buah et al.&nbsp;(2020), <em>Can Artificial Intelligence Assist Project Developers in Long-Term Management of Energy Projects? The Case of CO2 Capture and Storage</em>.</p>
</div>
</section>
<section id="inception-module-2014" class="slide level2">
<h2>Inception module (2014)</h2>
<p>Used in ILSVRC 2014 winning solution (top-5 error &lt; 7%).</p>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="inception-module-fig-2b.png"></p>
</div><div class="column" style="width:40%;">
<p><br></p>
<p><img data-src="inception-meme.jpeg"></p>
</div>
</div>
<p>VGGNet was the runner-up.</p>
<div class="footer">
<p>Source: Szegedy, C. et al.&nbsp;(2015), <a href="https://arxiv.org/pdf/1409.4842.pdf"><em>Going deeper with convolutions</em></a> and <a href="https://knowyourmeme.com/memes/we-need-to-go-deeper">KnowYourMeme.com</a>.</p>
</div>
</section>
<section id="googlenet-inception_v1-2014" class="slide level2">
<h2>GoogLeNet / Inception_v1 (2014)</h2>

<img data-src="Geron-mls2_1414-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Schematic of the GoogLeNet architecture.</p><div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-14 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="depth-is-important-for-image-tasks" class="slide level2">
<h2>Depth is important for image tasks</h2>

<img data-src="goodfellow-depth-matters.png" class="r-stretch quarto-figure-center"><p class="caption">Deeper models aren’t just better because they have more parameters. Model depth given in the legend. Accuracy is on the Street View House Numbers dataset.</p><div class="footer">
<p>Source: Goodfellow et al.&nbsp;(2016), <a href="http://www.deeplearningbook.org">Deep Learning</a>, Figure 6.7.</p>
</div>
</section>
<section id="residual-connection" class="slide level2">
<h2>Residual connection</h2>

<img data-src="Geron-mls2_1415-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of a residual connection.</p><div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-15 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="resnet-2015" class="slide level2">
<h2>ResNet (2015)</h2>
<p>ResNet won the ILSVRC 2015 challenge (top-5 error 3.6%), developed by <a href="https://arxiv.org/abs/1512.03385">Kaiming He et al.</a></p>

<img data-src="Geron-mls2_1417-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Diagram of the ResNet architecture.</p><div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-17 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="pretrained-model" class="slide level2">
<h2>Pretrained model</h2>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="im">from</span> tensorflow.keras.applications <span class="im">import</span> mobilenet</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a>model <span class="op">=</span> mobilenet.MobileNet(weights<span class="op">=</span><span class="st">"imagenet"</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a></span>
<span id="cb28-6"><a href="#cb28-6"></a>imageFilenames <span class="op">=</span> [<span class="st">"patrick-0.jpg"</span>, <span class="st">"umbrella-0.jpg"</span>, <span class="st">"hand-15.jpg"</span>]</span>
<span id="cb28-7"><a href="#cb28-7"></a>images <span class="op">=</span> [np.asarray(Image.<span class="bu">open</span>(name)) <span class="cf">for</span> name <span class="kw">in</span> imageFilenames]</span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a>images_resized <span class="op">=</span> tf.image.resize(images, [<span class="dv">224</span>, <span class="dv">224</span>])</span>
<span id="cb28-10"><a href="#cb28-10"></a>inputs <span class="op">=</span> mobilenet.preprocess_input(images_resized)</span>
<span id="cb28-11"><a href="#cb28-11"></a></span>
<span id="cb28-12"><a href="#cb28-12"></a>Y_proba <span class="op">=</span> model.predict(inputs, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb28-13"><a href="#cb28-13"></a>top_K <span class="op">=</span> mobilenet.decode_predictions(Y_proba, top<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb28-14"><a href="#cb28-14"></a></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="cf">for</span> image_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(images)):</span>
<span id="cb28-16"><a href="#cb28-16"></a>    <span class="bu">print</span>(<span class="ss">f"Image #</span><span class="sc">{</span>image_index<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb28-17"><a href="#cb28-17"></a>    <span class="cf">for</span> class_id, name, y_proba <span class="kw">in</span> top_K[image_index]:</span>
<span id="cb28-18"><a href="#cb28-18"></a>        <span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>class_id<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span><span class="bu">int</span>(y_proba<span class="op">*</span><span class="dv">100</span>)<span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb28-19"><a href="#cb28-19"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicted-classes-mobilenet" class="slide level2">
<h2>Predicted classes (MobileNet)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="19">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 40%
 n04591157 - Windsor_tie 33%
 n02749479 - assault_rifle 12%

Image #1:
 n03529860 - home_theater 23%
 n02749479 - assault_rifle 9%
 n04009552 - projector 5%

Image #2:
 n03529860 - home_theater 8%
 n03924679 - photocopier 7%
 n02786058 - Band_Aid 6%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenetv2" class="slide level2">
<h2>Predicted classes (MobileNetV2)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 36%
 n04591157 - Windsor_tie 8%
 n03630383 - lab_coat 6%

Image #1:
 n04023962 - punching_bag 8%
 n04336792 - stretcher 4%
 n03529860 - home_theater 4%

Image #2:
 n04404412 - television 43%
 n02977058 - cash_machine 5%
 n04152593 - screen 3%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-inceptionv3" class="slide level2">
<h2>Predicted classes (InceptionV3)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="21">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 24%
 n04591157 - Windsor_tie 8%
 n03630383 - lab_coat 5%

Image #1:
 n04507155 - umbrella 43%
 n04344873 - studio_couch 2%
 n03529860 - home_theater 2%

Image #2:
 n04404412 - television 22%
 n03630383 - lab_coat 8%
 n02777292 - balance_beam 6%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="transfer-learning-1" class="slide level2">
<h2>Transfer learning</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># Pull in the base model we are transferring from.</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>base_model <span class="op">=</span> keras.applications.Xception(</span>
<span id="cb32-3"><a href="#cb32-3"></a>    weights<span class="op">=</span><span class="st">'imagenet'</span>,  <span class="co"># Load weights pre-trained on ImageNet.</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>    input_shape<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>),</span>
<span id="cb32-5"><a href="#cb32-5"></a>    include_top<span class="op">=</span><span class="va">False</span>)  <span class="co"># Discard the ImageNet classifier at the top.</span></span>
<span id="cb32-6"><a href="#cb32-6"></a></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co"># Tell it not to update its weights.</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>base_model.trainable <span class="op">=</span> <span class="va">False</span></span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co"># Make our new model on top of the base model.</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>inputs <span class="op">=</span> keras.Input(shape<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>))</span>
<span id="cb32-12"><a href="#cb32-12"></a>x <span class="op">=</span> base_model(inputs, training<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-13"><a href="#cb32-13"></a>x <span class="op">=</span> keras.layers.GlobalAveragePooling2D()(x)</span>
<span id="cb32-14"><a href="#cb32-14"></a>outputs <span class="op">=</span> keras.layers.Dense(<span class="dv">1</span>)(x)</span>
<span id="cb32-15"><a href="#cb32-15"></a>model <span class="op">=</span> keras.Model(inputs, outputs)</span>
<span id="cb32-16"><a href="#cb32-16"></a></span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="co"># Compile and fit on our data.</span></span>
<span id="cb32-18"><a href="#cb32-18"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span>keras.optimizers.Adam(),</span>
<span id="cb32-19"><a href="#cb32-19"></a>              loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb32-20"><a href="#cb32-20"></a>              metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb32-21"><a href="#cb32-21"></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">20</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="footer">
<p>Source: François Chollet (2020), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section>
<section id="fine-tuning" class="slide level2">
<h2>Fine-tuning</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Unfreeze the base model</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>base_model.trainable <span class="op">=</span> <span class="va">True</span></span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># It's important to recompile your model after you make any changes</span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="co"># to the `trainable` attribute of any inner layer, so that your changes</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="co"># are take into account</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>model.<span class="bu">compile</span>(</span>
<span id="cb33-8"><a href="#cb33-8"></a>    optimizer<span class="op">=</span>keras.optimizers.Adam(<span class="fl">1e-5</span>),  <span class="co"># Very low learning rate</span></span>
<span id="cb33-9"><a href="#cb33-9"></a>    loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb33-10"><a href="#cb33-10"></a>    metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb33-11"><a href="#cb33-11"></a></span>
<span id="cb33-12"><a href="#cb33-12"></a><span class="co"># Train end-to-end. Be careful to stop before you overfit!</span></span>
<span id="cb33-13"><a href="#cb33-13"></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">10</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-caution callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Danger</strong></p>
</div>
<div class="callout-content">
<p>Keep the learning rate low, otherwise you may accidentally throw away the useful information in the base model.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: François Chollet (2020), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section>
<section id="what-do-the-cnn-layers-learn" class="slide level2">
<h2>What do the CNN layers learn?</h2>

<img data-src="distill-feature-visualisation.png" class="r-stretch"><div class="footer">
<p>Source: Distill article, <a href="https://distill.pub/2017/feature-visualization/">Feature Visualization</a>.</p>
</div>
</section></section>
<section>
<section id="natural-language-processing" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Natural Language Processing</h1>
<div class="footer">
<p>Source: Krohn (2019), <em>Deep Learning Illustrated</em>, Chapter 2.</p>
</div>
</section>
<section id="what-is-nlp" class="slide level2">
<h2>What is NLP?</h2>
<p>A field of research at the intersection of computer science, linguistics, and artificial intelligence that takes the <strong>naturally spoken or written language</strong> of humans and <strong>processes it with machines</strong> to automate or help in certain tasks</p>
</section>
<section id="how-the-computer-sees-text" class="slide level2">
<h2>How the computer sees text</h2>
<p>Spot the odd one out:</p>
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>[112, 97, 116, 114, 105, 99, 107, 32, 108, 97, 117, 98]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="cell-output cell-output-stdout">
<pre><code>[80, 65, 84, 82, 73, 67, 75, 32, 76, 65, 85, 66]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="cell-output cell-output-stdout">
<pre><code>[76, 101, 118, 105, 32, 65, 99, 107, 101, 114, 109, 97, 110]</code></pre>
</div>
</div>
<div class="fragment">
<p>Generated by:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="bu">print</span>([<span class="bu">ord</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="st">"patrick laub"</span>])</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="bu">print</span>([<span class="bu">ord</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="st">"PATRICK LAUB"</span>])</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="bu">print</span>([<span class="bu">ord</span>(x) <span class="cf">for</span> x <span class="kw">in</span> <span class="st">"Levi Ackerman"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>ord</code> built-in turns characters into their ASCII form.</p>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Question</strong></p>
</div>
<div class="callout-content">
<p>The largest value for a character is 127, can you guess why?</p>
</div>
</div>
</div>
</div>
</section>
<section id="ascii" class="slide level2">
<h2>ASCII</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="wiki-ASCII-Table-wide.svg"></p>
<p></p><figcaption>American Standard Code for Information Interchange</figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="awkward-look-monkey-puppet.png"></p>
<p></p><figcaption>Americans when asked how non-English characters get encoded in ASCII</figcaption><p></p>
</figure>
</div>
<p>Unicode is the new standard.</p>
</div>
</div>
<div class="footer">
<p>Source: <a href="https://commons.wikimedia.org/wiki/File:ASCII-Table-wide.svg">Wikipedia</a>.</p>
</div>
</section>
<section id="random-strings" class="slide level2">
<h2>Random strings</h2>
<p>The built-in <code>chr</code> function turns numbers into characters.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>rnd.seed(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>chars <span class="op">=</span> [<span class="bu">chr</span>(rnd.randint(<span class="dv">32</span>, <span class="dv">127</span>)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span>
<span id="cb39-2"><a href="#cb39-2"></a>chars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>['E', ',', 'h', ')', 'k', '%', 'o', '`', '0', '!']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="co">" "</span>.join(chars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>'E , h ) k % o ` 0 !'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">""</span>.join([<span class="bu">chr</span>(rnd.randint(<span class="dv">32</span>, <span class="dv">127</span>)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>"lg&amp;9R42t+&lt;=.Rdww~v-)'_]6Y! \\q(x-Oh&gt;g#f5QY#d8Kl:TpI"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="co">""</span>.join([<span class="bu">chr</span>(rnd.randint(<span class="dv">0</span>, <span class="dv">128</span>)) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>'R\x0f@D\x19obW\x07\x1a\x19h\x16\tCg~\x17}d\x1b%9S&amp;\x08 "\n\x17\x0foW\x19Gs\\J&gt;. X\x177AqM\x03\x00x'</code></pre>
</div>
</div>
</section>
<section id="applications-of-nlp-in-industry" class="slide level2">
<h2>Applications of NLP in Industry</h2>
<p><strong>1) Classifying documents</strong>: Using the language within a body of text to classify it into a particular category, e.g.:</p>
<ul>
<li>Grouping emails into high and low urgency</li>
<li>Movie reviews into positive and negative sentiment (i.e.&nbsp;<em>sentiment analysis</em>)</li>
<li>Company news into bullish (positive) and bearish (negative) statements</li>
</ul>
<p><strong>2) Machine translation</strong>: Assisting language translators with machine-generated suggestions from a source language (e.g.&nbsp;English) to a target language</p>
</section>
<section id="applications-of-nlp-in-industry-1" class="slide level2">
<h2>Applications of NLP in Industry</h2>
<p><strong>3) Search engine</strong> functions, including:</p>
<ul>
<li>Autocomplete</li>
<li>Predicting what information or website user is seeking</li>
</ul>
<p><strong>4) Speech recognition</strong>: Interpreting voice commands to provide information or take action. Used in virtual assistants such as Alexa, Siri, and Cortana</p>
</section>
<section id="deep-learning-nlp" class="slide level2">
<h2>Deep learning &amp; NLP?</h2>
<p>Simple NLP applications such as spell checkers and synonym suggesters <strong>do not require deep learning</strong> and can be solved with <strong>deterministic, rules-based code</strong> with a dictionary/thesaurus.</p>
<p>More complex NLP applications such as classifying documents, search engine word prediction, and chatbots are complex enough to be solved using deep learning methods.</p>
</section>
<section id="nlp-in-1966-1973-1" class="slide level2">
<h2>NLP in 1966-1973 #1</h2>
<blockquote>
<p>A typical story occurred in early machine translation efforts, which were generously funded by the U.S. National Research Council in an attempt to speed up the translation of Russian scientific papers in the wake of the Sputnik launch in 1957. It was thought initially that simple syntactic transformations, based on the grammars of Russian and English, and word replacement from an electronic dictionary, would suffice to preserve the exact meanings of sentences.</p>
</blockquote>
<div class="footer">
<p>Source: Russell and Norvig (2016), <em>Artificial Intelligence: A Modern Approach</em>, Third Edition, p.&nbsp;21.</p>
</div>
</section>
<section id="nlp-in-1966-1973-2" class="slide level2">
<h2>NLP in 1966-1973 #2</h2>
<blockquote>
<p>The fact is that accurate translation requires background knowledge in order to resolve ambiguity and establish the content of the sentence. The famous retranslation of <strong>“the spirit is willing but the flesh is weak”</strong> as <strong>“the vodka is good but the meat is rotten”</strong> illustrates the difficulties encountered. In 1966, a report by an advisory committee found that “there has been no machine translation of general scientific text, and none is in immediate prospect.” All U.S. government funding for academic translation projects was canceled.</p>
</blockquote>
<div class="footer">
<p>Source: Russell and Norvig (2016), <em>Artificial Intelligence: A Modern Approach</em>, Third Edition, p.&nbsp;21.</p>
</div>
</section>
<section id="high-level-history-of-deep-learning" class="slide level2">
<h2>High-level history of deep learning</h2>
<p><br></p>
<center>
<img data-src="krohn_f02_03-blur.png">
</center>
<p class="caption">
A brief history of deep learning.
</p>
<div class="footer">
<p>Source: Krohn (2019), <em>Deep Learning Illustrated</em>, Figure 2-3 (<strong>redacted</strong>).</p>
</div>
</section></section>
<section>
<section id="car-crash-police-reports" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Car Crash Police Reports</h1>

</section>
<section id="downloading-the-dataset" class="slide level2">
<h2>Downloading the dataset</h2>
<p>Look at the (U.S.) National Highway Traffic Safety Administration’s (NHTSA) <a href="https://crashstats.nhtsa.dot.gov/Api/Public/ViewPublication/812506">National Motor Vehicle Crash Causation Survey</a> (NMVCCS) dataset.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb47-2"><a href="#cb47-2"></a></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="cf">if</span> <span class="kw">not</span> Path(<span class="st">"NHTSA_NMVCCS_extract.parquet.gzip"</span>).exists():</span>
<span id="cb47-4"><a href="#cb47-4"></a>    <span class="bu">print</span>(<span class="st">"Downloading dataset"</span>)</span>
<span id="cb47-5"><a href="#cb47-5"></a>    <span class="op">!</span>wget https:<span class="op">//</span>github.com<span class="op">/</span>JSchelldorfer<span class="op">/</span>ActuarialDataScience<span class="op">/</span>raw<span class="op">/</span>master<span class="op">/</span><span class="dv">12</span><span class="op">%</span><span class="dv">20</span><span class="op">-%</span><span class="dv">20</span><span class="er">NLP</span><span class="op">%</span><span class="dv">20</span><span class="er">Using</span><span class="op">%</span><span class="dv">20</span><span class="er">Transformers</span><span class="op">/</span>NHTSA_NMVCCS_extract.parquet.gzip</span>
<span id="cb47-6"><a href="#cb47-6"></a></span>
<span id="cb47-7"><a href="#cb47-7"></a>df <span class="op">=</span> pd.read_parquet(<span class="st">"NHTSA_NMVCCS_extract.parquet.gzip"</span>)</span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="bu">print</span>(<span class="ss">f"shape of DataFrame: </span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape of DataFrame: (6949, 16)</code></pre>
</div>
</div>
</section>
<section id="features" class="slide level2 smaller">
<h2>Features</h2>
<ul>
<li><code>level_0</code>, <code>index</code>, <code>SCASEID</code>: all useless row numbers</li>
<li><code>SUMMARY_EN</code> and <code>SUMMARY_GE</code>: summaries of the accident</li>
<li><code>NUMTOTV</code>: total number of vehicles involved in the accident</li>
<li><code>WEATHER1</code> to <code>WEATHER8</code>:
<ul>
<li><code>WEATHER1</code>: cloudy</li>
<li><code>WEATHER2</code>: snow</li>
<li><code>WEATHER3</code>: fog, smog, smoke</li>
<li><code>WEATHER4</code>: rain</li>
<li><code>WEATHER5</code>: sleet, hail (freezing drizzle or rain)</li>
<li><code>WEATHER6</code>: blowing snow</li>
<li><code>WEATHER7</code>: severe crosswinds</li>
<li><code>WEATHER8</code>: other</li>
</ul></li>
<li><code>INJSEVA</code> and <code>INJSEVB</code>: injury severity &amp; (binary) presence of bodily injury</li>
</ul>
<div class="footer">
<p>Source: <a href="https://github.com/JSchelldorfer/ActuarialDataScience/blob/master/12%20-%20NLP%20Using%20Transformers/Actuarial_Applications_of_NLP_Part_1.ipynb">JSchelldorfer’s GitHub</a>.</p>
</div>
</section>
<section id="crash-summaries" class="slide level2">
<h2>Crash summaries</h2>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>df[<span class="st">"SUMMARY_EN"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>0       V1, a 2000 Pontiac Montana minivan, made a lef...
1       The crash occurred in the eastbound lane of a ...
2       This crash occurred just after the noon time h...
                              ...                        
6946    The crash occurred in the eastbound lanes of a...
6947    This single-vehicle crash occurred in a rural ...
6948    This two vehicle daytime collision occurred mi...
Name: SUMMARY_EN, Length: 6949, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>df[<span class="st">"SUMMARY_EN"</span>].<span class="bu">map</span>(<span class="kw">lambda</span> summary: <span class="bu">len</span>(summary)).hist(grid<span class="op">=</span><span class="va">False</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="natural-language-processing_files/figure-revealjs/cell-35-output-1.png" class="r-stretch"></section>
<section id="a-crash-summary" class="slide level2">
<h2>A crash summary</h2>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>df[<span class="st">"SUMMARY_EN"</span>].iloc[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>"The crash occurred in the eastbound lane of a two-lane, two-way asphalt roadway on level grade.  The conditions were daylight and wet with cloudy skies in the early afternoon on a weekday.\t\r \r V1, a 1995 Chevrolet Lumina was traveling eastbound.  V2, a 2004 Chevrolet Trailblazer was also traveling eastbound on the same roadway.  V2, was attempting to make a left-hand turn into a private drive on the North side of the roadway.  While turning V1 attempted to pass V2 on the left-hand side contacting it's front to the left side of V2.  Both vehicles came to final rest on the roadway at impact.\r \r The driver of V1 fled the scene and was not identified, so no further information could be obtained from him.  The Driver of V2 stated that the driver was a male and had hit his head and was bleeding.  She did not pursue the driver because she thought she saw a gun. The officer said that the car had been reported stolen.\r \r The Critical Precrash Event for the driver of V1 was this vehicle traveling over left lane line on the left side of travel.  The Critical Reason for the Critical Event was coded as unknown reason for the critical event because the driver was not available. \r \r The driver of V2 was a 41-year old female who had reported that she had stopped prior to turning to make sure she was at the right house.  She was going to show a house for a client.  She had no health related problems.  She had taken amoxicillin.  She does not wear corrective lenses and felt rested.  She was not injured in the crash.\r \r The Critical Precrash Event for the driver of V2 was other vehicle encroachment from adjacent lane over left lane line.  The Critical Reason for the Critical Event was not coded for this vehicle and the driver of V2 was not thought to have contributed to the crash."</code></pre>
</div>
</div>
</section>
<section id="target" class="slide level2">
<h2>Target</h2>
<div class="columns">
<div class="column">
<p>Predict number of vehicles in the crash.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>df[<span class="st">"NUMTOTV"</span>].value_counts()<span class="op">\</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>    .sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>1    1822
2    4151
3     783
4     150
5      34
6       5
7       2
8       1
9       1
Name: NUMTOTV, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>np.<span class="bu">sum</span>(df[<span class="st">"NUMTOTV"</span>] <span class="op">&gt;</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>193</code></pre>
</div>
</div>
</div><div class="column">
<p>Simplify the target to just:</p>
<ul>
<li>1 vehicle</li>
<li>2 vehicles</li>
<li>3+ vehicles</li>
</ul>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>df[<span class="st">"NUM_VEHICLES"</span>] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  df[<span class="st">"NUMTOTV"</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="op">\</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>    <span class="bu">str</span>(x) <span class="cf">if</span> x <span class="op">&lt;=</span> <span class="dv">2</span> <span class="cf">else</span> <span class="st">"3+"</span>)</span>
<span id="cb58-4"><a href="#cb58-4"></a>df[<span class="st">"NUM_VEHICLES"</span>].value_counts()<span class="op">\</span></span>
<span id="cb58-5"><a href="#cb58-5"></a>  .sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>1     1822
2     4151
3+     976
Name: NUM_VEHICLES, dtype: int64</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="convert-y-to-integers-split-the-data" class="slide level2">
<h2>Convert <span class="math inline">\(y\)</span> to integers &amp; split the data</h2>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb60-2"><a href="#cb60-2"></a>targetLabels <span class="op">=</span> df[<span class="st">"NUM_VEHICLES"</span>]</span>
<span id="cb60-3"><a href="#cb60-3"></a>target <span class="op">=</span> LabelEncoder().fit_transform(targetLabels)</span>
<span id="cb60-4"><a href="#cb60-4"></a>target</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([1, 1, 1, ..., 2, 0, 1])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>weatherCols <span class="op">=</span> [<span class="ss">f"WEATHER</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">9</span>)]</span>
<span id="cb62-2"><a href="#cb62-2"></a>features <span class="op">=</span> df[[<span class="st">"SUMMARY_EN"</span>] <span class="op">+</span> weatherCols]</span>
<span id="cb62-3"><a href="#cb62-3"></a></span>
<span id="cb62-4"><a href="#cb62-4"></a>X_main, X_test, y_main, y_test <span class="op">=</span> <span class="op">\</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>    train_test_split(features, target, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb62-6"><a href="#cb62-6"></a></span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="co"># As 0.25 x 0.8 = 0.2</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>X_train, X_val, y_train, y_val <span class="op">=</span> <span class="op">\</span></span>
<span id="cb62-9"><a href="#cb62-9"></a>    train_test_split(X_main, y_main, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb62-10"><a href="#cb62-10"></a></span>
<span id="cb62-11"><a href="#cb62-11"></a>X_train.shape, X_val.shape, X_test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>((4169, 9), (1390, 9), (1390, 9))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a><span class="bu">print</span>([np.mean(y_train <span class="op">==</span> y) <span class="cf">for</span> y <span class="kw">in</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.25833533221396016, 0.6032621731830176, 0.1384024946030223]</code></pre>
</div>
</div>
</section></section>
<section>
<section id="bag-of-words" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Bag Of Words</h1>

</section>
<section id="grab-the-start-of-a-few-summaries" class="slide level2">
<h2>Grab the start of a few summaries</h2>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>firstSummaries <span class="op">=</span> X_train[<span class="st">"SUMMARY_EN"</span>].iloc[:<span class="dv">3</span>]</span>
<span id="cb66-2"><a href="#cb66-2"></a>firstSummaries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>2532    This crash occurred in the early afternoon of ...
6209    This two-vehicle crash occurred in a four-legg...
2561    The crash occurred in the eastbound direction ...
Name: SUMMARY_EN, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>firstWords <span class="op">=</span> firstSummaries.<span class="bu">map</span>(<span class="kw">lambda</span> txt: txt.split(<span class="st">" "</span>)[:<span class="dv">7</span>])</span>
<span id="cb68-2"><a href="#cb68-2"></a>firstWords</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>2532    [This, crash, occurred, in, the, early, aftern...
6209    [This, two-vehicle, crash, occurred, in, a, fo...
2561    [The, crash, occurred, in, the, eastbound, dir...
Name: SUMMARY_EN, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>startOfSummaries <span class="op">=</span> firstWords.<span class="bu">map</span>(<span class="kw">lambda</span> txt: <span class="st">" "</span>.join(txt))</span>
<span id="cb70-2"><a href="#cb70-2"></a>startOfSummaries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>2532          This crash occurred in the early afternoon
6209    This two-vehicle crash occurred in a four-legged
2561       The crash occurred in the eastbound direction
Name: SUMMARY_EN, dtype: object</code></pre>
</div>
</div>
</section>
<section id="count-words-in-the-first-summaries" class="slide level2">
<h2>Count words in the first summaries</h2>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb72-2"><a href="#cb72-2"></a></span>
<span id="cb72-3"><a href="#cb72-3"></a>vect <span class="op">=</span> CountVectorizer()</span>
<span id="cb72-4"><a href="#cb72-4"></a>counts <span class="op">=</span> vect.fit_transform(startOfSummaries)</span>
<span id="cb72-5"><a href="#cb72-5"></a>vocab <span class="op">=</span> vect.get_feature_names_out()</span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="bu">print</span>(<span class="bu">len</span>(vocab), vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13 ['afternoon' 'crash' 'direction' 'early' 'eastbound' 'four' 'in' 'legged'
 'occurred' 'the' 'this' 'two' 'vehicle']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a>counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>&lt;3x13 sparse matrix of type '&lt;class 'numpy.int64'&gt;'
    with 21 stored elements in Compressed Sparse Row format&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>counts.todense()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>matrix([[1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0],
        [0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1],
        [0, 1, 1, 0, 1, 0, 1, 0, 1, 2, 0, 0, 0]])</code></pre>
</div>
</div>
</section>
<section id="encode-new-sentences-to-bow" class="slide level2">
<h2>Encode new sentences to BoW</h2>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a>vect.transform([</span>
<span id="cb78-2"><a href="#cb78-2"></a>    <span class="st">"first car hit second car in a crash"</span>,</span>
<span id="cb78-3"><a href="#cb78-3"></a>    <span class="st">"ipad os 16 beta released"</span>,</span>
<span id="cb78-4"><a href="#cb78-4"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>&lt;2x13 sparse matrix of type '&lt;class 'numpy.int64'&gt;'
    with 2 stored elements in Compressed Sparse Row format&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a>vect.transform([</span>
<span id="cb80-2"><a href="#cb80-2"></a>    <span class="st">"first car hit second car in a crash"</span>,</span>
<span id="cb80-3"><a href="#cb80-3"></a>    <span class="st">"ipad os 16 beta released"</span>,</span>
<span id="cb80-4"><a href="#cb80-4"></a>]).todense()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>matrix([[0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]])</code></pre>
</div>
</div>
</section>
<section id="bag-of-n-grams" class="slide level2">
<h2>Bag of <span class="math inline">\(n\)</span>-grams</h2>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a>vect <span class="op">=</span> CountVectorizer(ngram_range<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb82-2"><a href="#cb82-2"></a>counts <span class="op">=</span> vect.fit_transform(startOfSummaries)</span>
<span id="cb82-3"><a href="#cb82-3"></a>vocab <span class="op">=</span> vect.get_feature_names_out()</span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="bu">print</span>(<span class="bu">len</span>(vocab), vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>27 ['afternoon' 'crash' 'crash occurred' 'direction' 'early'
 'early afternoon' 'eastbound' 'eastbound direction' 'four' 'four legged'
 'in' 'in four' 'in the' 'legged' 'occurred' 'occurred in' 'the'
 'the crash' 'the early' 'the eastbound' 'this' 'this crash' 'this two'
 'two' 'two vehicle' 'vehicle' 'vehicle crash']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>counts.todense()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>matrix([[1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1,
         1, 0, 0, 0, 0, 0],
        [0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1,
         0, 1, 1, 1, 1, 1],
        [0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 2, 1, 0, 1, 0,
         0, 0, 0, 0, 0, 0]])</code></pre>
</div>
</div>
<p>See: <a href="https://books.google.com/ngrams">Google Books Ngram Viewer</a></p>
</section>
<section id="count-words-in-all-the-summaries" class="slide level2">
<h2>Count words in all the summaries</h2>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>vect <span class="op">=</span> CountVectorizer()</span>
<span id="cb86-2"><a href="#cb86-2"></a>vect.fit(X_train[<span class="st">"SUMMARY_EN"</span>])</span>
<span id="cb86-3"><a href="#cb86-3"></a>vocab <span class="op">=</span> <span class="bu">list</span>(vect.get_feature_names_out())</span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="bu">len</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>10703</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>vocab[:<span class="dv">5</span>], vocab[<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span>:(<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span>)], vocab[<span class="op">-</span><span class="dv">5</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>(['00', '000', '000lbs', '003', '005'],
 ['inching', 'incidence', 'incident', 'incidental', 'incidents'],
 ['zorcor', 'zotril', 'zx2', 'zx5', 'zyrtec'])</code></pre>
</div>
</div>
</section>
<section id="create-the-x-matrices" class="slide level2">
<h2>Create the <span class="math inline">\(X\)</span> matrices</h2>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a><span class="kw">def</span> vectorise_dataset(X, vect, txtCol<span class="op">=</span><span class="st">"SUMMARY_EN"</span>, dataframe<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb90-2"><a href="#cb90-2"></a>    X_vects <span class="op">=</span> vect.transform(X[txtCol]).todense()</span>
<span id="cb90-3"><a href="#cb90-3"></a>    X_other <span class="op">=</span> X.drop(txtCol, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb90-4"><a href="#cb90-4"></a></span>
<span id="cb90-5"><a href="#cb90-5"></a>    <span class="cf">if</span> <span class="kw">not</span> dataframe:</span>
<span id="cb90-6"><a href="#cb90-6"></a>        <span class="cf">return</span> np.concatenate([X_vects, X_other], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb90-7"><a href="#cb90-7"></a>    <span class="cf">else</span>:</span>
<span id="cb90-8"><a href="#cb90-8"></a>        <span class="co"># Add column names and indices to the combined dataframe.</span></span>
<span id="cb90-9"><a href="#cb90-9"></a>        vocab <span class="op">=</span> <span class="bu">list</span>(vect.get_feature_names_out())</span>
<span id="cb90-10"><a href="#cb90-10"></a>        X_vects_df <span class="op">=</span> pd.DataFrame(X_vects, columns<span class="op">=</span>vocab, index<span class="op">=</span>X.index)</span>
<span id="cb90-11"><a href="#cb90-11"></a>        <span class="cf">return</span> pd.concat([X_vects_df, X_other], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a>X_train_ct <span class="op">=</span> vectorise_dataset(X_train, vect)</span>
<span id="cb91-2"><a href="#cb91-2"></a>X_val_ct <span class="op">=</span> vectorise_dataset(X_val, vect)</span>
<span id="cb91-3"><a href="#cb91-3"></a>X_test_ct <span class="op">=</span> vectorise_dataset(X_test, vect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-the-input-matrix" class="slide level2">
<h2>Check the input matrix</h2>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a>vectorise_dataset(X_train, vect, dataframe<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>00</th>
      <th>000</th>
      <th>000lbs</th>
      <th>003</th>
      <th>005</th>
      <th>007</th>
      <th>00am</th>
      <th>00pm</th>
      <th>00tydo2</th>
      <th>01</th>
      <th>...</th>
      <th>zx5</th>
      <th>zyrtec</th>
      <th>WEATHER1</th>
      <th>WEATHER2</th>
      <th>WEATHER3</th>
      <th>WEATHER4</th>
      <th>WEATHER5</th>
      <th>WEATHER6</th>
      <th>WEATHER7</th>
      <th>WEATHER8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2532</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6209</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2561</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6882</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>206</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6356</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>4169 rows × 10711 columns</p>
</div>
</div>
</div>
</section>
<section id="make-a-simple-dense-model" class="slide level2">
<h2>Make a simple dense model</h2>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a>numFeatures <span class="op">=</span> X_train_ct.shape[<span class="dv">1</span>]</span>
<span id="cb93-2"><a href="#cb93-2"></a>numCats <span class="op">=</span> <span class="dv">3</span> <span class="co"># 1, 2, 3+ vehicles</span></span>
<span id="cb93-3"><a href="#cb93-3"></a></span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="kw">def</span> build_model(numFeatures, numCats):</span>
<span id="cb93-5"><a href="#cb93-5"></a>    tf.random.set_seed(<span class="dv">42</span>)</span>
<span id="cb93-6"><a href="#cb93-6"></a>    </span>
<span id="cb93-7"><a href="#cb93-7"></a>    model <span class="op">=</span> Sequential([</span>
<span id="cb93-8"><a href="#cb93-8"></a>        Dense(<span class="dv">1_000</span>, input_dim<span class="op">=</span>numFeatures, activation<span class="op">=</span><span class="st">"relu"</span>),</span>
<span id="cb93-9"><a href="#cb93-9"></a>        Dense(numCats, activation<span class="op">=</span><span class="st">"softmax"</span>)</span>
<span id="cb93-10"><a href="#cb93-10"></a>    ])</span>
<span id="cb93-11"><a href="#cb93-11"></a>    </span>
<span id="cb93-12"><a href="#cb93-12"></a>    topk <span class="op">=</span> SparseTopKCategoricalAccuracy(k<span class="op">=</span><span class="dv">2</span>, name<span class="op">=</span><span class="st">"topk"</span>)</span>
<span id="cb93-13"><a href="#cb93-13"></a>    model.<span class="bu">compile</span>(<span class="st">"adam"</span>, <span class="st">"SparseCategoricalCrossentropy"</span>,</span>
<span id="cb93-14"><a href="#cb93-14"></a>        metrics<span class="op">=</span>[<span class="st">"accuracy"</span>, topk])</span>
<span id="cb93-15"><a href="#cb93-15"></a>    </span>
<span id="cb93-16"><a href="#cb93-16"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-the-model" class="slide level2">
<h2>Inspect the model</h2>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>model <span class="op">=</span> build_model(numFeatures, numCats)</span>
<span id="cb94-2"><a href="#cb94-2"></a>model.summary(print_fn<span class="op">=</span>skip_empty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
Layer (type)                Output Shape              Param #
=================================================================
dense (Dense)               (None, 1000)              10712000
dense_1 (Dense)             (None, 3)                 3003
=================================================================
Total params: 10,715,003
Trainable params: 10,715,003
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="fit-evaluate-the-model" class="slide level2">
<h2>Fit &amp; evaluate the model</h2>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">1</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb96-2"><a href="#cb96-2"></a>    monitor<span class="op">=</span><span class="st">"val_accuracy"</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="op">%</span>time hist <span class="op">=</span> model.fit(X_train_ct, y_train, epochs<span class="op">=</span><span class="dv">10</span>, <span class="op">\</span></span>
<span id="cb96-4"><a href="#cb96-4"></a>    callbacks<span class="op">=</span>[es], validation_data<span class="op">=</span>(X_val_ct, y_val), verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Restoring model weights from the end of the best epoch: 3.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 4: early stopping</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 30.3 s, sys: 7.32 s, total: 37.6 s
Wall time: 7.03 s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>model.evaluate(X_train_ct, y_train, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>[0.002321666805073619, 1.0, 1.0]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a>model.evaluate(X_val_ct, y_val, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>[6.94630241394043, 0.9776978492736816, 0.999280571937561]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1"></a>model.evaluate(X_test_ct, y_test, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>[0.06972196698188782, 0.9762589931488037, 1.0]</code></pre>
</div>
</div>
</section></section>
<section>
<section id="limiting-the-vocabulary" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Limiting The Vocabulary</h1>

</section>
<section id="the-max_features-value" class="slide level2">
<h2>The <code>max_features</code> value</h2>
<p><br></p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1"></a>vect <span class="op">=</span> CountVectorizer(max_features<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb106-2"><a href="#cb106-2"></a>vect.fit(X_train[<span class="st">"SUMMARY_EN"</span>])</span>
<span id="cb106-3"><a href="#cb106-3"></a>vocab <span class="op">=</span> vect.get_feature_names_out()</span>
<span id="cb106-4"><a href="#cb106-4"></a><span class="bu">len</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a><span class="bu">print</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['and' 'driver' 'for' 'in' 'of' 'the' 'to' 'v1' 'vehicle' 'was']</code></pre>
</div>
</div>
</section>
<section id="remove-stop-words" class="slide level2">
<h2>Remove stop words</h2>
<p><br></p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a>vect <span class="op">=</span> CountVectorizer(max_features<span class="op">=</span><span class="dv">10</span>, stop_words<span class="op">=</span><span class="st">"english"</span>)</span>
<span id="cb110-2"><a href="#cb110-2"></a>vect.fit(X_train[<span class="st">"SUMMARY_EN"</span>])</span>
<span id="cb110-3"><a href="#cb110-3"></a>vocab <span class="op">=</span> vect.get_feature_names_out()</span>
<span id="cb110-4"><a href="#cb110-4"></a><span class="bu">len</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a><span class="bu">print</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['coded' 'crash' 'critical' 'driver' 'lane' 'left' 'roadway' 'v1' 'v2'
 'vehicle']</code></pre>
</div>
</div>
</section>
<section id="keep-1000-most-frequent-words" class="slide level2">
<h2>Keep 1,000 most frequent words</h2>
<p><br></p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>vect <span class="op">=</span> CountVectorizer(max_features<span class="op">=</span><span class="dv">1_000</span>, stop_words<span class="op">=</span><span class="st">"english"</span>)</span>
<span id="cb114-2"><a href="#cb114-2"></a>vect.fit(X_train[<span class="st">"SUMMARY_EN"</span>])</span>
<span id="cb114-3"><a href="#cb114-3"></a>vocab <span class="op">=</span> vect.get_feature_names_out()</span>
<span id="cb114-4"><a href="#cb114-4"></a><span class="bu">len</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>1000</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a><span class="bu">print</span>(vocab[:<span class="dv">5</span>], vocab[<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span>:(<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span>)], vocab[<span class="op">-</span><span class="dv">5</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['10' '105' '113' '12' '15'] ['intersection' 'interstate' 'interview' 'interviewed' 'investigating'] ['year' 'years' 'yellow' 'yield' 'zone']</code></pre>
</div>
</div>
<p>Create the <span class="math inline">\(X\)</span> matrices:</p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>X_train_ct <span class="op">=</span> vectorise_dataset(X_train, vect)</span>
<span id="cb118-2"><a href="#cb118-2"></a>X_val_ct <span class="op">=</span> vectorise_dataset(X_val, vect)</span>
<span id="cb118-3"><a href="#cb118-3"></a>X_test_ct <span class="op">=</span> vectorise_dataset(X_test, vect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-the-input-matrix-1" class="slide level2">
<h2>Check the input matrix</h2>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1"></a>vectorise_dataset(X_train, vect, dataframe<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>10</th>
      <th>105</th>
      <th>113</th>
      <th>12</th>
      <th>15</th>
      <th>150</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>180</th>
      <th>...</th>
      <th>yield</th>
      <th>zone</th>
      <th>WEATHER1</th>
      <th>WEATHER2</th>
      <th>WEATHER3</th>
      <th>WEATHER4</th>
      <th>WEATHER5</th>
      <th>WEATHER6</th>
      <th>WEATHER7</th>
      <th>WEATHER8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2532</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6209</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2561</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6882</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>206</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6356</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>4169 rows × 1008 columns</p>
</div>
</div>
</div>
</section>
<section id="make-inspect-the-model" class="slide level2">
<h2>Make &amp; inspect the model</h2>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1"></a>numFeatures <span class="op">=</span> X_train_ct.shape[<span class="dv">1</span>]</span>
<span id="cb120-2"><a href="#cb120-2"></a>model <span class="op">=</span> build_model(numFeatures, numCats)</span>
<span id="cb120-3"><a href="#cb120-3"></a>model.summary(print_fn<span class="op">=</span>skip_empty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
Layer (type)                Output Shape              Param #
=================================================================
dense_2 (Dense)             (None, 1000)              1009000
dense_3 (Dense)             (None, 3)                 3003
=================================================================
Total params: 1,012,003
Trainable params: 1,012,003
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="fit-evaluate-the-model-1" class="slide level2">
<h2>Fit &amp; evaluate the model</h2>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">1</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb122-2"><a href="#cb122-2"></a>    monitor<span class="op">=</span><span class="st">"val_accuracy"</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb122-3"><a href="#cb122-3"></a><span class="op">%</span>time hist <span class="op">=</span> model.fit(X_train_ct, y_train, epochs<span class="op">=</span><span class="dv">10</span>, <span class="op">\</span></span>
<span id="cb122-4"><a href="#cb122-4"></a>    callbacks<span class="op">=</span>[es], validation_data<span class="op">=</span>(X_val_ct, y_val), verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Restoring model weights from the end of the best epoch: 3.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 4: early stopping</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 3.08 s, sys: 724 ms, total: 3.8 s
Wall time: 1.29 s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1"></a>model.evaluate(X_train_ct, y_train, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>[0.003937083762139082, 1.0, 1.0]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1"></a>model.evaluate(X_val_ct, y_val, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>[9.046167373657227, 0.9769784212112427, 0.999280571937561]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1"></a>model.evaluate(X_test_ct, y_test, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>[0.07363022118806839, 0.9726618528366089, 0.999280571937561]</code></pre>
</div>
</div>
</section></section>
<section>
<section id="intelligently-limit-the-vocabulary" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Intelligently Limit The Vocabulary</h1>

</section>
<section id="keep-1000-most-frequent-words-1" class="slide level2">
<h2>Keep 1,000 most frequent words</h2>
<p><br></p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1"></a>vect <span class="op">=</span> CountVectorizer(max_features<span class="op">=</span><span class="dv">1_000</span>, stop_words<span class="op">=</span><span class="st">"english"</span>)</span>
<span id="cb132-2"><a href="#cb132-2"></a>vect.fit(X_train[<span class="st">"SUMMARY_EN"</span>])</span>
<span id="cb132-3"><a href="#cb132-3"></a>vocab <span class="op">=</span> vect.get_feature_names_out()</span>
<span id="cb132-4"><a href="#cb132-4"></a><span class="bu">len</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>1000</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1"></a><span class="bu">print</span>(vocab[:<span class="dv">5</span>], vocab[<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span>:(<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span>)], vocab[<span class="op">-</span><span class="dv">5</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['10' '105' '113' '12' '15'] ['intersection' 'interstate' 'interview' 'interviewed' 'investigating'] ['year' 'years' 'yellow' 'yield' 'zone']</code></pre>
</div>
</div>
</section>
<section id="install-spacy" class="slide level2">
<h2>Install spacy</h2>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1"></a><span class="op">!</span>conda install spacy <span class="op">&gt;</span> <span class="op">/</span>dev<span class="op">/</span>null</span>
<span id="cb136-2"><a href="#cb136-2"></a><span class="op">!</span>python <span class="op">-</span>m spacy download en_core_web_sm <span class="op">&gt;</span> <span class="op">/</span>dev<span class="op">/</span>null</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1"></a><span class="im">import</span> spacy</span>
<span id="cb137-2"><a href="#cb137-2"></a></span>
<span id="cb137-3"><a href="#cb137-3"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span>
<span id="cb137-4"><a href="#cb137-4"></a>doc <span class="op">=</span> nlp(<span class="st">"Apple is looking at buying U.K. startup for $1 billion"</span>)</span>
<span id="cb137-5"><a href="#cb137-5"></a><span class="cf">for</span> token <span class="kw">in</span> doc:</span>
<span id="cb137-6"><a href="#cb137-6"></a>    <span class="bu">print</span>(token.text, token.pos_, token.dep_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Apple PROPN nsubj
is AUX aux
looking VERB ROOT
at ADP prep
buying VERB pcomp
U.K. PROPN compound
startup NOUN dobj
for ADP prep
$ SYM quantmod
1 NUM compound
billion NUM pobj</code></pre>
</div>
</div>
</section>
<section id="lemmatize-the-text" class="slide level2">
<h2>Lemmatize the text</h2>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1"></a><span class="kw">def</span> lemmatize(txt):</span>
<span id="cb139-2"><a href="#cb139-2"></a>    doc <span class="op">=</span> nlp(txt)</span>
<span id="cb139-3"><a href="#cb139-3"></a>    goodTokens <span class="op">=</span> [token.lemma_.lower() <span class="cf">for</span> token <span class="kw">in</span> doc <span class="op">\</span></span>
<span id="cb139-4"><a href="#cb139-4"></a>        <span class="cf">if</span> <span class="kw">not</span> token.like_num <span class="kw">and</span> <span class="op">\</span></span>
<span id="cb139-5"><a href="#cb139-5"></a>           <span class="kw">not</span> token.is_punct <span class="kw">and</span> <span class="op">\</span></span>
<span id="cb139-6"><a href="#cb139-6"></a>           <span class="kw">not</span> token.is_space <span class="kw">and</span> <span class="op">\</span></span>
<span id="cb139-7"><a href="#cb139-7"></a>           <span class="kw">not</span> token.is_currency <span class="kw">and</span> <span class="op">\</span></span>
<span id="cb139-8"><a href="#cb139-8"></a>           <span class="kw">not</span> token.is_stop]</span>
<span id="cb139-9"><a href="#cb139-9"></a>    <span class="cf">return</span> <span class="st">" "</span>.join(goodTokens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1"></a>testStr <span class="op">=</span> <span class="st">"Incident at 100kph and '10 incidents -13.3%' are incidental?</span><span class="ch">\t</span><span class="st"> $5"</span></span>
<span id="cb140-2"><a href="#cb140-2"></a>lemmatize(testStr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>'incident 100kph incident incidental'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1"></a>testStr <span class="op">=</span> <span class="st">"I interviewed 5-years ago, 150 interviews every year at 10:30 are.."</span></span>
<span id="cb142-2"><a href="#cb142-2"></a>lemmatize(testStr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>'interview year ago interview year 10:30'</code></pre>
</div>
</div>
</section>
<section id="apply-to-the-whole-dataset" class="slide level2">
<h2>Apply to the whole dataset</h2>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1"></a>df[<span class="st">"SUMMARY_EN_LEMMA"</span>] <span class="op">=</span> df[<span class="st">"SUMMARY_EN"</span>].<span class="bu">map</span>(lemmatize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1"></a>weatherCols <span class="op">=</span> [<span class="ss">f"WEATHER</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">9</span>)]</span>
<span id="cb145-2"><a href="#cb145-2"></a>features <span class="op">=</span> df[[<span class="st">"SUMMARY_EN_LEMMA"</span>] <span class="op">+</span> weatherCols]</span>
<span id="cb145-3"><a href="#cb145-3"></a></span>
<span id="cb145-4"><a href="#cb145-4"></a>X_main, X_test, y_main, y_test <span class="op">=</span> <span class="op">\</span></span>
<span id="cb145-5"><a href="#cb145-5"></a>    train_test_split(features, target, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb145-6"><a href="#cb145-6"></a></span>
<span id="cb145-7"><a href="#cb145-7"></a><span class="co"># As 0.25 x 0.8 = 0.2</span></span>
<span id="cb145-8"><a href="#cb145-8"></a>X_train, X_val, y_train, y_val <span class="op">=</span> <span class="op">\</span></span>
<span id="cb145-9"><a href="#cb145-9"></a>    train_test_split(X_main, y_main, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb145-10"><a href="#cb145-10"></a></span>
<span id="cb145-11"><a href="#cb145-11"></a>X_train.shape, X_val.shape, X_test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>((4169, 9), (1390, 9), (1390, 9))</code></pre>
</div>
</div>
</section>
<section id="keep-1000-most-frequent-lemmas" class="slide level2">
<h2>Keep 1,000 most frequent lemmas</h2>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1"></a>vect <span class="op">=</span> CountVectorizer(max_features<span class="op">=</span><span class="dv">1_000</span>, stop_words<span class="op">=</span><span class="st">"english"</span>)</span>
<span id="cb147-2"><a href="#cb147-2"></a>vect.fit(X_train[<span class="st">"SUMMARY_EN_LEMMA"</span>])</span>
<span id="cb147-3"><a href="#cb147-3"></a>vocab <span class="op">=</span> vect.get_feature_names_out()</span>
<span id="cb147-4"><a href="#cb147-4"></a><span class="bu">len</span>(vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>1000</code></pre>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1"></a><span class="bu">print</span>(vocab[:<span class="dv">5</span>], vocab[<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span>:(<span class="bu">len</span>(vocab)<span class="op">//</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span>)], vocab[<span class="op">-</span><span class="dv">5</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['10' '150' '48kmph' '4x4' '56kmph'] ['license' 'light' 'lighting' 'like' 'likely'] ['yaw' 'year' 'yellow' 'yield' 'zone']</code></pre>
</div>
</div>
<p>Create the <span class="math inline">\(X\)</span> matrices:</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1"></a>X_train_ct <span class="op">=</span> vectorise_dataset(X_train, vect, <span class="st">"SUMMARY_EN_LEMMA"</span>)</span>
<span id="cb151-2"><a href="#cb151-2"></a>X_val_ct <span class="op">=</span> vectorise_dataset(X_val, vect, <span class="st">"SUMMARY_EN_LEMMA"</span>)</span>
<span id="cb151-3"><a href="#cb151-3"></a>X_test_ct <span class="op">=</span> vectorise_dataset(X_test, vect, <span class="st">"SUMMARY_EN_LEMMA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-the-input-matrix-2" class="slide level2">
<h2>Check the input matrix</h2>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1"></a>vectorise_dataset(X_train, vect, <span class="st">"SUMMARY_EN_LEMMA"</span>, dataframe<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>10</th>
      <th>150</th>
      <th>48kmph</th>
      <th>4x4</th>
      <th>56kmph</th>
      <th>64kmph</th>
      <th>72kmph</th>
      <th>ability</th>
      <th>able</th>
      <th>accelerate</th>
      <th>...</th>
      <th>yield</th>
      <th>zone</th>
      <th>WEATHER1</th>
      <th>WEATHER2</th>
      <th>WEATHER3</th>
      <th>WEATHER4</th>
      <th>WEATHER5</th>
      <th>WEATHER6</th>
      <th>WEATHER7</th>
      <th>WEATHER8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2532</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6209</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2561</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6882</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>206</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6356</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>4169 rows × 1008 columns</p>
</div>
</div>
</div>
</section>
<section id="make-inspect-the-model-1" class="slide level2">
<h2>Make &amp; inspect the model</h2>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1"></a>numFeatures <span class="op">=</span> X_train_ct.shape[<span class="dv">1</span>]</span>
<span id="cb153-2"><a href="#cb153-2"></a>model <span class="op">=</span> build_model(numFeatures, numCats)</span>
<span id="cb153-3"><a href="#cb153-3"></a>model.summary(print_fn<span class="op">=</span>skip_empty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
_________________________________________________________________
Layer (type)                Output Shape              Param #
=================================================================
dense_4 (Dense)             (None, 1000)              1009000
dense_5 (Dense)             (None, 3)                 3003
=================================================================
Total params: 1,012,003
Trainable params: 1,012,003
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="fit-evaluate-the-model-2" class="slide level2">
<h2>Fit &amp; evaluate the model</h2>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">1</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb155-2"><a href="#cb155-2"></a>    monitor<span class="op">=</span><span class="st">"val_accuracy"</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb155-3"><a href="#cb155-3"></a><span class="op">%</span>time hist <span class="op">=</span> model.fit(X_train_ct, y_train, epochs<span class="op">=</span><span class="dv">10</span>, <span class="op">\</span></span>
<span id="cb155-4"><a href="#cb155-4"></a>    callbacks<span class="op">=</span>[es], validation_data<span class="op">=</span>(X_val_ct, y_val), verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Restoring model weights from the end of the best epoch: 1.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 2: early stopping</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 1.63 s, sys: 369 ms, total: 1.99 s
Wall time: 706 ms</code></pre>
</div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1"></a>model.evaluate(X_train_ct, y_train, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>[0.039348434656858444, 0.9913648366928101, 0.9997601509094238]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1"></a>model.evaluate(X_val_ct, y_val, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>[4.565433025360107, 0.9812949895858765, 0.9985611438751221]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1"></a>model.evaluate(X_test_ct, y_test, verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>[0.08682555705308914, 0.9741007089614868, 0.999280571937561]</code></pre>
</div>
</div>
</section></section>
<section>
<section id="interrogate-the-model" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Interrogate The Model</h1>

</section>
<section id="permutation-importance-algorithm" class="slide level2 smaller">
<h2>Permutation importance algorithm</h2>
<p>Taken directly from scikit-learn documentation:</p>
<ul>
<li><p>Inputs: fitted predictive model <span class="math inline">\(m\)</span>, tabular dataset (training or validation) <span class="math inline">\(D\)</span>.</p></li>
<li><p>Compute the reference score <span class="math inline">\(s\)</span> of the model <span class="math inline">\(m\)</span> on data <span class="math inline">\(D\)</span> (for instance the accuracy for a classifier or the <span class="math inline">\(R^2\)</span> for a regressor).</p></li>
<li><p>For each feature <span class="math inline">\(j\)</span> (column of <span class="math inline">\(D\)</span>):</p>
<ul>
<li><p>For each repetition <span class="math inline">\(k\)</span> in <span class="math inline">\({1, \dots, K}\)</span>:</p>
<ul>
<li>Randomly shuffle column <span class="math inline">\(j\)</span> of dataset <span class="math inline">\(D\)</span> to generate a corrupted version of the data named <span class="math inline">\(\tilde{D}_{k,j}\)</span>.</li>
<li>Compute the score <span class="math inline">\(s_{k,j}\)</span> of model <span class="math inline">\(m\)</span> on corrupted data <span class="math inline">\(\tilde{D}_{k,j}\)</span>.</li>
</ul></li>
<li><p>Compute importance <span class="math inline">\(i_j\)</span> for feature <span class="math inline">\(f_j\)</span> defined as:</p>
<p><span class="math display">\[ i_j = s - \frac{1}{K} \sum_{k=1}^{K} s_{k,j} \]</span></p></li>
</ul></li>
</ul>
<div class="footer">
<p>Source: scikit-learn documentation, <a href="https://scikit-learn.org/stable/modules/permutation_importance.html">permutation_importance function</a>.</p>
</div>
</section>
<section id="find-important-inputs" class="slide level2">
<h2>Find important inputs</h2>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1"></a><span class="kw">def</span> permutation_test(model, X, y, numReps<span class="op">=</span><span class="dv">1</span>, seed<span class="op">=</span><span class="dv">42</span>):</span>
<span id="cb165-2"><a href="#cb165-2"></a>    <span class="co">"""</span></span>
<span id="cb165-3"><a href="#cb165-3"></a><span class="co">    Run the permutation test for variable importance.</span></span>
<span id="cb165-4"><a href="#cb165-4"></a><span class="co">    Returns matrix of shape (X.shape[1], len(model.evaluate(X, y))).</span></span>
<span id="cb165-5"><a href="#cb165-5"></a><span class="co">    """</span></span>
<span id="cb165-6"><a href="#cb165-6"></a>    rnd.seed(seed)</span>
<span id="cb165-7"><a href="#cb165-7"></a>    scores <span class="op">=</span> []    </span>
<span id="cb165-8"><a href="#cb165-8"></a></span>
<span id="cb165-9"><a href="#cb165-9"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb165-10"><a href="#cb165-10"></a>        originalColumn <span class="op">=</span> np.copy(X[:, j])</span>
<span id="cb165-11"><a href="#cb165-11"></a>        colScores <span class="op">=</span> []</span>
<span id="cb165-12"><a href="#cb165-12"></a></span>
<span id="cb165-13"><a href="#cb165-13"></a>        <span class="cf">for</span> r <span class="kw">in</span> <span class="bu">range</span>(numReps):</span>
<span id="cb165-14"><a href="#cb165-14"></a>            rnd.shuffle(X[:,j])</span>
<span id="cb165-15"><a href="#cb165-15"></a>            colScores.append(model.evaluate(X, y, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb165-16"><a href="#cb165-16"></a></span>
<span id="cb165-17"><a href="#cb165-17"></a>        scores.append(np.mean(colScores, axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb165-18"><a href="#cb165-18"></a>        X[:,j] <span class="op">=</span> originalColumn</span>
<span id="cb165-19"><a href="#cb165-19"></a>    </span>
<span id="cb165-20"><a href="#cb165-20"></a>    <span class="cf">return</span> np.array(scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="footer">
<p>Note: I updated this function after the lecture to make it more robust.</p>
</div>
</section>
<section id="run-the-permutation-test" class="slide level2">
<h2>Run the permutation test</h2>
<p><br></p>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1"></a>permScores <span class="op">=</span> permutation_test(model, X_val_ct, y_val)[:,<span class="dv">1</span>]</span>
<span id="cb166-2"><a href="#cb166-2"></a>plt.plot(permScores)<span class="op">;</span></span>
<span id="cb166-3"><a href="#cb166-3"></a>plt.xlabel(<span class="st">"Input index"</span>)<span class="op">;</span> plt.ylabel(<span class="st">"Accuracy when shuffled"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="natural-language-processing_files/figure-revealjs/cell-99-output-1.png" class="r-stretch"></section>
<section id="find-the-most-significant-inputs" class="slide level2">
<h2>Find the most significant inputs</h2>
<p><br></p>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1"></a>inputCols <span class="op">=</span> <span class="op">\</span></span>
<span id="cb167-2"><a href="#cb167-2"></a>    vectorise_dataset(X_train, vect, <span class="st">"SUMMARY_EN_LEMMA"</span>, <span class="va">True</span>).columns</span>
<span id="cb167-3"><a href="#cb167-3"></a>bestInputInds <span class="op">=</span> np.argsort(permScores)[:<span class="dv">50</span>]</span>
<span id="cb167-4"><a href="#cb167-4"></a>bestInputs <span class="op">=</span> <span class="bu">list</span>(inputCols[bestInputInds])</span>
<span id="cb167-5"><a href="#cb167-5"></a><span class="bu">print</span>(bestInputs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['v2', 'v3', 'vehicle', 'harmful', 'single', 'critical', 'involve', 'stop', 'lane', 'event', 'hit', 'WEATHER8', 'year', 'grade', 'WEATHER1', 'WEATHER4', 'WEATHER5', 'park', 'v4', 'push', 'think', 'right', 'pickup', 'face', 'barrier', 'injury', 'strike', 'cause', 'morning', 'WEATHER3', 'code', 'WEATHER2', 'congested', 'contact', 'inadequate', 'great', 'portion', 'non', 'toyota', 'track', 'specify', 'fatigue', 'pedestrian', 'night', 'fast', 'positive', 'block', 'transport', 'bind', 'pre']</code></pre>
</div>
</div>
</section>
<section id="how-about-a-simple-decision-tree" class="slide level2">
<h2>How about a simple decision tree?</h2>
<p><br></p>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1"></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb169-2"><a href="#cb169-2"></a>clf <span class="op">=</span> tree.DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">0</span>, max_depth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb169-3"><a href="#cb169-3"></a>clf.fit(X_train_ct[:, bestInputInds], y_train)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1"></a><span class="bu">print</span>(clf.score(X_train_ct[:, bestInputInds], y_train))</span>
<span id="cb170-2"><a href="#cb170-2"></a><span class="bu">print</span>(clf.score(X_val_ct[:, bestInputInds], y_val))</span>
<span id="cb170-3"><a href="#cb170-3"></a><span class="bu">print</span>(clf.score(X_test_ct[:, bestInputInds], y_test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9467498201007436
0.958273381294964
0.9474820143884892</code></pre>
</div>
</div>
</section>
<section id="decision-tree" class="slide level2">
<h2>Decision tree</h2>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1"></a>tree.plot_tree(clf)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="natural-language-processing_files/figure-revealjs/cell-103-output-1.png" class="r-stretch"><div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1"></a><span class="bu">print</span>(np.where(clf.feature_importances_ <span class="op">&gt;</span> <span class="dv">0</span>)[<span class="dv">0</span>])</span>
<span id="cb173-2"><a href="#cb173-2"></a>[bestInputs[ind] <span class="cf">for</span> ind <span class="kw">in</span> np.where(clf.feature_importances_ <span class="op">&gt;</span> <span class="dv">0</span>)[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0 1 5]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>['v2', 'v3', 'critical']</code></pre>
</div>
</div>
</section></section>
<section id="section-3" class="title-slide slide level1 center" data-visibility="uncounted">
<h1></h1>
<h2>
Glossary
</h2>
<div class="columns">
<div class="column">
<ul>
<li>AlexNet</li>
<li>bag of words</li>
<li>CIFAR-10 / CIFAR-100</li>
<li>GoogLeNet &amp; Inception</li>
<li>ImageNet</li>
</ul>
</div><div class="column">
<ul>
<li>fine-tuning</li>
<li>lemmatization</li>
<li>one-hot embedding</li>
<li>transfer learning</li>
<li>vocabulary</li>
</ul>
</div>
</div>
<script defer="">
    // Remove the highlight.js class for the 'compile', 'min', 'max'
    // as there's a bug where they are treated like the Python built-in
    // global functions but we only ever see it as methods like
    // 'model.compile()' or 'predictions.max()'
    buggyBuiltIns = ["compile", "min", "max", "round", "sum"];

    document.querySelectorAll('.bu').forEach((elem) => {
        if (buggyBuiltIns.includes(elem.innerHTML)) {
            elem.classList.remove('bu');
        }
    })

    var registerRevealCallbacks = function() {
        Reveal.on('overviewshown', event => {
            document.querySelector(".line.right").hidden = true;
        });
        Reveal.on('overviewhidden', event => {
            document.querySelector(".line.right").hidden = false;
        });
    };
</script>

<img src="unsw-logo.svg" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Slides: <a href="https://pat-laub.github.io">Dr Patrick Laub</a> (<span class="citation" data-cites="PatrickLaub">@PatrickLaub</span>).</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="natural-language-processing_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="natural-language-processing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="natural-language-processing_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="natural-language-processing_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":6,"grid":false,"background":["rgba(255,255,255,0.0)","https://github.com/rajgoel/reveal.js-plugins/raw/master/chalkboard/img/blackboard.png"]},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.2,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    <script>registerRevealCallbacks();</script>
    

</body></html>