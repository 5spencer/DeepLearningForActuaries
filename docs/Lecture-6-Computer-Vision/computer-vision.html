<!DOCTYPE html>
<html lang="en"><head>
<script src="computer-vision_files/libs/clipboard/clipboard.min.js"></script>
<script src="computer-vision_files/libs/quarto-html/tabby.min.js"></script>
<script src="computer-vision_files/libs/quarto-html/popper.min.js"></script>
<script src="computer-vision_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="computer-vision_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="computer-vision_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="computer-vision_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.1.251">

  <meta name="author" content="Dr Patrick Laub">
  <title>Computer Vision</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="computer-vision_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="computer-vision_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="computer-vision_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="computer-vision_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
<div class="line right"></div>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="unsw-yellow-shape.png" data-background-size="contain !important" class="center">
  <h1 class="title">Computer Vision</h1>
  <p class="subtitle">ACTL3143/5111: Deep Learning for Actuaries</p>
  <p class="author">Dr Patrick Laub</p>
  <p class="date">Week 7</p>
</section>

<section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>
<h2>
Lecture Outline
</h2>
<p><br></p>
<div class="columns">
<div class="column">
<ul>
<li>StoryWall 5</li>
<li>Project</li>
<li>Batch optimisation</li>
<li>RNN discussion</li>
<li>Convolutional Layers</li>
</ul>
</div><div class="column">
<ul>
<li>Convolutional Neural Networks</li>
<li>Demo: CNNs in Keras</li>
<li>Hyperparameter tuning</li>
</ul>
</div>
</div>
<p>Slides: original draft thanks to Hang Nguyen.</p>
<p><br><br></p>
</section>
<section id="load-packages" class="slide level2" data-visibility="uncounted">
<h2>Load packages</h2>
<p><br></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> plot_model</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="op">%</span>load_ext watermark</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="op">%</span>watermark <span class="op">-</span>p numpy,pandas,tensorflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numpy     : 1.21.5
pandas    : 1.4.4
tensorflow: 2.8.0
</code></pre>
</div>
</div>
</section></section>
<section>
<section id="storywall" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>StoryWall</h1>

</section>
<section id="predicting-stock-prices" class="slide level2">
<h2>Predicting stock prices</h2>
<p>I knew you’d want to try to predict stock prices…</p>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Predicting stock prices based on short-term price trends is a <em>foolish foolish foolish</em> thing to do. <strong>Never</strong> trade on something like this.</p>
</div>
</div>
</div>
<ul>
<li>The end of the trading day is different for each stock exchange; you needed stocks on the same exchange.</li>
<li>Many forgot to normalise the data, which led to miniscule MSE values.</li>
</ul>
</section>
<section id="predicting-stock-prices-ii" class="slide level2">
<h2>Predicting stock prices II</h2>
<ul>
<li>Predicting <span class="math inline">\(T\)</span> days ahead is easier than <span class="math inline">\(T=1\)</span>.</li>
<li>But… makes more sense to look at % change over the <span class="math inline">\(T\)</span> days, not % daily change <span class="math inline">\(T\)</span>-days in the future.</li>
<li>Recurrent dropout is different to normal dropout.</li>
<li>Avoid using updatable links for StoryWall (Dropbox, OneDrive, Colab).</li>
<li>Potentially use log-returns instead of percentage daily change.</li>
<li>What you plot (axis width) changes your perspective on the forecasts.</li>
</ul>
</section>
<section id="predicting-stock-prices-iii" class="slide level2 smaller">
<h2>Predicting stock prices III</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"boq.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>df[<span class="st">"Date"</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">"Date"</span>], dayfirst<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>df[<span class="st">"Day"</span>] <span class="op">=</span> df[<span class="st">"Date"</span>].dt.day_name()</span>
<span id="cb3-4"><a href="#cb3-4"></a>df[<span class="st">"% Change"</span>] <span class="op">=</span> df[<span class="st">"BOQ.AX"</span>].pct_change()</span>
<span id="cb3-5"><a href="#cb3-5"></a>df[[<span class="st">"Date"</span>, <span class="st">"Day"</span>, <span class="st">"BOQ.AX"</span>, <span class="st">"% Change"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Day</th>
      <th>BOQ.AX</th>
      <th>% Change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-03</td>
      <td>Monday</td>
      <td>4.512119</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-04</td>
      <td>Tuesday</td>
      <td>4.458509</td>
      <td>-0.011881</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-05</td>
      <td>Wednesday</td>
      <td>4.445107</td>
      <td>-0.003006</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-06</td>
      <td>Thursday</td>
      <td>4.467444</td>
      <td>0.005025</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7840</th>
      <td>2021-10-29</td>
      <td>Friday</td>
      <td>8.800000</td>
      <td>-0.018952</td>
    </tr>
    <tr>
      <th>7841</th>
      <td>2021-10-30</td>
      <td>Saturday</td>
      <td>8.800000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7842</th>
      <td>2021-10-31</td>
      <td>Sunday</td>
      <td>8.800000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>7843</th>
      <td>2021-11-01</td>
      <td>Monday</td>
      <td>8.790000</td>
      <td>-0.001136</td>
    </tr>
  </tbody>
</table>
<p>7844 rows × 4 columns</p>
</div>
</div>
</div>
</section>
<section id="on-shapes-of-the-datasets" class="slide level2 smaller">
<h2>On shapes of the datasets</h2>
<p>Question from Nicholas N. on the Story Wall.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> timeseries_dataset_from_array</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>ts <span class="op">=</span> <span class="bu">range</span>(<span class="dv">20</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>targets <span class="op">=</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">20</span><span class="op">+</span><span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>numTrain <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.4</span> <span class="op">*</span> <span class="bu">len</span>(ts))<span class="op">;</span> numVal <span class="op">=</span> <span class="bu">int</span>(<span class="fl">0.3</span> <span class="op">*</span> <span class="bu">len</span>(ts))</span>
<span id="cb4-6"><a href="#cb4-6"></a>numTest <span class="op">=</span> <span class="bu">len</span>(ts) <span class="op">-</span> numTrain <span class="op">-</span> numVal</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="bu">print</span>(<span class="ss">f"# Train: </span><span class="sc">{</span>numTrain<span class="sc">}</span><span class="ss">, # Val: </span><span class="sc">{</span>numVal<span class="sc">}</span><span class="ss">, # Test: </span><span class="sc">{</span>numTest<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Train: 8, # Val: 6, # Test: 6</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:33%;">
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>trainDS <span class="op">=</span> <span class="op">\</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  timeseries_dataset_from_array(</span>
<span id="cb6-3"><a href="#cb6-3"></a>    ts,</span>
<span id="cb6-4"><a href="#cb6-4"></a>    targets<span class="op">=</span>targets,</span>
<span id="cb6-5"><a href="#cb6-5"></a>    sequence_length<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>    end_index<span class="op">=</span>numTrain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>valDS <span class="op">=</span> <span class="op">\</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  timeseries_dataset_from_array(</span>
<span id="cb7-3"><a href="#cb7-3"></a>    ts,</span>
<span id="cb7-4"><a href="#cb7-4"></a>    targets<span class="op">=</span>targets,</span>
<span id="cb7-5"><a href="#cb7-5"></a>    sequence_length<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>    start_index<span class="op">=</span>numTrain,</span>
<span id="cb7-7"><a href="#cb7-7"></a>    end_index<span class="op">=</span>numTrain<span class="op">+</span>numVal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>testDS <span class="op">=</span> <span class="op">\</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  timeseries_dataset_from_array(</span>
<span id="cb8-3"><a href="#cb8-3"></a>    ts,</span>
<span id="cb8-4"><a href="#cb8-4"></a>    targets<span class="op">=</span>targets,</span>
<span id="cb8-5"><a href="#cb8-5"></a>    sequence_length<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>    start_index<span class="op">=</span>numTrain<span class="op">+</span>numVal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-execution_count="8">
<div class="cell-output cell-output-stdout">
<pre><code>Training dataset
[0, 1, 2] 3
[1, 2, 3] 4
[2, 3, 4] 5
[3, 4, 5] 6
[4, 5, 6] 7
[5, 6, 7] 8</code></pre>
</div>
</div>
</div><div class="column" style="width:30%;">
<div class="cell" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code>Validation dataset
[8, 9, 10] 11
[9, 10, 11] 12
[10, 11, 12] 13
[11, 12, 13] 14</code></pre>
</div>
</div>
</div><div class="column" style="width:30%;">
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>Test dataset
[14, 15, 16] 17
[15, 16, 17] 18
[16, 17, 18] 19
[17, 18, 19] 20</code></pre>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="project" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Project</h1>

</section>
<section id="on-pronouns-in-academic-writing" class="slide level2">
<h2>On pronouns in academic writing</h2>
<p>You can use “we” in a report <em>if</em>:</p>
<div>
<ol type="1">
<li class="fragment">You are one of multiple authors: “<em>We investigated the use of RNNs for…</em>”</li>
<li class="fragment">You are referring to both the author and the reader: “<em>We can see that equation (5) simplifies to…</em>”</li>
<li class="fragment">You are a King or Queen (the <a href="https://en.wikipedia.org/wiki/Royal_we">Royal we</a>): “<em>We are not amused.</em>”</li>
</ol>
</div>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>I wrote an entire <a href="https://pat-laub.github.io/pdfs/honours_thesis.pdf">honours thesis</a> avoiding “we”; there was a lot of “one can see…” and “one could …” etc.</p>
</div>
</div>
</div>
</div>
</section>
<section id="project-components" class="slide level2">
<h2>Project components</h2>
<p><br></p>
<ol type="1">
<li><del>Draft (10% pass/fail).</del> <em>Grades on Moodle by Friday noon</em>.</li>
<li>Recorded presentation due at noon on July 22 (15%).</li>
<li>Final report due at noon on August 1 (15%).</li>
</ol>
<p>Presentation due <em>next Friday</em>.</p>
</section>
<section id="presentation" class="slide level2">
<h2>Presentation</h2>
<p>Create a 3–5 minute recording covering:</p>
<ol type="1">
<li>the problem you are investigating,</li>
<li>the source of the data,</li>
<li>the deep learning approaches you are using, and</li>
<li>preliminary results you have (table of metrics).</li>
</ol>
<p><strong>Deliverable</strong>: YouTube link (public or unlisted) to a special StoryWall page. Presentations will be “public” to the class.</p>
<p><br></p>
<p><em>Suggestions</em>: aim to be fully public and give peer feedback.</p>
</section>
<section id="presentation-marking-scheme" class="slide level2">
<h2>Presentation marking scheme</h2>
<ul>
<li><strong>Content</strong> (6%): did you cover the four points on previous slide?</li>
<li><strong>Style</strong> (6%): are your slides/figures professional and do they enhance the presentation?</li>
<li><strong>Delivery</strong> (3%): is the presentation interesting and within the time limit?</li>
</ul>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>It is a critical skill to be able to condense a complicated project into a short pitch. The project report is where you will give us all the details.</p>
</div>
</div>
</div>
</section>
<section id="last-presentation-tips" class="slide level2">
<h2>Last presentation tips</h2>
<ul>
<li>Each project is different, you decide which parts to focus on. E.g. source of data may simply be “Human Mortality Database”.</li>
<li>Not necessary to film yourself.</li>
<li>Nice to <em>briefly</em> show the data (look at my lecture slides for example).</li>
<li>Don’t go overboard on EDA. Mention the <em>most important</em> 1–2 facts (if any!) about the data. E.g. imbalanced classes for classification.</li>
<li>You can avoid adding UNSW / the course code to your presentation.</li>
</ul>
</section>
<section id="report-requirements" class="slide level2">
<h2>Report requirements</h2>
<p>You are asked to cover the four requirements in the draft, and also:</p>
<ul>
<li>fit two different deep learning architectures,</li>
<li>perform hyperparameter tuning,</li>
<li>write a discussion of the results and any potential ethical concerns.</li>
</ul>
<p><strong>Deliverable</strong>: Report (PDF file), Jupyter Notebook, and dataset (e.g.&nbsp;CSV or ZIP file). Submission not public, probably to Moodle.</p>
</section>
<section id="report-marking-criteria" class="slide level2">
<h2>Report marking criteria</h2>
<ul>
<li><strong>Content</strong> (8%): did you cover the seven points in the ML workflow?</li>
<li><strong>Style</strong> (5%): does your report look professional, are your plots/tables useful and unpixelated, do you have spelling or grammar errors, are you within the page limit, and is the text easy to read?</li>
<li><strong>Code</strong> (2%): is your code clean and well-commented, have useless cells been pruned, does it give errors when the “Run All” button is pressed?</li>
</ul>
<p>Unlike StoryWall, <em>avoid screenshots &amp; code in the report</em>.</p>
</section>
<section id="some-comments-on-the-report" class="slide level2">
<h2>Some comments on the report</h2>
<ul>
<li><strong>Focus on deep learning</strong>: I’m most interested in seeing your ability to use and explain your neural networks. For example, your mastery of the Lee–Carter model is less important to demonstrate.</li>
<li><strong>Hyperparameter tuning</strong>: The tuning is one significant change from the weekly StoryWall tasks. Add a table (for each neural network) showing (at least) two hyperparameters that you tuned.</li>
<li><strong>Use appendices</strong>: If you run out of space, use appendices which are not counted in the page limit. E.g., the less urgent parts of your EDA can go in here.</li>
</ul>
</section></section>
<section>
<section id="loss-and-derivatives" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Loss and derivatives</h1>

</section>
<section id="example-linear-regression" class="slide level2">
<h2>Example: linear regression</h2>
<p><span class="math display">\[
\hat{y}(x) = w x + b
\]</span></p>
<p>For some observation <span class="math inline">\(\{ x_i, y_i \}\)</span>, the (MSE) loss is</p>
<p><span class="math display">\[
\text{Loss}_i = (\hat{y}(x_i) - y_i)^2
\]</span></p>
<p>For a batch of the first <span class="math inline">\(n\)</span> observations the loss is</p>
<p><span class="math display">\[
\text{Loss}_{1:n} = \frac{1}{n} \sum_{i=1}^n (\hat{y}(x_i) - y_i)^2
\]</span></p>
</section>
<section id="derivatives" class="slide level2">
<h2>Derivatives</h2>
<p>Since <span class="math inline">\(\hat{y}(x) = w x + b\)</span>,</p>
<p><span class="math display">\[
\frac{\partial \hat{y}(x)}{\partial w} = x \text{ and }
\frac{\partial \hat{y}(x)}{\partial b} = 1 .
\]</span></p>
<p>As <span class="math inline">\(\text{Loss}_i = (\hat{y}(x_i) - y_i)^2\)</span>, we know <span class="math display">\[
\frac{\partial \text{Loss}_i}{\partial \hat{y}(x_i) } = 2 (\hat{y}(x_i) - y_i) .
\]</span></p>
</section>
<section id="chain-rule" class="slide level2">
<h2>Chain rule</h2>
<p><span class="math display">\[
\frac{\partial \text{Loss}_i}{\partial \hat{y}(x_i) } = 2 (\hat{y}(x_i) - y_i), \,\,
\frac{\partial \hat{y}(x)}{\partial w} = x , \, \text{ and } \,
\frac{\partial \hat{y}(x)}{\partial b} = 1 .
\]</span></p>
<p>Putting this together, we have</p>
<p><span class="math display">\[
\frac{\partial \text{Loss}_i}{\partial w}
= \frac{\partial \text{Loss}_i}{\partial \hat{y}(x_i) }
  \times \frac{\partial \hat{y}(x_i)}{\partial w}
= 2 (\hat{y}(x_i) - y_i) \, x_i
\]</span></p>
<p>and <span class="math display">\[
\frac{\partial \text{Loss}_i}{\partial b}
= \frac{\partial \text{Loss}_i}{\partial \hat{y}(x_i) }
  \times \frac{\partial \hat{y}(x_i)}{\partial b}
= 2 (\hat{y}(x_i) - y_i) .
\]</span></p>
</section>
<section id="stochastic-gradient-descent-sgd" class="slide level2">
<h2>Stochastic gradient descent (SGD)</h2>
<p>Start with <span class="math inline">\(\boldsymbol{\theta}_0 = (w, b)^\top = (0, 0)^\top\)</span>.</p>
<p>Randomly pick <span class="math inline">\(i=5\)</span>, say <span class="math inline">\(x_i = 5\)</span> and <span class="math inline">\(y_i = 5\)</span>.</p>
<div class="fragment">
<p><span class="math display">\[
\hat{y}(x_i) = 0 \times 5 + 0 = 0 \Rightarrow \text{Loss}_i = (0 - 5)^2 = 25.
\]</span></p>
</div>
<div class="fragment">
<p>The partial derivatives are <span class="math display">\[
\begin{aligned}
\frac{\partial \text{Loss}_i}{\partial w}
&amp;= 2 (\hat{y}(x_i) - y_i) \, x_i = 2 \cdot (0 - 5) \cdot 5 = -50, \text{ and} \\
\frac{\partial \text{Loss}_i}{\partial b}
&amp;= 2 (0 - 5) = - 10.
\end{aligned}
\]</span> The gradient is <span class="math inline">\(\nabla \text{Loss}_i = (-50, -10)^\top\)</span>.</p>
</div>
</section>
<section id="sgd-first-iteration" class="slide level2">
<h2>SGD, first iteration</h2>
<p>Start with <span class="math inline">\(\boldsymbol{\theta}_0 = (w, b)^\top = (0, 0)^\top\)</span>.</p>
<p>Randomly pick <span class="math inline">\(i=5\)</span>, say <span class="math inline">\(x_i = 5\)</span> and <span class="math inline">\(y_i = 5\)</span>.</p>
<p>The gradient is <span class="math inline">\(\nabla \text{Loss}_i = (-50, -10)^\top\)</span>.</p>
<p>Use learning rate <span class="math inline">\(\eta = 0.01\)</span> to update <span class="math display">\[
\begin{aligned}
\boldsymbol{\theta}_1
&amp;= \boldsymbol{\theta}_0 - \eta \nabla \text{Loss}_i \\
&amp;= \begin{pmatrix} 0 \\ 0 \end{pmatrix} - 0.01 \begin{pmatrix} -50 \\ -10 \end{pmatrix} \\
&amp;= \begin{pmatrix} 0 \\ 0 \end{pmatrix} + \begin{pmatrix} 0.5 \\ 0.1 \end{pmatrix} = \begin{pmatrix} 0.5 \\ 0.1 \end{pmatrix}.
\end{aligned}
\]</span></p>
</section>
<section id="sgd-second-iteration" class="slide level2">
<h2>SGD, second iteration</h2>
<p>Start with <span class="math inline">\(\boldsymbol{\theta}_1 = (w, b)^\top = (0.5, 0.1)^\top\)</span>.</p>
<p>Randomly pick <span class="math inline">\(i=9\)</span>, say <span class="math inline">\(x_i = 9\)</span> and <span class="math inline">\(y_i = 17\)</span>.</p>
<p>The gradient is <span class="math inline">\(\nabla \text{Loss}_i = (-223.2, -24.8)^\top\)</span>.</p>
<p>Use learning rate <span class="math inline">\(\eta = 0.01\)</span> to update <span class="math display">\[
\begin{aligned}
\boldsymbol{\theta}_2
&amp;= \boldsymbol{\theta}_1 - \eta \nabla \text{Loss}_i \\
&amp;= \begin{pmatrix} 0.5 \\ 0.1 \end{pmatrix} - 0.01 \begin{pmatrix} -223.2 \\ -24.8 \end{pmatrix} \\
&amp;= \begin{pmatrix} 0.5 \\ 0.1 \end{pmatrix} + \begin{pmatrix} 2.232 \\ 0.248 \end{pmatrix} = \begin{pmatrix} 2.732 \\ 0.348 \end{pmatrix}.
\end{aligned}
\]</span></p>
</section>
<section id="batch-gradient-descent-bgd" class="slide level2">
<h2>Batch gradient descent (BGD)</h2>
<p>For the first <span class="math inline">\(n\)</span> observations <span class="math inline">\(\text{Loss}_{1:n} = \frac{1}{n} \sum_{i=1}^n \text{Loss}_i\)</span> so</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \text{Loss}_{1:n}}{\partial w}
&amp;= \frac{1}{n} \sum_{i=1}^n \frac{\partial \text{Loss}_{i}}{\partial w}
= \frac{1}{n} \sum_{i=1}^n \frac{\partial \text{Loss}_{i}}{\hat{y}(x_i)} \frac{\partial \hat{y}(x_i)}{\partial w} \\
&amp;= \frac{1}{n} \sum_{i=1}^n 2 (\hat{y}(x_i) - y_i) \, x_i .
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \text{Loss}_{1:n}}{\partial b}
&amp;= \frac{1}{n} \sum_{i=1}^n \frac{\partial \text{Loss}_{i}}{\partial b}
= \frac{1}{n} \sum_{i=1}^n \frac{\partial \text{Loss}_{i}}{\hat{y}(x_i)} \frac{\partial \hat{y}(x_i)}{\partial b} \\
&amp;= \frac{1}{n} \sum_{i=1}^n 2 (\hat{y}(x_i) - y_i) .
\end{aligned}
\]</span></p>
</section>
<section id="bgd-first-iteration-boldsymboltheta_0-boldsymbol0" class="slide level2">
<h2>BGD, first iteration (<span class="math inline">\(\boldsymbol{\theta}_0 = \boldsymbol{0}\)</span>)</h2>
<div class="cell" data-execution_count="12">
<div class="cell-output cell-output-display" data-execution_count="12">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>y_hat</th>
      <th>loss</th>
      <th>dL/dw</th>
      <th>dL/db</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.99</td>
      <td>0</td>
      <td>0.98</td>
      <td>-1.98</td>
      <td>-1.98</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3.00</td>
      <td>0</td>
      <td>9.02</td>
      <td>-12.02</td>
      <td>-6.01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>5.01</td>
      <td>0</td>
      <td>25.15</td>
      <td>-30.09</td>
      <td>-10.03</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>So <span class="math inline">\(\nabla \text{Loss}_{1:3}\)</span> is</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>nabla <span class="op">=</span> np.array([df[<span class="st">"dL/dw"</span>].mean(), df[<span class="st">"dL/db"</span>].mean()])</span>
<span id="cb12-2"><a href="#cb12-2"></a>nabla </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([-14.69,  -6.  ])</code></pre>
</div>
</div>
<p>so with <span class="math inline">\(\eta = 0.1\)</span> then <span class="math inline">\(\boldsymbol{\theta}_1\)</span> becomes</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>theta_1 <span class="op">=</span> theta_0 <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> nabla</span>
<span id="cb14-2"><a href="#cb14-2"></a>theta_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([1.47, 0.6 ])</code></pre>
</div>
</div>
</section>
<section id="bgd-second-iteration" class="slide level2">
<h2>BGD, second iteration</h2>
<div class="cell" data-execution_count="16">
<div class="cell-output cell-output-display" data-execution_count="16">

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>y_hat</th>
      <th>loss</th>
      <th>dL/dw</th>
      <th>dL/db</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.99</td>
      <td>2.07</td>
      <td>1.17</td>
      <td>2.16</td>
      <td>2.16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3.00</td>
      <td>3.54</td>
      <td>0.29</td>
      <td>2.14</td>
      <td>1.07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>5.01</td>
      <td>5.01</td>
      <td>0.00</td>
      <td>-0.04</td>
      <td>-0.01</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>So <span class="math inline">\(\nabla \text{Loss}_{1:3}\)</span> is</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>nabla <span class="op">=</span> np.array([df[<span class="st">"dL/dw"</span>].mean(), df[<span class="st">"dL/db"</span>].mean()])</span>
<span id="cb16-2"><a href="#cb16-2"></a>nabla </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([1.42, 1.07])</code></pre>
</div>
</div>
<p>so with <span class="math inline">\(\eta = 0.1\)</span> then <span class="math inline">\(\boldsymbol{\theta}_2\)</span> becomes</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>theta_2 <span class="op">=</span> theta_1 <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> nabla</span>
<span id="cb18-2"><a href="#cb18-2"></a>theta_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>array([1.33, 0.49])</code></pre>
</div>
</div>
</section></section>
<section>
<section id="recurrent-neural-networks" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Recurrent Neural Networks</h1>

</section>
<section id="input-of-an-rnn" class="slide level2 smaller">
<h2>Input of an RNN</h2>
<ul>
<li>Recurrent neural network (RNN) is used to handle input data that occurs in one-dimensional sequence.
<ul>
<li>Natural language data such as sentences.</li>
<li>Price data such as financial time series, stock prices.</li>
<li>Temperature data.</li>
<li>Time-stamped medical events.</li>
<li>Weekly sales.</li>
<li>Hourly electricity consumption.</li>
<li>Human activity pattern.</li>
</ul></li>
<li>We talk about time steps when discussing RNN, but it can be any steps in a sequence of ordered data.</li>
</ul>
</section>
<section id="applications" class="slide level2 smaller">
<h2>Applications</h2>
<ul>
<li>Forecasting: revenue forecast, weather forecast, predict disease rate from medical history, etc.</li>
<li>Classification: given a time series of the activities of a visitor on a website, classify whether the visitor is a bot or a human.</li>
<li>Event detection: given a continuous data stream, identify the occurrence of a specific event. Example: Detect utterances like “Hey Alexa” from an audio stream.</li>
<li>Anomaly detection: given a continuous data stream, detect anything unusual happening. This is typically an unsupervised learning problem. Example: Detect unusual activity on the corporate network.</li>
</ul>
</section>
<section id="recurrent-neural-network" class="slide level2">
<h2>Recurrent neural network</h2>
<p>For a single neuron, output of a recurrent layer is:</p>
<p><span class="math display">\[
\mathbf{Y}_t = \psi\bigl( \mathbf{X}_t \mathbf{W}_x + \mathbf{Y}_{t-1} \mathbf{W}_y + \mathbf{b} \bigr) .
\]</span></p>
<p>Densely connected neural networks and convnet have no memory, which means each input is processed independently with no state (memory) kept between inputs. The recurrent neuron has a form of memory because the output at step <span class="math inline">\(t\)</span> depends on all the inputs from the previous steps. We call the part of a neural network that preserves some state across time steps a <em>memory cell</em> or a <em>cell</em>.</p>
</section>
<section id="recurrent-neural-network-1" class="slide level2 smaller">
<h2>Recurrent neural network</h2>
<p>Note: the same weights are shared across the time steps of the recurrent network. A lot of resource will be required if these parameters are not shared. This also allows generalization when the model is used on a sequence of arbitrary length.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Geron-recurrentneuronlayer-blur.png"></p>
<p></p><figcaption>One layer of recurrent neurons unrolled through time.</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Geron-recurrentneurondeep-blur.png"></p>
<p></p><figcaption><em>Deep RNN</em> unrolled through time.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Chapter 15 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="input-and-output-sequences" class="slide level2">
<h2>Input and output sequences</h2>

<img data-src="Geron-rnnType-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Categories of recurrent neural networks: sequence to sequence, sequence to vector, vector to sequence, encoder-decoder network.</p><div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Chapter 15 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="input-and-output-sequences-1" class="slide level2">
<h2>Input and output sequences</h2>
<ul>
<li>Sequence to sequence: Useful for predicting time series such as using prices over the last <span class="math inline">\(N\)</span> days to output the prices shifted one day into the future (i.e.&nbsp;from <span class="math inline">\(N-1\)</span> days ago to tomorrow.)</li>
<li>Sequence to vector: ignore all outputs in the previous time steps except for the last one. Example: give a sentiment score to a sequence of words corresponding to a movie review.</li>
</ul>
</section>
<section id="input-and-output-sequences-2" class="slide level2 smaller">
<h2>Input and output sequences</h2>
<ul>
<li>Vector to sequence: feed the network the same input vector over and over at each time step and let it output a sequence. Example: given that the input is an image, find a caption for it. The image is treated as an input vector (pixels in an image do not follow a sequence). The caption is a sequence of textual description of the image. A dataset containing images and their descriptions is the input of the RNN.</li>
<li>The Encoder-Decoder: The encoder is a sequence-to-vector network. The decoder is a vector-to-sequence network. Example: Feed the network a sequence in one language. Use the encoder to convert the sentence into a single vector representation. The decoder decodes this vector into the translation of the sentence in another language.</li>
</ul>
</section>
<section id="lstm-internals" class="slide level2">
<h2>LSTM internals</h2>
<p><img data-src="colah-LSTM3-chain.png" alt="Diagram of an LSTM cell."> <img data-src="colah-LSTM2-notation.png" alt="Notation for the diagram."></p>
<div class="footer">
<p>Source: Christopher Olah (2015), <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs">Understanding LSTM Networks</a>, Colah’s Blog.</p>
</div>
</section>
<section id="gru-internals" class="slide level2">
<h2>GRU internals</h2>

<img data-src="colah-LSTM3-var-GRU.png" class="r-stretch quarto-figure-center"><p class="caption">Diagram of a GRU cell.</p><p><br></p>
<div class="footer">
<p>Source: Christopher Olah (2015), <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs">Understanding LSTM Networks</a>, Colah’s Blog.</p>
</div>
</section></section>
<section>
<section id="images" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Images</h1>

</section>
<section id="shapes-of-photos" class="slide level2">
<h2>Shapes of photos</h2>

<img data-src="rgb-channels.png" class="r-stretch quarto-figure-center"><p class="caption">A photo is a rank 3 tensor.</p><div class="footer">
<p>Source: Kim et al (2021), <a href="https://www.mdpi.com/applsci/applsci-11-03418/article_deploy/html/images/applsci-11-03418-g001.png">Data Hiding Method for Color AMBTC Compressed Images Using Color Difference</a>, Applied Sciences.</p>
</div>
</section>
<section id="how-the-computer-sees-them" class="slide level2 smaller">
<h2>How the computer sees them</h2>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">from</span> matplotlib.image <span class="im">import</span> imread</span>
<span id="cb20-2"><a href="#cb20-2"></a>img1 <span class="op">=</span> imread(<span class="st">'pu.gif'</span>)<span class="op">;</span> img2 <span class="op">=</span> imread(<span class="st">'pl.gif'</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>img3 <span class="op">=</span> imread(<span class="st">'pr.gif'</span>)<span class="op">;</span> img4 <span class="op">=</span> imread(<span class="st">'pg.bmp'</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="bu">print</span>(<span class="ss">f"Shapes are: </span><span class="sc">{</span>img1<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img2<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img3<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img4<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="cell-output cell-output-stdout">
<pre><code>Shapes are: (16, 16, 3), (16, 16, 3), (16, 16, 3), (16, 16, 3).</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>img1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>img2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>img3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>img4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="how-we-see-them" class="slide level2">
<h2>How we see them</h2>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> imshow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>imshow(img1)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-27-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>imshow(img2)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-28-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>imshow(img3)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-29-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>imshow(img4)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-30-output-1.png"></p>
</div>
</div>
</div>
</div>
</section>
<section id="why-is-255-special" class="slide level2">
<h2>Why is 255 special?</h2>
<p>Each pixel’s colour intensity is stored in one byte.</p>
<p>One byte is 8 bits, so in binary that is 00000000 to 11111111.</p>
<p>The largest <em>unsigned</em> number this can be is <span class="math inline">\(2^8-1 = 255\)</span>.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>np.uint8(<span class="dv">0</span>), np.uint8(<span class="dv">1</span>), np.uint8(<span class="dv">255</span>), np.uint8(<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>(0, 1, 255, 0)</code></pre>
</div>
</div>
<p>If you had <em>signed</em> numbers, this would go from -128 to 127.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>np.int8(<span class="op">-</span><span class="dv">128</span>), np.int8(<span class="dv">0</span>), np.int8(<span class="dv">127</span>), np.int8(<span class="dv">128</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>(-128, 0, 127, -128)</code></pre>
</div>
</div>
<p>Alternatively, <em>hexidecimal</em> numbers are used. E.g. 10100001 is split into 1010 0001, and 1010=A, 0001=1, so combined it is 0xA1.</p>
</section>
<section id="image-editing-with-kernels" class="slide level2">
<h2>Image editing with kernels</h2>
<p>Take a look at <a href="https://setosa.io/ev/image-kernels/">https://setosa.io/ev/image-kernels/</a>.</p>

<img data-src="convolution.gif" class="r-stretch quarto-figure-center"><p class="caption">An example of an image kernel in action.</p><div class="footer">
<p>Source: <a href="http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution">Stanford’s deep learning tutorial</a> via <a href="https://stats.stackexchange.com/a/188216">Stack Exchange</a>.</p>
</div>
</section>
<section id="face-detection-visualised" class="slide level2">
<h2>Face detection visualised</h2>
<center>
<iframe src="https://player.vimeo.com/video/12774628?h=5f310c41f4" width="540" height="510" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<div class="footer">
<p>Source: Harvey (2010), <a href="https://vimeo.com/12774628"><em>OpenCV Face Detection: Visualized</em></a>, Vimeo.</p>
</div>
</section></section>
<section>
<section id="convolutional-layers" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Convolutional Layers</h1>

</section>
<section id="convolution-not-complicated" class="slide level2">
<h2>‘Convolution’ not ‘complicated’</h2>
<p><br></p>
<p>Say <span class="math inline">\(X_1, X_2 \sim f_X\)</span> are i.i.d., and we look at <span class="math inline">\(S = X_1 + X_2\)</span>.</p>
<p>The density for <span class="math inline">\(S\)</span> is then</p>
<p><span class="math display">\[
f_S(s) = \int_{x_1=-\infty}^{\infty} f_X(x_1) \, f_X(s-x_1) \,\mathrm{d}s .
\]</span></p>
<p>This is the <em>convolution</em> operation, <span class="math inline">\(f_S = f_X \star f_X\)</span>.</p>
</section>
<section id="tensor" class="slide level2 smaller">
<h2>Tensor</h2>
<ul>
<li>Images are 3D tensors with height, weight and number of channel.</li>
</ul>

<img data-src="Glassner/16-1.png" class="r-stretch quarto-figure-center"><p class="caption">Example of 3D Tensor.</p><ul>
<li>Slices through the channels are called elements. In RGB color images, elements are pixels.</li>
<li>Grayscale image has 1 channel. Color image has 3 channels. Each pixel of a color image contains value for: red, green and blue (RGB color). Example: if RGB values are between 0 and 1, a yellow pixel has red and green values of 1 and blue value of 0.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow" class="slide level2">
<h2>Example: Detecting yellow</h2>
<ul>
<li>To detect yellow color in a color image, apply a neuron to each pixel in the image.</li>
</ul>

<img data-src="Glassner/16-3.png" class="r-stretch quarto-figure-center"><p class="caption">Applying a neuron to an image pixel.</p><ul>
<li>If red/green value decreases or blue value increases, the pixel color shifts away from yellow. So we can set the weights of the neuron to be 1, 1 and -1.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="filter" class="slide level2 smaller">
<h2>Filter</h2>
<ul>
<li>The output is produced by <em>sweeping</em> the neuron over the input, or <em>scanning</em> the input. This is called <strong>convolution</strong>.</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-4.png"></p>
<p></p><figcaption>Scan the 3-channel input (color image) with the neuron to produce a 1-channel output (grayscale image).</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-5.png"></p>
<p></p><figcaption>The more yellow the pixel in the color image (left), the more white it is in the grayscale image.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>The neuron or its weights is called a <strong>filter</strong>. We <em>convolve</em> the image with a filter, so the filter is a <strong>convolutional filter</strong>.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="weight-sharing" class="slide level2">
<h2>Weight sharing</h2>
<ul>
<li>The same neuron is used to sweep over the image, so we can store the weights in some shared memory and process the pixels in parallel.</li>
<li>We say that the neurons are <em>weight sharing</em>.</li>
</ul>
</section>
<section id="filter-input" class="slide level2">
<h2>Filter input</h2>
<ul>
<li>In the previous example, the neuron only takes one pixel as input.</li>
<li>Usually a larger filter containing a <em>block of weights</em> is used to process not only a pixel but also its neighboring pixels all at once.</li>
<li>The weights are called the filter <strong>kernels</strong>.</li>
<li>The cluster of pixels that forms the input of a filter is called its <em>footprint</em>.</li>
</ul>
</section>
<section id="spatial-filter" class="slide level2">
<h2>Spatial filter</h2>

<img data-src="Glassner/16-9.png" class="r-stretch quarto-figure-center"><p class="caption">Example: a 3x3 filter</p><ul>
<li>Each pixel is multiplied by its corresponding weight, results are summed up and run through an activation function to obtain one <em>single</em> output value.</li>
<li>When a filter’s footprint is more than one pixel, it is called a <strong>spatial filter</strong>.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="multidimensional-convolution" class="slide level2">
<h2>Multidimensional convolution</h2>
<p>To process an input with multiple channels (ex: a color image), the (spatial) filter also need to have the same number of channels.</p>

<img data-src="Glassner/16-18.png" class="r-stretch quarto-figure-center"><p class="caption">Example: a 3x3 filter with 3 channels, containing 27 weights.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example" class="slide level2 smaller">
<h2>Example</h2>
<ul>
<li>Input is a 3x3 footprint with 3 channels (pixels of a color image).</li>
<li>Each channel of the filter is applied to each channel of the footprint.</li>
<li>One single output is produced for each channel.</li>
<li>Sum them up and run through an activation function. Final output is a single grayscale image pixel.</li>
</ul>

<img data-src="Glassner/16-19.png" class="r-stretch quarto-figure-center"><p class="caption">Example of channels applied separately.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="input-output-relationship" class="slide level2">
<h2>Input-output relationship</h2>

<img data-src="Glassner/16-10.png" class="r-stretch quarto-figure-center"><p class="caption">Matching the original image footprints against the output location.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section></section>
<section>
<section id="convolutional-layer-options" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Convolutional Layer Options</h1>

</section>
<section id="padding" class="slide level2">
<h2>Padding</h2>

<img data-src="Glassner/16-15.png" class="r-stretch quarto-figure-center"><p class="caption">What happens when filters go off the edge of the input?</p><ul>
<li>How to avoid the filter’s receptive field falling off the side of the input.</li>
<li>If we only scan the filter over places of the input where the filter can fit perfectly, it will lead to loss of information, especially after many filters.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="padding-1" class="slide level2">
<h2>Padding</h2>
<p>Add a border of extra elements around the input, called <strong>padding</strong>. Normally we place zeros in all the new elements, called <strong>zero padding</strong>.</p>

<img data-src="Glassner/16-17.png" class="r-stretch quarto-figure-center"><p class="caption">Padded values can be added to the outside of the input.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="convolution-layer" class="slide level2">
<h2>Convolution layer</h2>
<ul>
<li>Multiple filters are bundled together in one layer (of the CNN).</li>
<li>The filters are applied <em>simultaneously</em> and <em>independently</em> to the input.</li>
<li>Filters can have different footprints, but in practice we almost always use the same footprint for every filter in a convolution layer.</li>
<li>Number of channels in the output will be the same as the number of filters (like in the previous example, 3-channel color image turns into 1-channel grayscale image when only 1 filter is applied).</li>
</ul>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<div class="columns">
<div class="column">
<p>In the image:</p>
<ul>
<li>6-channel input tensor</li>
<li>input pixels</li>
<li>four 3x3 filters</li>
<li>four output tensors</li>
<li>final output tensor.</li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-21.png"></p>
<p></p><figcaption>Example network highlighting that the number of output channels equals the number of filters.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="x1-convolution-and-feature-reduction" class="slide level2">
<h2>1x1 convolution and feature reduction</h2>
<ul>
<li>Feature reduction: Reduce the number of channels in the input tensor (removing correlated features) by using fewer filters than the number of channels in the input. This is because the number of channels in the output is always the same as number of filters.</li>
<li>1x1 convolution: Convolution using 1x1 filters.</li>
<li>When the channels are correlated, 1x1 convolution is very effective at reducing channels without loss of information.</li>
</ul>
</section>
<section id="example-of-1x1-convolution" class="slide level2 smaller">
<h2>Example of 1x1 convolution</h2>

<img data-src="Glassner/16-23.png" class="r-stretch quarto-figure-center"><p class="caption">Example network with 1x1 convolution.</p><ul>
<li>Input tensor contains 300 channels.</li>
<li>Use 175 1x1 filters in the convolution layer (each filter obviously has 300 channels, same number as the input).</li>
<li>Each filter produces a 1-channel output.</li>
<li>Final output tensor has 175 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="thought-experiment-1x1-use-case" class="slide level2">
<h2>Thought experiment / 1x1 use case</h2>
<ul>
<li>A classifier is created to identify the presence of “eyes” in a photograph.</li>
<li>A convolution layer containing 12 different filters are used to detect different kinds of eyes in the input: human eyes, cat eye, fish eyes, and so on.</li>
<li>But we only need to detect “eyes”, regardless of the species. Only need 1 channel representing whether or not an eye is found.</li>
<li>We add another convolution layer containing 1 filter, then 12 channels will reduce to 1 channel.</li>
</ul>
</section>
<section id="training-cnns" class="slide level2">
<h2>Training CNNs</h2>
<ul>
<li>To train the network, we need to specify:
<ul>
<li>number of filters,</li>
<li>their footprints,</li>
<li>activation functions,</li>
<li>padding.</li>
</ul></li>
<li>The filter weights are learned by the network (backprop).</li>
</ul>
</section></section>
<section>
<section id="convolutional-neural-networks" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Convolutional Neural Networks</h1>

</section>
<section id="definition-of-cnn" class="slide level2">
<h2>Definition of CNN</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><br> <br></p>
<p>A neural network that uses <em>convolution layers</em> is called a <em>convolutional neural network</em>.</p>
</div><div class="column" style="width:40%;">
<p><img data-src="xkcd-trained_a_neural_net_2x.png"></p>
</div>
</div>
<div class="footer">
<p>Source: Randall Munroe (2019), <a href="https://xkcd.com/2173/">xkcd #2173: Trained a Neural Net</a>.</p>
</div>
</section>
<section id="architecture" class="slide level2">
<h2>Architecture</h2>
<p><br> <br></p>

<img data-src="Geron-mls2_1411-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Typical CNN architecture.</p><div class="footer">
<p>Source: Aurélien Géron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-11 (<strong>redacted</strong>).</p>
</div>
</section>
<section id="architecture-2" class="slide level2">
<h2>Architecture #2</h2>

<img data-src="mathworks-typical-cnn.svg" class="r-stretch"><div class="footer">
<p>Source: MathWorks, <a href="https://au.mathworks.com/campaigns/offers/next/deep-learning-ebook.html"><em>Introducing Deep Learning with MATLAB</em></a>, Ebook.</p>
</div>
</section>
<section id="pooling" class="slide level2">
<h2>Pooling</h2>
<p><strong>Pooling</strong>, or <strong>downsampling</strong>, is a technique to blur a tensor.</p>

<img data-src="Glassner/16-27.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of pool operations.</p><p>(a): Input tensor<br> (b): Subdivide input tensor into 2x2 blocks<br> (c): Average pooling<br> (d): Max pooling<br> (e): Icon for a pooling layer<br></p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="pooling-for-multiple-channels" class="slide level2 smaller">
<h2>Pooling for multiple channels</h2>

<img data-src="Glassner/16-28.png" class="r-stretch quarto-figure-center"><p class="caption">Pooling a multichannel input.</p><ul>
<li>Input tensor: 6x6 with 1 channel, zero padding.</li>
<li>Convolution layer: Three 3x3 filters.</li>
<li>Convolution layer output: 6x6 with 3 channels.</li>
<li>Pooling layer: apply max pooling to each channel.</li>
<li>Pooling layer output: 3x3, 3 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="whywhy-not-use-pooling" class="slide level2">
<h2>Why/why not use pooling?</h2>
<p><strong>Why?</strong> Pooling <em>reduces the size</em> of tensors, therefore reduces memory usage and execution time (recall that 1x1 convolution <em>reduces the number of channels</em> in a tensor).</p>
<p><strong>Why not?</strong></p>
<center>
<iframe id="reddit-embed" src="https://www.redditmedia.com/r/MachineLearning/comments/2lmo0l/ama_geoffrey_hinton/clyj4jv/?depth=1&amp;showmore=false&amp;embed=true&amp;showmedia=false" sandbox="allow-scripts allow-same-origin allow-popups" style="border: none;" height="481" width="640" scrolling="no">
</iframe>
</center>
<div class="footer">
<p>Source: Hinton, <a href="https://www.reddit.com/r/MachineLearning/comments/2lmo0l/comment/clyj4jv/?utm_source=share&amp;utm_medium=web2x&amp;context=3">Reddit AMA</a>.</p>
</div>
</section>
<section id="striding" class="slide level2">
<h2>Striding</h2>
<p>When a filter scans the input, instead of making it sweep the input step by step, make it take strides larger than 1 step at a time.</p>

<img data-src="Glassner/16-29.png" class="r-stretch quarto-figure-center"><p class="caption">Example: Use a stride of three horizontally and two vertically.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="choosing-strides" class="slide level2 smaller">
<h2>Choosing strides</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-31.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-32.png"></p>
</div>
</div>
</div>
<ul>
<li>When a filter scans the input step by step, it processes the same input elements multiple times. Even with larger strides, this can still happen (left image).</li>
<li><strong>If</strong> we want to save time, we can choose strides that prevents input elements from being used more than once. Example (right image): 3x3 filter, stride 3 in both directions.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="why-striding" class="slide level2">
<h2>Why striding</h2>
<ul>
<li>Normally the same stride is used for both axes.</li>
<li>Suppose stride is 2 for both axes: output has the same dimension as the output of <em>normal</em> sweeping (striding by 1) and then pooling with 2x2 blocks.</li>
<li>Striding is almost as if pooling is bundled into the convolution process. Striding is faster because we evaluate the filter fewer times.</li>
</ul>
</section>
<section id="why-striding-1" class="slide level2">
<h2>Why striding</h2>
<ul>
<li>While two procedures result in different tensors, in practice striding proves to be as useful as convolution + pooling but much faster. However, depending on the dataset and architecture, sometimes convolution followed by pooling works better.</li>
<li>Striding also reduces the size of the tensor like pooling, so it has the same benefit of reducing memory requirement and execution time.</li>
<li>We can’t take a trained network and replace pairs of convolution and pooling with strided convolution (or vice versa). We have to retrain the network.</li>
</ul>
</section></section>
<section>
<section id="demo-character-recognition" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Demo: Character Recognition</h1>

</section>
<section id="mnist-dataset" class="slide level2">
<h2>MNIST Dataset</h2>

<img data-src="wiki-MnistExamples.png" class="r-stretch quarto-figure-center"><p class="caption">The MNIST dataset.</p><div class="footer">
<p>Source: Wikipedia, <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST database</a>.</p>
</div>
</section>
<section id="psam-dataset" class="slide level2">
<h2>PSAM Dataset</h2>
<p>57 poorly written Mandarin characters (<span class="math inline">\(57 \times 7 = 399\)</span>).</p>

<img data-src="mandarin-practice-notebook3.png" class="r-stretch quarto-figure-center"><p class="caption">The <em>Pat Sucks At Mandarin (PSAM)</em> dataset.</p></section>
<section id="downloading-the-dataset" class="slide level2">
<h2>Downloading the dataset</h2>
<p>The data is zipped (6.9 MB) and stored on my GitHub homepage.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Download the dataset if it hasn't already been downloaded.</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="cf">if</span> <span class="kw">not</span> Path(<span class="st">"mandarin"</span>).exists():</span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="bu">print</span>(<span class="st">"Downloading dataset..."</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a>  <span class="op">!</span>wget https:<span class="op">//</span>pat<span class="op">-</span>laub.github.io<span class="op">/</span>data<span class="op">/</span>mandarin.<span class="bu">zip</span></span>
<span id="cb39-6"><a href="#cb39-6"></a>  <span class="op">!</span>unzip mandarin.<span class="bu">zip</span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="cf">else</span>:</span>
<span id="cb39-8"><a href="#cb39-8"></a>  <span class="bu">print</span>(<span class="st">"Already downloaded."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Already downloaded.</code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Remember, the Jupyter notebook associated with your final report should either download your dataset when it is run, or you should supply the data separately.</p>
</div>
</div>
</div>
</section>
<section id="directory-structure" class="slide level2">
<h2>Directory structure</h2>
<div class="columns">
<div class="column">
<p>Inspect the directory structure using the <code>tree</code> command-line tool.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="op">!</span>tree mandarin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin
├── bai
│&nbsp;&nbsp; ├── bai-1.png
│&nbsp;&nbsp; ├── bai-2.png
│&nbsp;&nbsp; ├── bai-3.png
│&nbsp;&nbsp; ├── bai-4.png
│&nbsp;&nbsp; ├── bai-5.png
│&nbsp;&nbsp; ├── bai-6.png
│&nbsp;&nbsp; └── bai-7.png
├── ben
│&nbsp;&nbsp; ├── ben-1.png
│&nbsp;&nbsp; ├── ben-2.png
│&nbsp;&nbsp; ├── ben-3.png
│&nbsp;&nbsp; ├── ben-4.png
│&nbsp;&nbsp; ├── ben-5.png
│&nbsp;&nbsp; ├── ben-6.png
│&nbsp;&nbsp; └── ben-7.png
├── chong
│&nbsp;&nbsp; ├── chong-1.png
│&nbsp;&nbsp; ├── chong-2.png
│&nbsp;&nbsp; ├── chong-3.png
│&nbsp;&nbsp; ├── chong-4.png
│&nbsp;&nbsp; ├── chong-5.png
│&nbsp;&nbsp; ├── chong-6.png
│&nbsp;&nbsp; └── chong-7.png
├── chu
│&nbsp;&nbsp; ├── chu-1.png
│&nbsp;&nbsp; ├── chu-2.png
│&nbsp;&nbsp; ├── chu-3.png
│&nbsp;&nbsp; ├── chu-4.png
│&nbsp;&nbsp; ├── chu-5.png
│&nbsp;&nbsp; ├── chu-6.png
│&nbsp;&nbsp; └── chu-7.png
├── chuan
│&nbsp;&nbsp; ├── chuan-1.png
│&nbsp;&nbsp; ├── chuan-2.png
│&nbsp;&nbsp; ├── chuan-3.png
│&nbsp;&nbsp; ├── chuan-4.png
│&nbsp;&nbsp; ├── chuan-5.png
│&nbsp;&nbsp; ├── chuan-6.png
│&nbsp;&nbsp; └── chuan-7.png
├── cong
│&nbsp;&nbsp; ├── cong-1.png
│&nbsp;&nbsp; ├── cong-2.png
│&nbsp;&nbsp; ├── cong-3.png
│&nbsp;&nbsp; ├── cong-4.png
│&nbsp;&nbsp; ├── cong-5.png
│&nbsp;&nbsp; ├── cong-6.png
│&nbsp;&nbsp; └── cong-7.png
├── da
│&nbsp;&nbsp; ├── da-1.png
│&nbsp;&nbsp; ├── da-2.png
│&nbsp;&nbsp; ├── da-3.png
│&nbsp;&nbsp; ├── da-4.png
│&nbsp;&nbsp; ├── da-5.png
│&nbsp;&nbsp; ├── da-6.png
│&nbsp;&nbsp; └── da-7.png
├── dan
│&nbsp;&nbsp; ├── dan-1.png
│&nbsp;&nbsp; ├── dan-2.png
│&nbsp;&nbsp; ├── dan-3.png
│&nbsp;&nbsp; ├── dan-4.png
│&nbsp;&nbsp; ├── dan-5.png
│&nbsp;&nbsp; ├── dan-6.png
│&nbsp;&nbsp; └── dan-7.png
├── dong
│&nbsp;&nbsp; ├── dong-1.png
│&nbsp;&nbsp; ├── dong-2.png
│&nbsp;&nbsp; ├── dong-3.png
│&nbsp;&nbsp; ├── dong-4.png
│&nbsp;&nbsp; ├── dong-5.png
│&nbsp;&nbsp; ├── dong-6.png
│&nbsp;&nbsp; └── dong-7.png
├── fei
│&nbsp;&nbsp; ├── fei-1.png
│&nbsp;&nbsp; ├── fei-2.png
│&nbsp;&nbsp; ├── fei-3.png
│&nbsp;&nbsp; ├── fei-4.png
│&nbsp;&nbsp; ├── fei-5.png
│&nbsp;&nbsp; ├── fei-6.png
│&nbsp;&nbsp; └── fei-7.png
├── fu
│&nbsp;&nbsp; ├── fu-1.png
│&nbsp;&nbsp; ├── fu-2.png
│&nbsp;&nbsp; ├── fu-3.png
│&nbsp;&nbsp; ├── fu-4.png
│&nbsp;&nbsp; ├── fu-5.png
│&nbsp;&nbsp; ├── fu-6.png
│&nbsp;&nbsp; └── fu-7.png
├── fu2
│&nbsp;&nbsp; ├── fu2-1.png
│&nbsp;&nbsp; ├── fu2-2.png
│&nbsp;&nbsp; ├── fu2-3.png
│&nbsp;&nbsp; ├── fu2-4.png
│&nbsp;&nbsp; ├── fu2-5.png
│&nbsp;&nbsp; ├── fu2-6.png
│&nbsp;&nbsp; └── fu2-7.png
├── gao
│&nbsp;&nbsp; ├── gao-1.png
│&nbsp;&nbsp; ├── gao-2.png
│&nbsp;&nbsp; ├── gao-3.png
│&nbsp;&nbsp; ├── gao-4.png
│&nbsp;&nbsp; ├── gao-5.png
│&nbsp;&nbsp; ├── gao-6.png
│&nbsp;&nbsp; └── gao-7.png
├── gong
│&nbsp;&nbsp; ├── gong-1.png
│&nbsp;&nbsp; ├── gong-2.png
│&nbsp;&nbsp; ├── gong-3.png
│&nbsp;&nbsp; ├── gong-4.png
│&nbsp;&nbsp; ├── gong-5.png
│&nbsp;&nbsp; ├── gong-6.png
│&nbsp;&nbsp; └── gong-7.png
├── guo
│&nbsp;&nbsp; ├── guo-1.png
│&nbsp;&nbsp; ├── guo-2.png
│&nbsp;&nbsp; ├── guo-3.png
│&nbsp;&nbsp; ├── guo-4.png
│&nbsp;&nbsp; ├── guo-5.png
│&nbsp;&nbsp; ├── guo-6.png
│&nbsp;&nbsp; └── guo-7.png
├── hu
│&nbsp;&nbsp; ├── hu-1.png
│&nbsp;&nbsp; ├── hu-2.png
│&nbsp;&nbsp; ├── hu-3.png
│&nbsp;&nbsp; ├── hu-4.png
│&nbsp;&nbsp; ├── hu-5.png
│&nbsp;&nbsp; ├── hu-6.png
│&nbsp;&nbsp; └── hu-7.png
├── huo
│&nbsp;&nbsp; ├── huo-1.png
│&nbsp;&nbsp; ├── huo-2.png
│&nbsp;&nbsp; ├── huo-3.png
│&nbsp;&nbsp; ├── huo-4.png
│&nbsp;&nbsp; ├── huo-5.png
│&nbsp;&nbsp; ├── huo-6.png
│&nbsp;&nbsp; └── huo-7.png
├── kou
│&nbsp;&nbsp; ├── kou-1.png
│&nbsp;&nbsp; ├── kou-2.png
│&nbsp;&nbsp; ├── kou-3.png
│&nbsp;&nbsp; ├── kou-4.png
│&nbsp;&nbsp; ├── kou-5.png
│&nbsp;&nbsp; ├── kou-6.png
│&nbsp;&nbsp; └── kou-7.png
├── ku
│&nbsp;&nbsp; ├── ku-1.png
│&nbsp;&nbsp; ├── ku-2.png
│&nbsp;&nbsp; ├── ku-3.png
│&nbsp;&nbsp; ├── ku-4.png
│&nbsp;&nbsp; ├── ku-5.png
│&nbsp;&nbsp; ├── ku-6.png
│&nbsp;&nbsp; └── ku-7.png
├── lin
│&nbsp;&nbsp; ├── lin-1.png
│&nbsp;&nbsp; ├── lin-2.png
│&nbsp;&nbsp; ├── lin-3.png
│&nbsp;&nbsp; ├── lin-4.png
│&nbsp;&nbsp; ├── lin-5.png
│&nbsp;&nbsp; ├── lin-6.png
│&nbsp;&nbsp; └── lin-7.png
├── ma
│&nbsp;&nbsp; ├── ma-1.png
│&nbsp;&nbsp; ├── ma-2.png
│&nbsp;&nbsp; ├── ma-3.png
│&nbsp;&nbsp; ├── ma-4.png
│&nbsp;&nbsp; ├── ma-5.png
│&nbsp;&nbsp; ├── ma-6.png
│&nbsp;&nbsp; └── ma-7.png
├── ma2
│&nbsp;&nbsp; ├── ma2-1.png
│&nbsp;&nbsp; ├── ma2-2.png
│&nbsp;&nbsp; ├── ma2-3.png
│&nbsp;&nbsp; ├── ma2-4.png
│&nbsp;&nbsp; ├── ma2-5.png
│&nbsp;&nbsp; ├── ma2-6.png
│&nbsp;&nbsp; └── ma2-7.png
├── ma3
│&nbsp;&nbsp; ├── ma3-1.png
│&nbsp;&nbsp; ├── ma3-2.png
│&nbsp;&nbsp; ├── ma3-3.png
│&nbsp;&nbsp; ├── ma3-4.png
│&nbsp;&nbsp; ├── ma3-5.png
│&nbsp;&nbsp; ├── ma3-6.png
│&nbsp;&nbsp; └── ma3-7.png
├── mei
│&nbsp;&nbsp; ├── mei-1.png
│&nbsp;&nbsp; ├── mei-2.png
│&nbsp;&nbsp; ├── mei-3.png
│&nbsp;&nbsp; ├── mei-4.png
│&nbsp;&nbsp; ├── mei-5.png
│&nbsp;&nbsp; ├── mei-6.png
│&nbsp;&nbsp; └── mei-7.png
├── men
│&nbsp;&nbsp; ├── men-1.png
│&nbsp;&nbsp; ├── men-2.png
│&nbsp;&nbsp; ├── men-3.png
│&nbsp;&nbsp; ├── men-4.png
│&nbsp;&nbsp; ├── men-5.png
│&nbsp;&nbsp; ├── men-6.png
│&nbsp;&nbsp; └── men-7.png
├── ming
│&nbsp;&nbsp; ├── ming-1.png
│&nbsp;&nbsp; ├── ming-2.png
│&nbsp;&nbsp; ├── ming-3.png
│&nbsp;&nbsp; ├── ming-4.png
│&nbsp;&nbsp; ├── ming-5.png
│&nbsp;&nbsp; ├── ming-6.png
│&nbsp;&nbsp; └── ming-7.png
├── mu
│&nbsp;&nbsp; ├── mu-1.png
│&nbsp;&nbsp; ├── mu-2.png
│&nbsp;&nbsp; ├── mu-3.png
│&nbsp;&nbsp; ├── mu-4.png
│&nbsp;&nbsp; ├── mu-5.png
│&nbsp;&nbsp; ├── mu-6.png
│&nbsp;&nbsp; └── mu-7.png
├── nan
│&nbsp;&nbsp; ├── nan-1.png
│&nbsp;&nbsp; ├── nan-2.png
│&nbsp;&nbsp; ├── nan-3.png
│&nbsp;&nbsp; ├── nan-4.png
│&nbsp;&nbsp; ├── nan-5.png
│&nbsp;&nbsp; ├── nan-6.png
│&nbsp;&nbsp; └── nan-7.png
├── niao
│&nbsp;&nbsp; ├── niao-1.png
│&nbsp;&nbsp; ├── niao-2.png
│&nbsp;&nbsp; ├── niao-3.png
│&nbsp;&nbsp; ├── niao-4.png
│&nbsp;&nbsp; ├── niao-5.png
│&nbsp;&nbsp; ├── niao-6.png
│&nbsp;&nbsp; └── niao-7.png
├── niu
│&nbsp;&nbsp; ├── niu-1.png
│&nbsp;&nbsp; ├── niu-2.png
│&nbsp;&nbsp; ├── niu-3.png
│&nbsp;&nbsp; ├── niu-4.png
│&nbsp;&nbsp; ├── niu-5.png
│&nbsp;&nbsp; ├── niu-6.png
│&nbsp;&nbsp; └── niu-7.png
├── nu
│&nbsp;&nbsp; ├── nu-1.png
│&nbsp;&nbsp; ├── nu-2.png
│&nbsp;&nbsp; ├── nu-3.png
│&nbsp;&nbsp; ├── nu-4.png
│&nbsp;&nbsp; ├── nu-5.png
│&nbsp;&nbsp; ├── nu-6.png
│&nbsp;&nbsp; └── nu-7.png
├── nuan
│&nbsp;&nbsp; ├── nuan-1.png
│&nbsp;&nbsp; ├── nuan-2.png
│&nbsp;&nbsp; ├── nuan-3.png
│&nbsp;&nbsp; ├── nuan-4.png
│&nbsp;&nbsp; ├── nuan-5.png
│&nbsp;&nbsp; ├── nuan-6.png
│&nbsp;&nbsp; └── nuan-7.png
├── peng
│&nbsp;&nbsp; ├── peng-1.png
│&nbsp;&nbsp; ├── peng-2.png
│&nbsp;&nbsp; ├── peng-3.png
│&nbsp;&nbsp; ├── peng-4.png
│&nbsp;&nbsp; ├── peng-5.png
│&nbsp;&nbsp; ├── peng-6.png
│&nbsp;&nbsp; └── peng-7.png
├── quan
│&nbsp;&nbsp; ├── quan-1.png
│&nbsp;&nbsp; ├── quan-2.png
│&nbsp;&nbsp; ├── quan-3.png
│&nbsp;&nbsp; ├── quan-4.png
│&nbsp;&nbsp; ├── quan-5.png
│&nbsp;&nbsp; ├── quan-6.png
│&nbsp;&nbsp; └── quan-7.png
├── ren
│&nbsp;&nbsp; ├── ren-1.png
│&nbsp;&nbsp; ├── ren-2.png
│&nbsp;&nbsp; ├── ren-3.png
│&nbsp;&nbsp; ├── ren-4.png
│&nbsp;&nbsp; ├── ren-5.png
│&nbsp;&nbsp; ├── ren-6.png
│&nbsp;&nbsp; └── ren-7.png
├── ri
│&nbsp;&nbsp; ├── ri-1.png
│&nbsp;&nbsp; ├── ri-2.png
│&nbsp;&nbsp; ├── ri-3.png
│&nbsp;&nbsp; ├── ri-4.png
│&nbsp;&nbsp; ├── ri-5.png
│&nbsp;&nbsp; ├── ri-6.png
│&nbsp;&nbsp; └── ri-7.png
├── rou
│&nbsp;&nbsp; ├── rou-1.png
│&nbsp;&nbsp; ├── rou-2.png
│&nbsp;&nbsp; ├── rou-3.png
│&nbsp;&nbsp; ├── rou-4.png
│&nbsp;&nbsp; ├── rou-5.png
│&nbsp;&nbsp; ├── rou-6.png
│&nbsp;&nbsp; └── rou-7.png
├── sen
│&nbsp;&nbsp; ├── sen-1.png
│&nbsp;&nbsp; ├── sen-2.png
│&nbsp;&nbsp; ├── sen-3.png
│&nbsp;&nbsp; ├── sen-4.png
│&nbsp;&nbsp; ├── sen-5.png
│&nbsp;&nbsp; ├── sen-6.png
│&nbsp;&nbsp; └── sen-7.png
├── shan
│&nbsp;&nbsp; ├── shan-1.png
│&nbsp;&nbsp; ├── shan-2.png
│&nbsp;&nbsp; ├── shan-3.png
│&nbsp;&nbsp; ├── shan-4.png
│&nbsp;&nbsp; ├── shan-5.png
│&nbsp;&nbsp; ├── shan-6.png
│&nbsp;&nbsp; └── shan-7.png
├── shan2
│&nbsp;&nbsp; ├── shan2-1.png
│&nbsp;&nbsp; ├── shan2-2.png
│&nbsp;&nbsp; ├── shan2-3.png
│&nbsp;&nbsp; ├── shan2-4.png
│&nbsp;&nbsp; ├── shan2-5.png
│&nbsp;&nbsp; ├── shan2-6.png
│&nbsp;&nbsp; └── shan2-7.png
├── shui
│&nbsp;&nbsp; ├── shui-1.png
│&nbsp;&nbsp; ├── shui-2.png
│&nbsp;&nbsp; ├── shui-3.png
│&nbsp;&nbsp; ├── shui-4.png
│&nbsp;&nbsp; ├── shui-5.png
│&nbsp;&nbsp; ├── shui-6.png
│&nbsp;&nbsp; └── shui-7.png
├── tai
│&nbsp;&nbsp; ├── tai-1.png
│&nbsp;&nbsp; ├── tai-2.png
│&nbsp;&nbsp; ├── tai-3.png
│&nbsp;&nbsp; ├── tai-4.png
│&nbsp;&nbsp; ├── tai-5.png
│&nbsp;&nbsp; ├── tai-6.png
│&nbsp;&nbsp; └── tai-7.png
├── tian
│&nbsp;&nbsp; ├── tian-1.png
│&nbsp;&nbsp; ├── tian-2.png
│&nbsp;&nbsp; ├── tian-3.png
│&nbsp;&nbsp; ├── tian-4.png
│&nbsp;&nbsp; ├── tian-5.png
│&nbsp;&nbsp; ├── tian-6.png
│&nbsp;&nbsp; └── tian-7.png
├── wang
│&nbsp;&nbsp; ├── wang-1.png
│&nbsp;&nbsp; ├── wang-2.png
│&nbsp;&nbsp; ├── wang-3.png
│&nbsp;&nbsp; ├── wang-4.png
│&nbsp;&nbsp; ├── wang-5.png
│&nbsp;&nbsp; ├── wang-6.png
│&nbsp;&nbsp; └── wang-7.png
├── wen
│&nbsp;&nbsp; ├── wen-1.png
│&nbsp;&nbsp; ├── wen-2.png
│&nbsp;&nbsp; ├── wen-3.png
│&nbsp;&nbsp; ├── wen-4.png
│&nbsp;&nbsp; ├── wen-5.png
│&nbsp;&nbsp; ├── wen-6.png
│&nbsp;&nbsp; └── wen-7.png
├── xian
│&nbsp;&nbsp; ├── xian-1.png
│&nbsp;&nbsp; ├── xian-2.png
│&nbsp;&nbsp; ├── xian-3.png
│&nbsp;&nbsp; ├── xian-4.png
│&nbsp;&nbsp; ├── xian-5.png
│&nbsp;&nbsp; ├── xian-6.png
│&nbsp;&nbsp; └── xian-7.png
├── xuan
│&nbsp;&nbsp; ├── xuan-1.png
│&nbsp;&nbsp; ├── xuan-2.png
│&nbsp;&nbsp; ├── xuan-3.png
│&nbsp;&nbsp; ├── xuan-4.png
│&nbsp;&nbsp; ├── xuan-5.png
│&nbsp;&nbsp; ├── xuan-6.png
│&nbsp;&nbsp; └── xuan-7.png
├── yan
│&nbsp;&nbsp; ├── yan-1.png
│&nbsp;&nbsp; ├── yan-2.png
│&nbsp;&nbsp; ├── yan-3.png
│&nbsp;&nbsp; ├── yan-4.png
│&nbsp;&nbsp; ├── yan-5.png
│&nbsp;&nbsp; ├── yan-6.png
│&nbsp;&nbsp; └── yan-7.png
├── yang
│&nbsp;&nbsp; ├── yang-1.png
│&nbsp;&nbsp; ├── yang-2.png
│&nbsp;&nbsp; ├── yang-3.png
│&nbsp;&nbsp; ├── yang-4.png
│&nbsp;&nbsp; ├── yang-5.png
│&nbsp;&nbsp; ├── yang-6.png
│&nbsp;&nbsp; └── yang-7.png
├── yin
│&nbsp;&nbsp; ├── yin-1.png
│&nbsp;&nbsp; ├── yin-2.png
│&nbsp;&nbsp; ├── yin-3.png
│&nbsp;&nbsp; ├── yin-4.png
│&nbsp;&nbsp; ├── yin-5.png
│&nbsp;&nbsp; ├── yin-6.png
│&nbsp;&nbsp; └── yin-7.png
├── yu
│&nbsp;&nbsp; ├── yu-1.png
│&nbsp;&nbsp; ├── yu-2.png
│&nbsp;&nbsp; ├── yu-3.png
│&nbsp;&nbsp; ├── yu-4.png
│&nbsp;&nbsp; ├── yu-5.png
│&nbsp;&nbsp; ├── yu-6.png
│&nbsp;&nbsp; └── yu-7.png
├── yu2
│&nbsp;&nbsp; ├── yu2-1.png
│&nbsp;&nbsp; ├── yu2-2.png
│&nbsp;&nbsp; ├── yu2-3.png
│&nbsp;&nbsp; ├── yu2-4.png
│&nbsp;&nbsp; ├── yu2-5.png
│&nbsp;&nbsp; ├── yu2-6.png
│&nbsp;&nbsp; └── yu2-7.png
├── yue
│&nbsp;&nbsp; ├── yue-1.png
│&nbsp;&nbsp; ├── yue-2.png
│&nbsp;&nbsp; ├── yue-3.png
│&nbsp;&nbsp; ├── yue-4.png
│&nbsp;&nbsp; ├── yue-5.png
│&nbsp;&nbsp; ├── yue-6.png
│&nbsp;&nbsp; └── yue-7.png
├── zhong
│&nbsp;&nbsp; ├── zhong-1.png
│&nbsp;&nbsp; ├── zhong-2.png
│&nbsp;&nbsp; ├── zhong-3.png
│&nbsp;&nbsp; ├── zhong-4.png
│&nbsp;&nbsp; ├── zhong-5.png
│&nbsp;&nbsp; ├── zhong-6.png
│&nbsp;&nbsp; └── zhong-7.png
├── zhu
│&nbsp;&nbsp; ├── zhu-1.png
│&nbsp;&nbsp; ├── zhu-2.png
│&nbsp;&nbsp; ├── zhu-3.png
│&nbsp;&nbsp; ├── zhu-4.png
│&nbsp;&nbsp; ├── zhu-5.png
│&nbsp;&nbsp; ├── zhu-6.png
│&nbsp;&nbsp; └── zhu-7.png
├── zhu2
│&nbsp;&nbsp; ├── zhu2-1.png
│&nbsp;&nbsp; ├── zhu2-2.png
│&nbsp;&nbsp; ├── zhu2-3.png
│&nbsp;&nbsp; ├── zhu2-4.png
│&nbsp;&nbsp; ├── zhu2-5.png
│&nbsp;&nbsp; ├── zhu2-6.png
│&nbsp;&nbsp; └── zhu2-7.png
└── zhuo
    ├── zhuo-1.png
    ├── zhuo-2.png
    ├── zhuo-3.png
    ├── zhuo-4.png
    ├── zhuo-5.png
    ├── zhuo-6.png
    └── zhuo-7.png

57 directories, 399 files</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="op">!</span>tree mandarin <span class="op">|</span> head <span class="op">-</span>n <span class="dv">12</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="op">!</span>echo ...</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="op">!</span>tree mandarin <span class="op">|</span> tail <span class="op">-</span>n <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin
├── bai
│&nbsp;&nbsp; ├── bai-1.png
│&nbsp;&nbsp; ├── bai-2.png
│&nbsp;&nbsp; ├── bai-3.png
│&nbsp;&nbsp; ├── bai-4.png
│&nbsp;&nbsp; ├── bai-5.png
│&nbsp;&nbsp; ├── bai-6.png
│&nbsp;&nbsp; └── bai-7.png
├── ben
│&nbsp;&nbsp; ├── ben-1.png
│&nbsp;&nbsp; ├── ben-2.png</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    ├── zhuo-6.png
    └── zhuo-7.png

57 directories, 399 files</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="splitting-into-trainvaltest-sets" class="slide level2">
<h2>Splitting into train/val/test sets</h2>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="op">!</span>pip install split<span class="op">-</span>folders <span class="op">&gt;</span> <span class="op">/</span>dev<span class="op">/</span>null</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="im">import</span> splitfolders</span>
<span id="cb48-2"><a href="#cb48-2"></a>splitfolders.ratio(<span class="st">"mandarin"</span>, output<span class="op">=</span><span class="st">"mandarin-split"</span>,</span>
<span id="cb48-3"><a href="#cb48-3"></a>    seed<span class="op">=</span><span class="dv">1337</span>, ratio<span class="op">=</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>))</span>
<span id="cb48-4"><a href="#cb48-4"></a></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="op">!</span>tree mandarin<span class="op">-</span>split <span class="op">-</span>L <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split
├── test
├── train
└── val

3 directories, 0 files</code></pre>
</div>
</div>
</section>
<section id="directory-structure-ii" class="slide level2">
<h2>Directory structure II</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a><span class="op">!</span>tree mandarin<span class="op">-</span>split</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split
├── test
│&nbsp;&nbsp; ├── bai
│&nbsp;&nbsp; │&nbsp;&nbsp; └── bai-5.png
│&nbsp;&nbsp; ├── ben
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ben-5.png
│&nbsp;&nbsp; ├── chong
│&nbsp;&nbsp; │&nbsp;&nbsp; └── chong-5.png
│&nbsp;&nbsp; ├── chu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── chu-5.png
│&nbsp;&nbsp; ├── chuan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── chuan-5.png
│&nbsp;&nbsp; ├── cong
│&nbsp;&nbsp; │&nbsp;&nbsp; └── cong-5.png
│&nbsp;&nbsp; ├── da
│&nbsp;&nbsp; │&nbsp;&nbsp; └── da-5.png
│&nbsp;&nbsp; ├── dan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── dan-5.png
│&nbsp;&nbsp; ├── dong
│&nbsp;&nbsp; │&nbsp;&nbsp; └── dong-5.png
│&nbsp;&nbsp; ├── fei
│&nbsp;&nbsp; │&nbsp;&nbsp; └── fei-5.png
│&nbsp;&nbsp; ├── fu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── fu-5.png
│&nbsp;&nbsp; ├── fu2
│&nbsp;&nbsp; │&nbsp;&nbsp; └── fu2-5.png
│&nbsp;&nbsp; ├── gao
│&nbsp;&nbsp; │&nbsp;&nbsp; └── gao-5.png
│&nbsp;&nbsp; ├── gong
│&nbsp;&nbsp; │&nbsp;&nbsp; └── gong-5.png
│&nbsp;&nbsp; ├── guo
│&nbsp;&nbsp; │&nbsp;&nbsp; └── guo-5.png
│&nbsp;&nbsp; ├── hu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── hu-5.png
│&nbsp;&nbsp; ├── huo
│&nbsp;&nbsp; │&nbsp;&nbsp; └── huo-5.png
│&nbsp;&nbsp; ├── kou
│&nbsp;&nbsp; │&nbsp;&nbsp; └── kou-5.png
│&nbsp;&nbsp; ├── ku
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ku-5.png
│&nbsp;&nbsp; ├── lin
│&nbsp;&nbsp; │&nbsp;&nbsp; └── lin-5.png
│&nbsp;&nbsp; ├── ma
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ma-5.png
│&nbsp;&nbsp; ├── ma2
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ma2-5.png
│&nbsp;&nbsp; ├── ma3
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ma3-5.png
│&nbsp;&nbsp; ├── mei
│&nbsp;&nbsp; │&nbsp;&nbsp; └── mei-5.png
│&nbsp;&nbsp; ├── men
│&nbsp;&nbsp; │&nbsp;&nbsp; └── men-5.png
│&nbsp;&nbsp; ├── ming
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ming-5.png
│&nbsp;&nbsp; ├── mu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── mu-5.png
│&nbsp;&nbsp; ├── nan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── nan-5.png
│&nbsp;&nbsp; ├── niao
│&nbsp;&nbsp; │&nbsp;&nbsp; └── niao-5.png
│&nbsp;&nbsp; ├── niu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── niu-5.png
│&nbsp;&nbsp; ├── nu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── nu-5.png
│&nbsp;&nbsp; ├── nuan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── nuan-5.png
│&nbsp;&nbsp; ├── peng
│&nbsp;&nbsp; │&nbsp;&nbsp; └── peng-5.png
│&nbsp;&nbsp; ├── quan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── quan-5.png
│&nbsp;&nbsp; ├── ren
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ren-5.png
│&nbsp;&nbsp; ├── ri
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ri-5.png
│&nbsp;&nbsp; ├── rou
│&nbsp;&nbsp; │&nbsp;&nbsp; └── rou-5.png
│&nbsp;&nbsp; ├── sen
│&nbsp;&nbsp; │&nbsp;&nbsp; └── sen-5.png
│&nbsp;&nbsp; ├── shan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── shan-5.png
│&nbsp;&nbsp; ├── shan2
│&nbsp;&nbsp; │&nbsp;&nbsp; └── shan2-5.png
│&nbsp;&nbsp; ├── shui
│&nbsp;&nbsp; │&nbsp;&nbsp; └── shui-5.png
│&nbsp;&nbsp; ├── tai
│&nbsp;&nbsp; │&nbsp;&nbsp; └── tai-5.png
│&nbsp;&nbsp; ├── tian
│&nbsp;&nbsp; │&nbsp;&nbsp; └── tian-5.png
│&nbsp;&nbsp; ├── wang
│&nbsp;&nbsp; │&nbsp;&nbsp; └── wang-5.png
│&nbsp;&nbsp; ├── wen
│&nbsp;&nbsp; │&nbsp;&nbsp; └── wen-5.png
│&nbsp;&nbsp; ├── xian
│&nbsp;&nbsp; │&nbsp;&nbsp; └── xian-5.png
│&nbsp;&nbsp; ├── xuan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── xuan-5.png
│&nbsp;&nbsp; ├── yan
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yan-5.png
│&nbsp;&nbsp; ├── yang
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yang-5.png
│&nbsp;&nbsp; ├── yin
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yin-5.png
│&nbsp;&nbsp; ├── yu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yu-5.png
│&nbsp;&nbsp; ├── yu2
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yu2-5.png
│&nbsp;&nbsp; ├── yue
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yue-5.png
│&nbsp;&nbsp; ├── zhong
│&nbsp;&nbsp; │&nbsp;&nbsp; └── zhong-5.png
│&nbsp;&nbsp; ├── zhu
│&nbsp;&nbsp; │&nbsp;&nbsp; └── zhu-5.png
│&nbsp;&nbsp; ├── zhu2
│&nbsp;&nbsp; │&nbsp;&nbsp; └── zhu2-5.png
│&nbsp;&nbsp; └── zhuo
│&nbsp;&nbsp;     └── zhuo-5.png
├── train
│&nbsp;&nbsp; ├── bai
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── bai-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── bai-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── bai-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── bai-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── bai-6.png
│&nbsp;&nbsp; ├── ben
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ben-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ben-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ben-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ben-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ben-6.png
│&nbsp;&nbsp; ├── chong
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chong-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chong-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chong-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chong-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── chong-6.png
│&nbsp;&nbsp; ├── chu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── chu-6.png
│&nbsp;&nbsp; ├── chuan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chuan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chuan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chuan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── chuan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── chuan-6.png
│&nbsp;&nbsp; ├── cong
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── cong-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── cong-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── cong-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── cong-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── cong-6.png
│&nbsp;&nbsp; ├── da
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── da-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── da-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── da-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── da-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── da-6.png
│&nbsp;&nbsp; ├── dan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── dan-6.png
│&nbsp;&nbsp; ├── dong
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dong-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dong-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dong-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dong-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── dong-6.png
│&nbsp;&nbsp; ├── fei
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fei-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fei-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fei-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fei-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── fei-6.png
│&nbsp;&nbsp; ├── fu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── fu-6.png
│&nbsp;&nbsp; ├── fu2
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu2-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu2-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu2-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── fu2-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── fu2-6.png
│&nbsp;&nbsp; ├── gao
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gao-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gao-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gao-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gao-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── gao-6.png
│&nbsp;&nbsp; ├── gong
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gong-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gong-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gong-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── gong-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── gong-6.png
│&nbsp;&nbsp; ├── guo
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── guo-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── guo-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── guo-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── guo-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── guo-6.png
│&nbsp;&nbsp; ├── hu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── hu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── hu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── hu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── hu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── hu-6.png
│&nbsp;&nbsp; ├── huo
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── huo-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── huo-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── huo-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── huo-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── huo-6.png
│&nbsp;&nbsp; ├── kou
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── kou-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── kou-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── kou-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── kou-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── kou-6.png
│&nbsp;&nbsp; ├── ku
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ku-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ku-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ku-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ku-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ku-6.png
│&nbsp;&nbsp; ├── lin
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── lin-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── lin-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── lin-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── lin-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── lin-6.png
│&nbsp;&nbsp; ├── ma
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ma-6.png
│&nbsp;&nbsp; ├── ma2
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma2-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma2-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma2-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma2-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ma2-6.png
│&nbsp;&nbsp; ├── ma3
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma3-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma3-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma3-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ma3-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ma3-6.png
│&nbsp;&nbsp; ├── mei
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mei-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mei-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mei-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mei-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── mei-6.png
│&nbsp;&nbsp; ├── men
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── men-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── men-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── men-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── men-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── men-6.png
│&nbsp;&nbsp; ├── ming
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ming-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ming-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ming-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ming-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ming-6.png
│&nbsp;&nbsp; ├── mu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── mu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── mu-6.png
│&nbsp;&nbsp; ├── nan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── nan-6.png
│&nbsp;&nbsp; ├── niao
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niao-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niao-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niao-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niao-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── niao-6.png
│&nbsp;&nbsp; ├── niu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── niu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── niu-6.png
│&nbsp;&nbsp; ├── nu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── nu-6.png
│&nbsp;&nbsp; ├── nuan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nuan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nuan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nuan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── nuan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── nuan-6.png
│&nbsp;&nbsp; ├── peng
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── peng-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── peng-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── peng-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── peng-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── peng-6.png
│&nbsp;&nbsp; ├── quan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── quan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── quan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── quan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── quan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── quan-6.png
│&nbsp;&nbsp; ├── ren
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ren-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ren-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ren-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ren-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ren-6.png
│&nbsp;&nbsp; ├── ri
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ri-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ri-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ri-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ri-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── ri-6.png
│&nbsp;&nbsp; ├── rou
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── rou-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── rou-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── rou-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── rou-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── rou-6.png
│&nbsp;&nbsp; ├── sen
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── sen-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── sen-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── sen-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── sen-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── sen-6.png
│&nbsp;&nbsp; ├── shan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── shan-6.png
│&nbsp;&nbsp; ├── shan2
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan2-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan2-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan2-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shan2-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── shan2-6.png
│&nbsp;&nbsp; ├── shui
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shui-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shui-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shui-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── shui-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── shui-6.png
│&nbsp;&nbsp; ├── tai
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tai-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tai-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tai-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tai-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── tai-6.png
│&nbsp;&nbsp; ├── tian
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tian-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tian-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tian-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tian-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── tian-6.png
│&nbsp;&nbsp; ├── wang
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wang-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wang-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wang-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wang-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── wang-6.png
│&nbsp;&nbsp; ├── wen
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wen-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wen-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wen-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── wen-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── wen-6.png
│&nbsp;&nbsp; ├── xian
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xian-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xian-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xian-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xian-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── xian-6.png
│&nbsp;&nbsp; ├── xuan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xuan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xuan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xuan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── xuan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── xuan-6.png
│&nbsp;&nbsp; ├── yan
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yan-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yan-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yan-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yan-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yan-6.png
│&nbsp;&nbsp; ├── yang
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yang-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yang-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yang-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yang-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yang-6.png
│&nbsp;&nbsp; ├── yin
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yin-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yin-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yin-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yin-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yin-6.png
│&nbsp;&nbsp; ├── yu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yu-6.png
│&nbsp;&nbsp; ├── yu2
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu2-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu2-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu2-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yu2-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yu2-6.png
│&nbsp;&nbsp; ├── yue
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yue-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yue-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yue-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── yue-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── yue-6.png
│&nbsp;&nbsp; ├── zhong
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhong-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhong-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhong-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhong-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── zhong-6.png
│&nbsp;&nbsp; ├── zhu
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── zhu-6.png
│&nbsp;&nbsp; ├── zhu2
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu2-1.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu2-2.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu2-3.png
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── zhu2-4.png
│&nbsp;&nbsp; │&nbsp;&nbsp; └── zhu2-6.png
│&nbsp;&nbsp; └── zhuo
│&nbsp;&nbsp;     ├── zhuo-1.png
│&nbsp;&nbsp;     ├── zhuo-2.png
│&nbsp;&nbsp;     ├── zhuo-3.png
│&nbsp;&nbsp;     ├── zhuo-4.png
│&nbsp;&nbsp;     └── zhuo-6.png
└── val
    ├── bai
    │&nbsp;&nbsp; └── bai-7.png
    ├── ben
    │&nbsp;&nbsp; └── ben-7.png
    ├── chong
    │&nbsp;&nbsp; └── chong-7.png
    ├── chu
    │&nbsp;&nbsp; └── chu-7.png
    ├── chuan
    │&nbsp;&nbsp; └── chuan-7.png
    ├── cong
    │&nbsp;&nbsp; └── cong-7.png
    ├── da
    │&nbsp;&nbsp; └── da-7.png
    ├── dan
    │&nbsp;&nbsp; └── dan-7.png
    ├── dong
    │&nbsp;&nbsp; └── dong-7.png
    ├── fei
    │&nbsp;&nbsp; └── fei-7.png
    ├── fu
    │&nbsp;&nbsp; └── fu-7.png
    ├── fu2
    │&nbsp;&nbsp; └── fu2-7.png
    ├── gao
    │&nbsp;&nbsp; └── gao-7.png
    ├── gong
    │&nbsp;&nbsp; └── gong-7.png
    ├── guo
    │&nbsp;&nbsp; └── guo-7.png
    ├── hu
    │&nbsp;&nbsp; └── hu-7.png
    ├── huo
    │&nbsp;&nbsp; └── huo-7.png
    ├── kou
    │&nbsp;&nbsp; └── kou-7.png
    ├── ku
    │&nbsp;&nbsp; └── ku-7.png
    ├── lin
    │&nbsp;&nbsp; └── lin-7.png
    ├── ma
    │&nbsp;&nbsp; └── ma-7.png
    ├── ma2
    │&nbsp;&nbsp; └── ma2-7.png
    ├── ma3
    │&nbsp;&nbsp; └── ma3-7.png
    ├── mei
    │&nbsp;&nbsp; └── mei-7.png
    ├── men
    │&nbsp;&nbsp; └── men-7.png
    ├── ming
    │&nbsp;&nbsp; └── ming-7.png
    ├── mu
    │&nbsp;&nbsp; └── mu-7.png
    ├── nan
    │&nbsp;&nbsp; └── nan-7.png
    ├── niao
    │&nbsp;&nbsp; └── niao-7.png
    ├── niu
    │&nbsp;&nbsp; └── niu-7.png
    ├── nu
    │&nbsp;&nbsp; └── nu-7.png
    ├── nuan
    │&nbsp;&nbsp; └── nuan-7.png
    ├── peng
    │&nbsp;&nbsp; └── peng-7.png
    ├── quan
    │&nbsp;&nbsp; └── quan-7.png
    ├── ren
    │&nbsp;&nbsp; └── ren-7.png
    ├── ri
    │&nbsp;&nbsp; └── ri-7.png
    ├── rou
    │&nbsp;&nbsp; └── rou-7.png
    ├── sen
    │&nbsp;&nbsp; └── sen-7.png
    ├── shan
    │&nbsp;&nbsp; └── shan-7.png
    ├── shan2
    │&nbsp;&nbsp; └── shan2-7.png
    ├── shui
    │&nbsp;&nbsp; └── shui-7.png
    ├── tai
    │&nbsp;&nbsp; └── tai-7.png
    ├── tian
    │&nbsp;&nbsp; └── tian-7.png
    ├── wang
    │&nbsp;&nbsp; └── wang-7.png
    ├── wen
    │&nbsp;&nbsp; └── wen-7.png
    ├── xian
    │&nbsp;&nbsp; └── xian-7.png
    ├── xuan
    │&nbsp;&nbsp; └── xuan-7.png
    ├── yan
    │&nbsp;&nbsp; └── yan-7.png
    ├── yang
    │&nbsp;&nbsp; └── yang-7.png
    ├── yin
    │&nbsp;&nbsp; └── yin-7.png
    ├── yu
    │&nbsp;&nbsp; └── yu-7.png
    ├── yu2
    │&nbsp;&nbsp; └── yu2-7.png
    ├── yue
    │&nbsp;&nbsp; └── yue-7.png
    ├── zhong
    │&nbsp;&nbsp; └── zhong-7.png
    ├── zhu
    │&nbsp;&nbsp; └── zhu-7.png
    ├── zhu2
    │&nbsp;&nbsp; └── zhu2-7.png
    └── zhuo
        └── zhuo-7.png

174 directories, 399 files</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="38">
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/train
├── bai
│&nbsp;&nbsp; ├── bai-1.png
│&nbsp;&nbsp; ├── bai-2.png
│&nbsp;&nbsp; ├── bai-3.png
│&nbsp;&nbsp; ├── bai-4.png
│&nbsp;&nbsp; └── bai-6.png</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/val
├── bai
│&nbsp;&nbsp; └── bai-7.png
├── ben
│&nbsp;&nbsp; └── ben-7.png</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/test
├── bai
│&nbsp;&nbsp; └── bai-5.png
├── ben
│&nbsp;&nbsp; └── ben-5.png</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>...</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="keras-image-dataset-loading" class="slide level2">
<h2>Keras image dataset loading</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span><span class="op">\</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  image_dataset_from_directory</span>
<span id="cb58-3"><a href="#cb58-3"></a></span>
<span id="cb58-4"><a href="#cb58-4"></a>dataDir <span class="op">=</span> <span class="st">"mandarin-split"</span></span>
<span id="cb58-5"><a href="#cb58-5"></a>batchSize <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>imgHeight <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb58-7"><a href="#cb58-7"></a>imgWidth <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb58-8"><a href="#cb58-8"></a>imgSize <span class="op">=</span> (imgHeight, imgWidth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>trainDS <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb59-2"><a href="#cb59-2"></a>    dataDir <span class="op">+</span> <span class="st">"/train"</span>,</span>
<span id="cb59-3"><a href="#cb59-3"></a>    image_size<span class="op">=</span>imgSize,</span>
<span id="cb59-4"><a href="#cb59-4"></a>    batch_size<span class="op">=</span>batchSize,</span>
<span id="cb59-5"><a href="#cb59-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb59-6"><a href="#cb59-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 285 files belonging to 57 classes.</code></pre>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>valDS <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb61-2"><a href="#cb61-2"></a>    dataDir <span class="op">+</span> <span class="st">"/val"</span>,</span>
<span id="cb61-3"><a href="#cb61-3"></a>    image_size<span class="op">=</span>imgSize,</span>
<span id="cb61-4"><a href="#cb61-4"></a>    batch_size<span class="op">=</span>batchSize,</span>
<span id="cb61-5"><a href="#cb61-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb61-6"><a href="#cb61-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 57 files belonging to 57 classes.</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>testDS <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb63-2"><a href="#cb63-2"></a>    dataDir <span class="op">+</span> <span class="st">"/test"</span>,</span>
<span id="cb63-3"><a href="#cb63-3"></a>    image_size<span class="op">=</span>imgSize,</span>
<span id="cb63-4"><a href="#cb63-4"></a>    batch_size<span class="op">=</span>batchSize,</span>
<span id="cb63-5"><a href="#cb63-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb63-6"><a href="#cb63-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 57 files belonging to 57 classes.</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="inspecting-the-datasets" class="slide level2">
<h2>Inspecting the datasets</h2>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a><span class="bu">print</span>(trainDS.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['bai', 'ben', 'chong', 'chu', 'chuan', 'cong', 'da', 'dan', 'dong', 'fei', 'fu', 'fu2', 'gao', 'gong', 'guo', 'hu', 'huo', 'kou', 'ku', 'lin', 'ma', 'ma2', 'ma3', 'mei', 'men', 'ming', 'mu', 'nan', 'niao', 'niu', 'nu', 'nuan', 'peng', 'quan', 'ren', 'ri', 'rou', 'sen', 'shan', 'shan2', 'shui', 'tai', 'tian', 'wang', 'wen', 'xian', 'xuan', 'yan', 'yang', 'yin', 'yu', 'yu2', 'yue', 'zhong', 'zhu', 'zhu2', 'zhuo']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># NB: Need shuffle=False earlier for these X &amp; y to line up.</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>X_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(trainDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb67-3"><a href="#cb67-3"></a>y_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(trainDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb67-4"><a href="#cb67-4"></a></span>
<span id="cb67-5"><a href="#cb67-5"></a>X_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(valDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb67-6"><a href="#cb67-6"></a>y_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(valDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb67-7"><a href="#cb67-7"></a></span>
<span id="cb67-8"><a href="#cb67-8"></a>X_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(testDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb67-9"><a href="#cb67-9"></a>y_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(testDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb67-10"><a href="#cb67-10"></a></span>
<span id="cb67-11"><a href="#cb67-11"></a>X_train.shape, y_train.shape, X_val.shape, y_val.shape, X_test.shape, y_test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>((285, 80, 80, 1), (285,), (57, 80, 80, 1), (57,), (57, 80, 80, 1), (57,))</code></pre>
</div>
</div>
</section>
<section id="plotting-some-characters-setup" class="slide level2">
<h2>Plotting some characters (setup)</h2>
<p><br></p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">def</span> plot_mandarin_characters(ds, plotCharLabel <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb69-2"><a href="#cb69-2"></a>    numPlotted <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb69-3"><a href="#cb69-3"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> ds:</span>
<span id="cb69-4"><a href="#cb69-4"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(images.shape[<span class="dv">0</span>]):</span>
<span id="cb69-5"><a href="#cb69-5"></a>            label <span class="op">=</span> labels[i]</span>
<span id="cb69-6"><a href="#cb69-6"></a>            <span class="cf">if</span> label <span class="op">==</span> plotCharLabel:</span>
<span id="cb69-7"><a href="#cb69-7"></a>                plt.subplot(<span class="dv">1</span>, <span class="dv">5</span>, numPlotted <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb69-8"><a href="#cb69-8"></a>                plt.imshow(images[i].numpy().astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb69-9"><a href="#cb69-9"></a>                plt.title(ds.class_names[label])</span>
<span id="cb69-10"><a href="#cb69-10"></a>                plt.axis(<span class="st">"off"</span>)</span>
<span id="cb69-11"><a href="#cb69-11"></a>                numPlotted <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb69-12"><a href="#cb69-12"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-some-training-characters" class="slide level2 smaller">
<h2>Plotting some training characters</h2>
<div class="cell" data-execution_count="46">
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-47-output-1.png"></p>
</div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-47-output-2.png"></p>
</div>
</div>
</section>
<section id="plotting-some-valtest-characters" class="slide level2">
<h2>Plotting some val/test characters</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>baiVal <span class="op">=</span> X_val[y_val <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb70-2"><a href="#cb70-2"></a>plt.imshow(baiVal, cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-48-output-1.png"></p>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>baiTest <span class="op">=</span> X_test[y_test <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb71-2"><a href="#cb71-2"></a>plt.imshow(baiTest)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-49-output-1.png"></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="section-1" class="title-slide slide level1 center">
<h1></h1>
<h2>
Make the CNN
</h2>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="op">\</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>  <span class="im">import</span> Rescaling, Conv2D, MaxPooling2D, Flatten</span>
<span id="cb72-3"><a href="#cb72-3"></a></span>
<span id="cb72-4"><a href="#cb72-4"></a>numClasses <span class="op">=</span> np.unique(y_train).shape[<span class="dv">0</span>]</span>
<span id="cb72-5"><a href="#cb72-5"></a>tf.random.set_seed(<span class="dv">123</span>)</span>
<span id="cb72-6"><a href="#cb72-6"></a></span>
<span id="cb72-7"><a href="#cb72-7"></a>model <span class="op">=</span> Sequential([</span>
<span id="cb72-8"><a href="#cb72-8"></a>  Rescaling(<span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>, input_shape<span class="op">=</span>(imgHeight, imgWidth, <span class="dv">1</span>)),</span>
<span id="cb72-9"><a href="#cb72-9"></a>  Conv2D(<span class="dv">16</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv1"</span>),</span>
<span id="cb72-10"><a href="#cb72-10"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool1"</span>),</span>
<span id="cb72-11"><a href="#cb72-11"></a>  Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv2"</span>),</span>
<span id="cb72-12"><a href="#cb72-12"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool2"</span>),</span>
<span id="cb72-13"><a href="#cb72-13"></a>  Conv2D(<span class="dv">64</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv3"</span>),</span>
<span id="cb72-14"><a href="#cb72-14"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool3"</span>),</span>
<span id="cb72-15"><a href="#cb72-15"></a>  Flatten(), Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">"relu"</span>), Dense(numClasses)</span>
<span id="cb72-16"><a href="#cb72-16"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The <code>Rescaling</code> layer will rescale the intensities to [0, 1].</p>
</div>
</div>
</div>
<div class="footer">
<p>Architecture inspired by <a href="https://www.tensorflow.org/tutorials/images/classification">https://www.tensorflow.org/tutorials/images/classification</a>.</p>
</div>
</section>
<section id="inspect-the-model" class="slide level2">
<h2>Inspect the model</h2>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>model.summary(print_fn<span class="op">=</span>skip_empty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
Layer (type)                Output Shape              Param #
=================================================================
rescaling (Rescaling)       (None, 80, 80, 1)         0
conv1 (Conv2D)              (None, 80, 80, 16)        160
pool1 (MaxPooling2D)        (None, 40, 40, 16)        0
conv2 (Conv2D)              (None, 40, 40, 32)        4640
pool2 (MaxPooling2D)        (None, 20, 20, 32)        0
conv3 (Conv2D)              (None, 20, 20, 64)        18496
pool3 (MaxPooling2D)        (None, 10, 10, 64)        0
flatten (Flatten)           (None, 6400)              0
dense (Dense)               (None, 128)               819328
dense_1 (Dense)             (None, 57)                7353
=================================================================
Total params: 849,977
Trainable params: 849,977
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-the-cnn" class="slide level2">
<h2>Plot the CNN</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>plot_model(model, layer_range<span class="op">=</span>(<span class="st">""</span>, <span class="st">"pool2"</span>), show_shapes<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<p><img data-src="computer-vision_files/figure-revealjs/cell-52-output-1.png"></p>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>plot_model(model, layer_range<span class="op">=</span>(<span class="st">"pool2"</span>, <span class="st">""</span>), show_shapes<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<p><img data-src="computer-vision_files/figure-revealjs/cell-53-output-1.png"></p>
</div>
</div>
</div>
</div>
</section>
<section id="fit-the-cnn" class="slide level2">
<h2>Fit the CNN</h2>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a>loss <span class="op">=</span> tf.keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a>topk <span class="op">=</span> tf.keras.metrics.SparseTopKCategoricalAccuracy(k<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span>loss, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>, topk])</span>
<span id="cb77-4"><a href="#cb77-4"></a></span>
<span id="cb77-5"><a href="#cb77-5"></a>epochs <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">15</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb77-7"><a href="#cb77-7"></a>    monitor<span class="op">=</span><span class="st">"val_accuracy"</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb77-8"><a href="#cb77-8"></a></span>
<span id="cb77-9"><a href="#cb77-9"></a>hist <span class="op">=</span> model.fit(trainDS.shuffle(<span class="dv">1000</span>), validation_data<span class="op">=</span>valDS,</span>
<span id="cb77-10"><a href="#cb77-10"></a>  epochs<span class="op">=</span>epochs, callbacks<span class="op">=</span>[es], verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Restoring model weights from the end of the best epoch: 42.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 57: early stopping</code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Instead of using softmax activation, just added <code>from_logits=True</code> to the loss function; this is more numerically stable.</p>
</div>
</div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves-setup" class="slide level2">
<h2>Plot the loss/accuracy curves (setup)</h2>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">def</span> plot_history(hist):</span>
<span id="cb80-2"><a href="#cb80-2"></a>    epochs <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(hist.history[<span class="st">"loss"</span>]))</span>
<span id="cb80-3"><a href="#cb80-3"></a></span>
<span id="cb80-4"><a href="#cb80-4"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb80-5"><a href="#cb80-5"></a>    plt.plot(epochs, hist.history[<span class="st">"accuracy"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb80-6"><a href="#cb80-6"></a>    plt.plot(epochs, hist.history[<span class="st">"val_accuracy"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb80-7"><a href="#cb80-7"></a>    plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>)</span>
<span id="cb80-8"><a href="#cb80-8"></a>    plt.title(<span class="st">"Accuracy"</span>)</span>
<span id="cb80-9"><a href="#cb80-9"></a></span>
<span id="cb80-10"><a href="#cb80-10"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb80-11"><a href="#cb80-11"></a>    plt.plot(epochs, hist.history[<span class="st">"loss"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb80-12"><a href="#cb80-12"></a>    plt.plot(epochs, hist.history[<span class="st">"val_loss"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb80-13"><a href="#cb80-13"></a>    plt.legend(loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb80-14"><a href="#cb80-14"></a>    plt.title(<span class="st">"Loss"</span>)</span>
<span id="cb80-15"><a href="#cb80-15"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves" class="slide level2">
<h2>Plot the loss/accuracy curves</h2>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>plot_history(hist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-57-output-1.png" class="r-stretch"></section>
<section id="look-at-the-metrics" class="slide level2">
<h2>Look at the metrics</h2>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a><span class="bu">print</span>(model.evaluate(trainDS, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="bu">print</span>(model.evaluate(valDS, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="bu">print</span>(model.evaluate(testDS, verbose<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.0006027933559380472, 1.0, 1.0]
[0.5005242228507996, 0.8947368264198303, 0.9824561476707458]
[0.5381948351860046, 0.859649121761322, 0.9824561476707458]</code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Feel free to try to improve on this for this week’s StoryWall (instead of the cyclone damage dataset). If you do this, try a different architecture, and add more training examples or clean up the existing ones.</p>
</div>
</div>
</div>
</section>
<section id="predict-on-the-test-set" class="slide level2">
<h2>Predict on the test set</h2>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>model.predict(X_test[<span class="dv">17</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="59">
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:Model was constructed with shape (None, 80, 80, 1) for input KerasTensor(type_spec=TensorSpec(shape=(None, 80, 80, 1), dtype=tf.float32, name='rescaling_input'), name='rescaling_input', description="created by layer 'rescaling_input'"), but it was called on an input with incompatible shape (None, 80, 1, 1).</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>X_test[<span class="dv">17</span>].shape, X_test[<span class="dv">17</span>][np.newaxis, :].shape, X_test[[<span class="dv">17</span>]].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>((80, 80, 1), (1, 80, 80, 1), (1, 80, 80, 1))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>model.predict(X_test[[<span class="dv">17</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>array([[ -3.37, -29.32,  -6.99,  -3.82,  -4.13,  -9.99, -17.93,  -4.89,
        -12.18,  -5.68, -15.44,  -4.86, -14.06,  -9.28,  -2.13, -15.04,
         -9.28,   5.76,  -5.42,  -3.26,  -1.27,  -6.43,  -1.85, -18.42,
          3.53,   0.62, -16.7 ,   0.85,  -7.16, -12.23,  -8.3 ,  -9.71,
         -3.57, -17.49, -22.8 ,   2.63,  -4.53,  -1.53,  -8.91,  -0.65,
        -27.39, -17.91,  -6.09, -19.42,  -1.32,  -7.01,  -2.56,  -5.99,
         -4.92,   1.71, -15.63, -12.81,   0.11, -15.04,  -6.12, -19.22,
        -17.08]], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="predict-on-the-test-set-ii" class="slide level2">
<h2>Predict on the test set II</h2>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a>model.predict(X_test[[<span class="dv">17</span>]]).argmax()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>17</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a>testDS.class_names[model.predict(X_test[[<span class="dv">17</span>]]).argmax()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>'kou'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>plt.imshow(X_test[<span class="dv">17</span>], cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-65-output-1.png" class="r-stretch"></section></section>
<section>
<section id="section-2" class="title-slide slide level1 center">
<h1></h1>
<h2>
Error analysis (setup)
</h2>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">def</span> plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, classNames):</span>
<span id="cb95-2"><a href="#cb95-2"></a>  plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb95-3"><a href="#cb95-3"></a></span>
<span id="cb95-4"><a href="#cb95-4"></a>  numErrors <span class="op">=</span> np.<span class="bu">sum</span>(y_pred <span class="op">!=</span> y_test)</span>
<span id="cb95-5"><a href="#cb95-5"></a>  errNum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb95-6"><a href="#cb95-6"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X_test.shape[<span class="dv">0</span>]):</span>
<span id="cb95-7"><a href="#cb95-7"></a>      <span class="cf">if</span> y_pred[i] <span class="op">!=</span> y_test[i]:</span>
<span id="cb95-8"><a href="#cb95-8"></a>          ax <span class="op">=</span> plt.subplot(numErrors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>errNum <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb95-9"><a href="#cb95-9"></a>          plt.imshow(X_test[i].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb95-10"><a href="#cb95-10"></a>          plt.title(<span class="ss">f"Guessed '</span><span class="sc">{</span>classNames[y_pred[i]]<span class="sc">}</span><span class="ss">' True '</span><span class="sc">{</span>classNames[y_test[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb95-11"><a href="#cb95-11"></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb95-12"><a href="#cb95-12"></a>          </span>
<span id="cb95-13"><a href="#cb95-13"></a>          actualPredCharInd <span class="op">=</span> np.argmax(y_test <span class="op">==</span> y_pred[i])</span>
<span id="cb95-14"><a href="#cb95-14"></a>          ax <span class="op">=</span> plt.subplot(numErrors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>errNum <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb95-15"><a href="#cb95-15"></a>          plt.imshow(X_val[actualPredCharInd].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb95-16"><a href="#cb95-16"></a>          plt.title(<span class="ss">f"A real '</span><span class="sc">{</span>classNames[y_pred[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb95-17"><a href="#cb95-17"></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb95-18"><a href="#cb95-18"></a>          errNum <span class="op">+=</span> <span class="dv">1</span>     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="error-analysis-i" class="slide level2">
<h2>Error analysis I</h2>

<img data-src="error-analysis-found-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from first assessment of test errors.</p></section>
<section id="error-analysis-ii" class="slide level2">
<h2>Error analysis II</h2>

<img data-src="error-analysis-found-another-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from second assessment of test errors.</p></section>
<section id="error-analysis-iii" class="slide level2">
<h2>Error analysis III</h2>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>y_pred <span class="op">=</span> model.predict(X_val).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb96-2"><a href="#cb96-2"></a>plot_error_analysis(X_train, y_train, X_val, y_val, y_pred, valDS.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-67-output-1.png" class="r-stretch"></section>
<section id="error-analysis-iv" class="slide level2">
<h2>Error analysis IV</h2>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1"></a>y_pred <span class="op">=</span> model.predict(X_test).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb97-2"><a href="#cb97-2"></a>plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, testDS.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-68-output-1.png" class="r-stretch"></section>
<section id="confidence-of-predictions" class="slide level2">
<h2>Confidence of predictions</h2>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a>y_pred <span class="op">=</span> tf.keras.activations.softmax(model(X_test)).numpy()</span>
<span id="cb98-2"><a href="#cb98-2"></a>y_pred_class <span class="op">=</span> y_pred.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb98-3"><a href="#cb98-3"></a>y_pred_prob <span class="op">=</span> y_pred[np.arange(y_pred.shape[<span class="dv">0</span>]), y_pred_class]</span>
<span id="cb98-4"><a href="#cb98-4"></a></span>
<span id="cb98-5"><a href="#cb98-5"></a>confidenceWhenCorrect <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">==</span> y_test]</span>
<span id="cb98-6"><a href="#cb98-6"></a>confidenceWhenWrong <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">!=</span> y_test]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a>plt.hist(confidenceWhenCorrect)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-70-output-1.png"></p>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>plt.hist(confidenceWhenWrong)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-71-output-1.png"></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="hyperparameter-tuning" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Hyperparameter tuning</h1>

</section>
<section id="trial-error" class="slide level2">
<h2>Trial &amp; error</h2>
<p><br> <br></p>
<div class="columns">
<div class="column">
<p><br></p>
<p>Frankly, a lot of this is just ‘enlightened’ trial and error…</p>
</div><div class="column">
<center>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
One trick that I like to use when training my neural networks is to add some noise ε~Laplace(time(), sqrt(time())) to the gradients of the 13th layer at epoch 3 for batch 7.
</p>
— antonio vergari 💀 hiring PhD troublemakers 💥 (<span class="citation" data-cites="tetraduzione">@tetraduzione</span>) <a href="https://twitter.com/tetraduzione/status/1525501171221274627?ref_src=twsrc%5Etfw">May 14, 2022</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>
</div>
</div>
<div class="footer">
<p>Source: <a href="https://twitter.com/tetraduzione/status/1525501171221274627?s=20&amp;t=ulVFesw-f7hCuG9KyaoYbQ">Twitter</a>.</p>
</div>
</section>
<section id="keras-tuner" class="slide level2">
<h2>Keras Tuner</h2>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a><span class="op">!</span>pip install keras<span class="op">-</span>tuner <span class="op">&gt;</span> <span class="op">/</span>dev<span class="op">/</span>null</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a><span class="im">import</span> keras_tuner <span class="im">as</span> kt</span>
<span id="cb102-2"><a href="#cb102-2"></a></span>
<span id="cb102-3"><a href="#cb102-3"></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb102-4"><a href="#cb102-4"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb102-5"><a href="#cb102-5"></a>    model.add(</span>
<span id="cb102-6"><a href="#cb102-6"></a>        Dense(</span>
<span id="cb102-7"><a href="#cb102-7"></a>            hp.Choice(<span class="st">"neurons"</span>, [<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>]),</span>
<span id="cb102-8"><a href="#cb102-8"></a>            activation<span class="op">=</span>hp.Choice(<span class="st">"activation"</span>,</span>
<span id="cb102-9"><a href="#cb102-9"></a>                [<span class="st">"relu"</span>, <span class="st">"leaky_relu"</span>, <span class="st">"tanh"</span>]),</span>
<span id="cb102-10"><a href="#cb102-10"></a>        )</span>
<span id="cb102-11"><a href="#cb102-11"></a>    )</span>
<span id="cb102-12"><a href="#cb102-12"></a>  </span>
<span id="cb102-13"><a href="#cb102-13"></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb102-14"><a href="#cb102-14"></a>    </span>
<span id="cb102-15"><a href="#cb102-15"></a>    learningRate <span class="op">=</span> hp.Float(<span class="st">"lr"</span>,</span>
<span id="cb102-16"><a href="#cb102-16"></a>        min_value<span class="op">=</span><span class="fl">1e-4</span>, max_value<span class="op">=</span><span class="fl">1e-2</span>, sampling<span class="op">=</span><span class="st">"log"</span>)</span>
<span id="cb102-17"><a href="#cb102-17"></a>    opt <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span>learningRate)</span>
<span id="cb102-18"><a href="#cb102-18"></a></span>
<span id="cb102-19"><a href="#cb102-19"></a>    model.<span class="bu">compile</span>(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb102-20"><a href="#cb102-20"></a>    </span>
<span id="cb102-21"><a href="#cb102-21"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-random-search" class="slide level2">
<h2>Do a random search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a>tuner <span class="op">=</span> kt.RandomSearch(</span>
<span id="cb103-2"><a href="#cb103-2"></a>  build_model,</span>
<span id="cb103-3"><a href="#cb103-3"></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb103-4"><a href="#cb103-4"></a>  max_trials<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb103-5"><a href="#cb103-5"></a>  directory<span class="op">=</span><span class="st">"random-search"</span>)</span>
<span id="cb103-6"><a href="#cb103-6"></a></span>
<span id="cb103-7"><a href="#cb103-7"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb103-8"><a href="#cb103-8"></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb103-9"><a href="#cb103-9"></a></span>
<span id="cb103-10"><a href="#cb103-10"></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb103-11"><a href="#cb103-11"></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb103-12"><a href="#cb103-12"></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb103-13"><a href="#cb103-13"></a></span>
<span id="cb103-14"><a href="#cb103-14"></a>bestModel <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trial 10 Complete [00h 00m 16s]
val_loss: 0.3387024998664856

Best val_loss So Far: 0.32127735018730164
Total elapsed time: 00h 02m 03s</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in random-search/untitled_project
Showing 1 best trials
&lt;keras_tuner.engine.objective.Objective object at 0x28c6b4c40&gt;
Trial summary
Hyperparameters:
neurons: 64
activation: relu
lr: 0.0005418931108883774
Score: 0.32127735018730164</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tune-layers-separately" class="slide level2">
<h2>Tune layers separately</h2>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb107-2"><a href="#cb107-2"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb107-3"><a href="#cb107-3"></a></span>
<span id="cb107-4"><a href="#cb107-4"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(hp.Int(<span class="st">"numHiddenLayers"</span>, <span class="dv">1</span>, <span class="dv">3</span>)):</span>
<span id="cb107-5"><a href="#cb107-5"></a>      <span class="co"># Tune number of units in each layer separately.</span></span>
<span id="cb107-6"><a href="#cb107-6"></a>      model.add(</span>
<span id="cb107-7"><a href="#cb107-7"></a>          Dense(</span>
<span id="cb107-8"><a href="#cb107-8"></a>              hp.Choice(<span class="ss">f"neurons_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, [<span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>]),</span>
<span id="cb107-9"><a href="#cb107-9"></a>              activation<span class="op">=</span><span class="st">"relu"</span></span>
<span id="cb107-10"><a href="#cb107-10"></a>          )</span>
<span id="cb107-11"><a href="#cb107-11"></a>      )</span>
<span id="cb107-12"><a href="#cb107-12"></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb107-13"><a href="#cb107-13"></a></span>
<span id="cb107-14"><a href="#cb107-14"></a>    opt <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">0.0005</span>)</span>
<span id="cb107-15"><a href="#cb107-15"></a>    model.<span class="bu">compile</span>(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb107-16"><a href="#cb107-16"></a>    </span>
<span id="cb107-17"><a href="#cb107-17"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-bayesian-search" class="slide level2">
<h2>Do a Bayesian search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a>tuner <span class="op">=</span> kt.BayesianOptimization(</span>
<span id="cb108-2"><a href="#cb108-2"></a>  build_model,</span>
<span id="cb108-3"><a href="#cb108-3"></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb108-4"><a href="#cb108-4"></a>  directory<span class="op">=</span><span class="st">"bayesian-search"</span>,</span>
<span id="cb108-5"><a href="#cb108-5"></a>  max_trials<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb108-6"><a href="#cb108-6"></a></span>
<span id="cb108-7"><a href="#cb108-7"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb108-8"><a href="#cb108-8"></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb108-9"><a href="#cb108-9"></a></span>
<span id="cb108-10"><a href="#cb108-10"></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb108-11"><a href="#cb108-11"></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb108-12"><a href="#cb108-12"></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb108-13"><a href="#cb108-13"></a></span>
<span id="cb108-14"><a href="#cb108-14"></a>bestModel <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trial 20 Complete [00h 00m 06s]
val_loss: 0.3150010406970978

Best val_loss So Far: 0.31318289041519165
Total elapsed time: 00h 02m 27s</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in bayesian-search/untitled_project
Showing 1 best trials
&lt;keras_tuner.engine.objective.Objective object at 0x28c19ba00&gt;
Trial summary
Hyperparameters:
numHiddenLayers: 3
neurons_0: 64
neurons_1: 16
neurons_2: 8
Score: 0.31318289041519165</code></pre>
</div>
</div>
</div>
</div>
</section></section>
<section id="section-3" class="title-slide slide level1 center" data-visibility="uncounted">
<h1></h1>
<h2>
Glossary
</h2>
<div class="columns">
<div class="column">
<ul>
<li>channels</li>
<li>computer vision</li>
<li>convolutional layer &amp; CNN</li>
<li>error analysis</li>
<li>filter</li>
</ul>
</div><div class="column">
<ul>
<li>flatten layer</li>
<li>kernel</li>
<li>max pooling</li>
<li>MNIST</li>
<li>stride</li>
</ul>
</div>
</div>
<script defer="">
    // Remove the highlight.js class for the 'compile', 'min', 'max'
    // as there's a bug where they are treated like the Python built-in
    // global functions but we only ever see it as methods like
    // 'model.compile()' or 'predictions.max()'
    buggyBuiltIns = ["compile", "min", "max", "round", "sum"];

    document.querySelectorAll('.bu').forEach((elem) => {
        if (buggyBuiltIns.includes(elem.innerHTML)) {
            elem.classList.remove('bu');
        }
    })

    var registerRevealCallbacks = function() {
        Reveal.on('overviewshown', event => {
            document.querySelector(".line.right").hidden = true;
        });
        Reveal.on('overviewhidden', event => {
            document.querySelector(".line.right").hidden = false;
        });
    };
</script>

<img src="unsw-logo.svg" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Slides: <a href="https://pat-laub.github.io">Dr Patrick Laub</a> (<span class="citation" data-cites="PatrickLaub">@PatrickLaub</span>).</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="computer-vision_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="computer-vision_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="computer-vision_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":6,"grid":false,"background":["rgba(255,255,255,0.0)","https://github.com/rajgoel/reveal.js-plugins/raw/master/chalkboard/img/blackboard.png"]},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.2,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    <script>registerRevealCallbacks();</script>
    

</body></html>